###############################################################################
# 
# galicia
# 
# galicia.0000-galicia.0019			Setup events, history events, miscellaneous decisions
# galicia.0020-galicia.0029			Altering the Altar
# galicia.0030-galicia.0039			Cantigas
# galicia.0040-galicia.0049			Cantigas de Santa Maria
# galicia.0050-galicia.0099			Generic flavor events
# 
# 
###############################################################################

namespace = galicia

######################################################################################
# 
# SETUP EVENTS, HISTORY EVENTS, MISC DECISIONS
# 
# galicia.0000-galicia.0019
# 
######################################################################################


# Way of Saint James infrastructure
galicia.0010 = {
	type = character_event
	title = galicia.0010.t
	desc = {
		desc = galicia.0010.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					religion = religion:christianity_religion
				}
				desc = galicia.0010.desc.christian
			}
			triggered_desc = {
				trigger = {
					NOT = { religion = religion:christianity_religion }
				}
				desc = galicia.0010.desc.non_christian
			}
		}
		desc = galicia.0010.desc.conclusion
	}
	theme = RICE_theme_camino_de_santiago_church
	override_background = {
		trigger = {
			has_character_flag = RICE_way_of_saint_james_background_alt
		}
		event_background = RICE_background_camino_de_santiago_road
	}

	left_portrait = {
		character = root
		animation = personality_compassionate
	}

	immediate = {	
		title:c_santiago = {
			save_scope_as = santiago
		}
		religion:christianity_religion = { save_scope_as = christian }
		hidden_effect = {
			random = {
				chance = 50
				add_character_flag = RICE_way_of_saint_james_background_alt
			}
		}
	}

	option = {
		name = galicia.0010.a
		if = {
			limit = {
				religion = religion:christianity_religion
			}
			add_piety = RICE_saint_james_help_piety_reward_value
			add_character_modifier = {
				modifier = RICE_galicia_way_of_saint_james_supporter
				years = 10
			}
		}
		else = {	
			add_prestige = RICE_saint_james_help_prestige_reward_value			
			add_character_modifier = {
				modifier = RICE_galicia_way_of_saint_james_supporter_nonchristian
				years = 10
			}
		}
		

		show_as_tooltip = {
			if = {
				limit = {
					religion = religion:christianity_religion
				}

				random_list = {
					desc = RICE_galicia_saint_james_routes_decision_tt
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_routes_decision_counties.close
						custom_tooltip = RICE_galicia_saint_james_routes_decision_counties.close.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_routes_decision_counties.midrange.high
						custom_tooltip = RICE_galicia_saint_james_routes_decision_counties.midrange.high.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_routes_decision_counties.distant.high
						custom_tooltip = RICE_galicia_saint_james_routes_decision_counties.distant.high.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_routes_decision_counties.midrange.low
						custom_tooltip = RICE_galicia_saint_james_routes_decision_counties.midrange.low.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_routes_decision_counties.distant.low
						custom_tooltip = RICE_galicia_saint_james_routes_decision_counties.distant.low.tooltip
					}
				}

			}

			else = {

				random_list = {
					desc = RICE_galicia_saint_james_routes_decision_non_christian_tt
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_routes_decision_counties.close
						custom_tooltip = RICE_galicia_saint_james_routes_decision_counties.close.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_routes_decision_counties.midrange.high
						custom_tooltip = RICE_galicia_saint_james_routes_decision_counties.midrange.high.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_routes_decision_counties.distant.high
						custom_tooltip = RICE_galicia_saint_james_routes_decision_counties.distant.high.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_routes_decision_counties.midrange.low
						custom_tooltip = RICE_galicia_saint_james_routes_decision_counties.midrange.low.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_routes_decision_counties.distant.low
						custom_tooltip = RICE_galicia_saint_james_routes_decision_counties.distant.low.tooltip
					}
				}

			}

		}
		hidden_effect = {
			RICE_galicia_saint_james_infrastructure_close_effect = yes
			RICE_galicia_saint_james_infrastructure_midrange_high_effect = yes
			RICE_galicia_saint_james_infrastructure_distant_high_effect = yes
			RICE_galicia_saint_james_infrastructure_midrange_low_effect = yes
			RICE_galicia_saint_james_infrastructure_distant_low_effect = yes
		}	
	}

	after = {
		if = {
			limit = {
				has_character_flag = RICE_way_of_saint_james_background_alt
			}
			remove_character_flag = RICE_way_of_saint_james_background_alt
		}
	}

}


# Saint James Intercession decision
galicia.0011 = {
	type = character_event
	title = galicia.0011.t
	desc = {
		desc = galicia.0011.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					OR = {
						AND = {
							exists = struggle:iberian_struggle
							struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_hostility }
						}
						AND = {
							NOT = { exists = struggle:iberian_struggle }
							NOT = { has_global_variable = fp2_struggle_conciliation_ending }
							NOT = { has_global_variable = fp2_struggle_compromise_ending }
						}
					}
				}
				desc = galicia.0011.desc.warrior
			}
			triggered_desc = {
				trigger = {
					OR = {
						AND = {
							exists = struggle:iberian_struggle
							struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_conciliation }
						}
						AND = {
							NOT = { exists = struggle:iberian_struggle }
							has_global_variable = fp2_struggle_conciliation_ending
						}
					}
				}
				desc = galicia.0011.desc.preacher
			}
			triggered_desc = {
				trigger = {
					OR = {
						AND = {
							exists = struggle:iberian_struggle
							OR = {
								struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_compromise }
								struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_opportunity }
							}
						}
						AND = {
							NOT = { exists = struggle:iberian_struggle }
							has_global_variable = fp2_struggle_compromise_ending
						}
					}
				}
				desc = galicia.0011.desc.pilgrim
			}
		}
	}
	theme = faith

	left_portrait = {
		character = root
		animation = personality_zealous
	}

	option = {
		name = galicia.0011.a
		RICE_galicia_saint_james_prayer_warrior_effect = yes
	}

}





# Levying extra tolls on the Way of Saint James
galicia.0012 = {
	type = character_event
	title = galicia.0012.t
	desc = {
		desc = galicia.0012.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					religion = religion:christianity_religion
				}
				desc = galicia.0012.desc.christian
			}
			triggered_desc = {
				trigger = {
					NOT = { religion = religion:christianity_religion }
				}
				desc = galicia.0012.desc.non_christian
			}
		}
		first_valid = {
			triggered_desc = {
				trigger = {
					religion = religion:christianity_religion
					cp:councillor_court_chaplain = {
						exists = yes
						is_available_adult = yes
					}
				}
				desc = galicia.0012.desc.court_chaplain_exists
			}
			triggered_desc = {
				trigger = {
					religion = religion:christianity_religion
				}
				# Fallback
				desc = galicia.0012.desc.no_court_chaplain_exists
			}
		}
	}
	theme = RICE_theme_camino_de_santiago_church
	override_background = {
		trigger = {
			has_character_flag = RICE_way_of_saint_james_background_alt
		}
		event_background = RICE_background_camino_de_santiago_road
	}

	left_portrait = {
		character = root
		animation = war_defender
	}

	right_portrait = {
		character = scope:chaplain
		trigger = {
			religion = religion:christianity_religion
			exists = scope:chaplain
			scope:chaplain = {
				is_available_adult = yes
			}
		}
		animation = disapproval
	}

	immediate = {	
		cp:councillor_court_chaplain = {
			save_scope_as = chaplain
		}
		religion:christianity_religion = { save_scope_as = christian }
		title:c_santiago = {
			save_scope_as = santiago
		}
		hidden_effect = {
			random = {
				chance = 50
				add_character_flag = RICE_way_of_saint_james_background_alt
			}
		}
	}

	option = {
		name = galicia.0012.a

		if = {
			limit = {
				religion = religion:christianity_religion
			}
			add_gold = { 0 RICE_saint_james_toll_money_reward_max_value }
			add_character_modifier = {
				modifier = RICE_galicia_way_of_saint_james_robber_baron
				years = 10
			}
		}
		else = {
			add_gold = { 0 RICE_saint_james_toll_money_reward_nonchristian_max_value }
			add_character_modifier = {
				modifier = RICE_galicia_way_of_saint_james_robber_baron_nonchristian
				years = 10
			}
		}

		show_as_tooltip = {
			if = {
				limit = {
					religion = religion:christianity_religion
				}
	
				random_list = {
					desc = RICE_galicia_saint_james_levy_extra_tolls_tt
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_levy_extra_tolls_counties.close
						custom_tooltip = RICE_galicia_saint_james_levy_extra_tolls_counties.close.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_levy_extra_tolls_counties.midrange.high
						custom_tooltip = RICE_galicia_saint_james_levy_extra_tolls_counties.midrange.high.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_levy_extra_tolls_counties.distant.high
						custom_tooltip = RICE_galicia_saint_james_levy_extra_tolls_counties.distant.high.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_levy_extra_tolls_counties.midrange.low
						custom_tooltip = RICE_galicia_saint_james_levy_extra_tolls_counties.midrange.low.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_levy_extra_tolls_counties.distant.low
						custom_tooltip = RICE_galicia_saint_james_levy_extra_tolls_counties.distant.low.tooltip
					}
				}
			}

			else = {

				random_list = {
					desc = RICE_galicia_saint_james_levy_extra_tolls_non_christian_tt
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_levy_extra_tolls_counties.close
						custom_tooltip = RICE_galicia_saint_james_levy_extra_tolls_counties.close.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_levy_extra_tolls_counties.midrange.high
						custom_tooltip = RICE_galicia_saint_james_levy_extra_tolls_counties.midrange.high.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_levy_extra_tolls_counties.distant.high
						custom_tooltip = RICE_galicia_saint_james_levy_extra_tolls_counties.distant.high.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_levy_extra_tolls_counties.midrange.low
						custom_tooltip = RICE_galicia_saint_james_levy_extra_tolls_counties.midrange.low.tooltip
					}
					100 = {
						show_chance = no
						desc = RICE_galicia_saint_james_levy_extra_tolls_counties.distant.low
						custom_tooltip = RICE_galicia_saint_james_levy_extra_tolls_counties.distant.low.tooltip
					}
				}
			}
		}

		hidden_effect = {
			RICE_galicia_saint_james_tolls_close_effect = yes
			RICE_galicia_saint_james_tolls_midrange_high_effect = yes
			RICE_galicia_saint_james_tolls_distant_high_effect = yes
			RICE_galicia_saint_james_tolls_midrange_low_effect = yes
			RICE_galicia_saint_james_tolls_distant_low_effect = yes
		}	
	}

	after = {
		if = {
			limit = {
				has_character_flag = RICE_way_of_saint_james_background_alt
			}
			remove_character_flag = RICE_way_of_saint_james_background_alt
		}
		# if = {
		# 	limit = { has_variable = RICE_saint_james_extra_toll_max_value }
		# 	remove_variable = RICE_saint_james_extra_toll_max_value
		# }
	}

}




# Discovering the tomb of Saint James
galicia.0013 = {
	type = character_event
	title = galicia.0013.t
	desc = galicia.0013.desc
	theme = RICE_theme_galicia_woods
	override_icon = { reference = "gfx/interface/icons/event_types/type_faith.dds" }

	left_portrait = {
		character = scope:chaplain
		animation = happiness
	}

	right_portrait = {
		character = scope:pelayo
		animation = personality_honorable
	}

	immediate = {
		title:c_santiago = {
			save_scope_as = santiago
		}
		save_scope_as = alfonso
		cp:councillor_court_chaplain = { save_scope_as = chaplain }
		religion:christianity_religion = { save_scope_as = christian }
		scope:chaplain = {
			add_character_modifier = {
				modifier = RICE_galicia_discovered_saint_james_tomb
			}
		}
		create_character = {
			location = root.capital_province
			culture = root.culture
			template = mendicant_mystic_character
			save_scope_as = pelayo
		}
		hidden_effect = {
			scope:pelayo = {
				add_character_modifier = {
					modifier = RICE_galicia_discovered_saint_james_tomb
				}
			}
		}
	}

	option = {
		name = galicia.0013.a
		trigger_event = galicia.0014	
	}
}

# Discovering the tomb of Saint James
galicia.0014 = {
	type = character_event
	title = galicia.0014.t
	desc = galicia.0014.desc
	theme = RICE_theme_galicia_woods
	override_icon = { reference = "gfx/interface/icons/event_types/type_faith.dds" }

	left_portrait = {
		character = scope:chaplain
		animation = personality_forgiving
	}

	right_portrait = {
		character = root
		animation = personality_rational
	}

	lower_center_portrait = scope:pelayo

	immediate = {		
		RICE_galicia_discover_saint_james_tomb_effect = yes
		scope:chaplain = {
			add_opinion = {
				target = scope:pelayo
				modifier = RICE_galicia_found_saint_james_tomb
			}
			reverse_add_opinion = {
				target = scope:pelayo
				modifier = RICE_galicia_found_saint_james_tomb
			}		
		}
		custom_tooltip = RICE_galicia_unlock_santiago_prayer_decision_tooltip
		custom_tooltip = RICE_galicia_unlock_santiago_routes_decision_tooltip
	}

	# Invite Pelayo to court
	option = {
		name = galicia.0014.a
		add_prestige = -250	
		add_courtier = scope:pelayo
	}

	# Let Pelayo stay in the wilderness
	option = {
		name = galicia.0014.b
		#add_piety = 100
		hidden_effect = {
			scope:pelayo = {
				death = {
					death_reason = death_vanished
				}
			}
		}
	}

	after = {
		every_ruler = {
			limit = {
				is_ai = no
				any_held_title = {
					tier = tier_county
					any_county_province = {
						OR = {
							geographical_region = world_europe_west
							geographical_region = world_europe_south_italy
							geographical_region = world_africa_north_west
						}
					}
				}
			}
			trigger_event = galicia.0015
		}
	}
}


# Altering the Altar - notification
galicia.0015 = {
	type = character_event
	title = galicia.0015.t
	desc = galicia.0015.desc
	theme = RICE_theme_galicia_woods
	override_icon = { reference = "gfx/interface/icons/event_types/type_faith.dds" }


	left_portrait = {
		character = scope:chaplain
		animation = personality_content
	}
	right_portrait = {
		character = scope:pelayo
		animation = personality_zealous
	}

	immediate = {
		play_music_cue = "mx_cue_epic_sacral_moment"
		scope:alfonso = {
			show_as_tooltip = {
				RICE_galicia_discover_saint_james_tomb_effect = yes
			}
		}
		custom_tooltip = RICE_galicia_unlock_santiago_prayer_decision_tooltip
		custom_tooltip = RICE_galicia_unlock_santiago_routes_decision_tooltip
	}

	option = {
		name = galicia.0015.a
		trigger = {
			religion = religion:christianity_religion
		}
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_galicia_unearth_saint_james_tomb_context_tooltip
		}
	}

	option = {
		name = galicia.0015.b
		trigger = {
			NOT = { religion = religion:christianity_religion }
		}
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_galicia_unearth_saint_james_tomb_context_tooltip
		}
	}
}




# Fortifying the Coast
galicia.0016 = {
	type = character_event
	title = galicia.0016.t
	desc = galicia.0016.desc
	theme = martial
	override_background = { event_background = RICE_background_iberian_beach }

	right_portrait = {
		character = root
		animation = war_defender
	}

	option = {
		name = galicia.0016.a
		RICE_galicia_fortify_coastal_regions_effect = yes
	}
}



######################################################################################
# 
# ALTERING THE ALTAR OF SAINT JAMES
# 
# galicia.0020-galicia.0029
# 
######################################################################################



# Altering the Altar
galicia.0020 = {
	type = character_event
	title = galicia.0020.t
	desc = galicia.0020.desc
	theme = faith

	left_portrait = {
		character = scope:diego_gelmirez
		animation = personality_dishonorable
	}

	right_portrait = {
		character = scope:chaplain
		animation = personality_content
	}

	immediate = {
		title:c_santiago = {
			save_scope_as = santiago
		}
		scope:diego_gelmirez = {
			add_to_global_variable_list = {
				name = RICE_galicia_altar_alterer_list # Dunno how else to do this
				target = this
			}	
		}
		cp:councillor_court_chaplain = { save_scope_as = chaplain }
		religion:christianity_religion = { save_scope_as = christian }
	}

	option = {
		name = galicia.0020.a
		custom_tooltip = galicia.0020.tooltip
		RICE_galicia_alter_the_altar_effect = yes
		every_ruler = {
			limit = {
				is_ai = no
				any_held_title = {
					tier = tier_county
					any_county_province = {
						OR = {
							geographical_region = world_europe_west
							geographical_region = world_europe_south_italy
							geographical_region = world_africa_north_west
						}
					}
				}
			}
			trigger_event = galicia.0021
		}	
	}
}


# Altering the Altar - notification
galicia.0021 = {
	type = character_event
	title = galicia.0021.t
	desc = galicia.0021.desc
	theme = faith

	left_portrait = {
		character = scope:diego_gelmirez
		animation = personality_dishonorable
	}

	right_portrait = {
		character = scope:chaplain
		animation = personality_content
	}

	immediate = {
		play_music_cue = "mx_cue_epic_sacral_moment"
		scope:diego_gelmirez = {
			show_as_tooltip = {
				RICE_galicia_alter_the_altar_effect = yes
			}
		}
	}

	option = {
		name = galicia.0021.a
		trigger = {
			religion = religion:christianity_religion
		}
	}

	option = {
		name = galicia.0021.b
		trigger = {
			NOT = { religion = religion:christianity_religion }
		}
	}
}


# 1117 rebellion is about to happen
galicia.0022 = {
	type = character_event
	title = galicia.0022.t
	desc = galicia.0022.desc
	theme = faith

	left_portrait = {
		character = root
		animation = worry
	}

	trigger = {
		NOT = { has_global_variable = RICE_galicia_santiago_tensions_rising }
		NOT = { has_global_variable = RICE_galicia_1117_rebellion_historical_event_timer }
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:RICE_santiago_altered
		}
		has_title = title:c_santiago
		religion = religion:christianity_religion
		title:c_santiago = {
			faith.religion = religion:christianity_religion
		}
		cp:councillor_court_chaplain = {
			exists = yes
			is_available_adult = yes
		}
	}

	weight_multiplier = {
		base = 1
		# If your court chaplain is nice, decrease the chances
		modifier = {
			add = -0.8
			cp:councillor_court_chaplain = {
				has_trait_benevolent_trigger = yes
			}
		}
		# If your court chaplain is a dick, increase the chances
		modifier = {
			add = 1.2
			cp:councillor_court_chaplain = {
				has_trait_malicious_trigger = yes
			}
		}
	}

	immediate = {
		title:c_santiago = {
			save_scope_as = santiago
		}
		religion:christianity_religion = { save_scope_as = christian }
		set_global_variable = {
			name = RICE_galicia_santiago_tensions_rising
			value = yes
		}
		ordered_in_global_list = {
			variable = RICE_galicia_altar_alterer_list
			save_scope_as = diego_gelmirez_ruler
		}
	}

	option = {
		name = galicia.0022.a
		custom_tooltip = galicia.0022.tooltip
	}
}


# 1117 Rebellion
galicia.0023 = {
	type = character_event
	title = galicia.0023.t
	desc = galicia.0023.desc
	theme = faith
	override_background = { event_background = burning_building }

	# left_portrait = {
	# 	character = scope:diego_gelmirez_ruler
	# 	animation = shock
	# }

	right_portrait = {
		character = scope:diego_gelmirez_priest
		animation = fear
	}

	trigger = {
		cp:councillor_court_chaplain = {
			exists = yes
			is_available_adult = yes
		}
		religion = religion:christianity_religion
		title:c_santiago = {
			faith.religion = religion:christianity_religion
		}		
	}

	immediate = {
		play_music_cue = "mx_cue_crusade_starts"
		save_scope_as = santiago_ruler
		cp:councillor_court_chaplain = { save_scope_as = diego_gelmirez_priest }		
		title:c_santiago = {
			save_scope_as = santiago
		}
		religion:christianity_religion = { save_scope_as = christian }
		set_global_variable = {
			name = RICE_galicia_1117_rebellion_happened
			value = yes
		}
		ordered_in_global_list = {
			variable = RICE_galicia_altar_alterer_list
			save_scope_as = diego_gelmirez_ruler
		}
	}

	option = {
		name = galicia.0023.a
		random_list = {
			desc = RICE_galicia_diego_gelmirez_attack_tt
			# Escapes with minor wounds
			60 = {
				show_chance = no
				desc = RICE_galicia_diego_gelmirez_attack.minor_wounds
				add_character_flag = RICE_galicia_diego_gelmirez_attack_minor_wounds
				send_interface_toast = {
					left_icon = ROOT
					title = RICE_galicia_diego_gelmirez_attack.minor_wounds
					cp:councillor_court_chaplain = {
						increase_wounds_effect = { REASON = wounds }
					}
				}
			}			
			# Escapes with major wounds
			25 = {
				show_chance = no
				desc = RICE_galicia_diego_gelmirez_attack.major_wounds
				add_character_flag = RICE_galicia_diego_gelmirez_attack_major_wounds
				send_interface_toast = {
					left_icon = ROOT
					title = RICE_galicia_diego_gelmirez_attack.major_wounds
					cp:councillor_court_chaplain = {
						add_trait = maimed
					}
				}
			}			
			# Dies
			15 = {
				show_chance = no
				desc = RICE_galicia_diego_gelmirez_attack.dies
				add_character_flag = RICE_galicia_diego_gelmirez_attack_dies
				send_interface_toast = {
					left_icon = ROOT
					title = RICE_galicia_diego_gelmirez_attack.dies
					cp:councillor_court_chaplain = {
						death = {
							death_reason = death_beaten_by_mob
						}
					}
				}
			}			
		}
		RICE_galicia_1117_uprising_effect = yes
		every_ruler = {
			limit = {
				is_ai = no
				any_held_title = {
					tier = tier_county
					any_county_province = {
						OR = {
							geographical_region = world_europe_west
							geographical_region = world_europe_south_italy
							geographical_region = world_africa_north_west
						}
					}
				}
			}
			trigger_event = galicia.0024
		}
	}
	
}


# 1117 Rebellion - notification
galicia.0024 = {
	type = character_event
	title = galicia.0024.t
	desc = {
		desc = galicia.0024.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					scope:diego_gelmirez_ruler = {
						has_character_flag = RICE_galicia_diego_gelmirez_attack_minor_wounds
					}
				}
				desc = galicia.0024.desc.minor_wounds
			}
			triggered_desc = {
				trigger = {
					scope:diego_gelmirez_ruler = {
						has_character_flag = RICE_galicia_diego_gelmirez_attack_major_wounds
					}
				}
				desc = galicia.0024.desc.major_wounds
			}
			triggered_desc = {
				trigger = {
					scope:diego_gelmirez_ruler = {
						has_character_flag = RICE_galicia_diego_gelmirez_attack_dies
					}
				}
				desc = galicia.0024.desc.dies
			}
		}
		#desc = galicia.0024.desc.conclusion
	}
	theme = faith

	left_portrait = {
		character = scope:diego_gelmirez_ruler
		animation = stress
	}

	right_portrait = {
		character = scope:diego_gelmirez_priest
		animation = severelywounded
	}

	immediate = {
		play_music_cue = "mx_cue_epic_sacral_moment"
		scope:diego_gelmirez_ruler = {
			show_as_tooltip = {
				RICE_galicia_1117_uprising_effect = yes
			}
		}
	}

	option = {
		name = galicia.0024.a
		trigger = {
			religion = religion:christianity_religion
		}
		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_description_no_bullet = {
				text = RICE_galicia_1117_rebellion_context_tooltip
			}
		}
	}

	option = {
		name = galicia.0024.b
		trigger = {
			NOT = { religion = religion:christianity_religion }
		}
		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_description_no_bullet = {
				text = RICE_galicia_1117_rebellion_context_tooltip
			}
		}
	}
}

######################################################################################
# 
# CANTIGAS
# 
# galicia.0030-galicia.0039
# 
######################################################################################



# Start work on the Cantiga
galicia.0030 = {
	type = character_event
	title = galicia.0030.t
	desc = {
		desc = galicia.0030.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_type = flag:courtly_love
				}
				desc = galicia.0030.desc.courtly_love
			}
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_type = flag:romantic_love
				}
				desc = galicia.0030.desc.romantic_love
			}
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_type = flag:satire
				}
				desc = galicia.0030.desc.satire
			}
		}
		desc = galicia.0030.desc.conclusion
	}
	theme = learning
	override_icon = {
		trigger = { var:RICE_cantiga_type = flag:courtly_love }
		reference = "gfx/interface/icons/event_types/type_duty.dds"
	}
	override_icon = {
		trigger = { var:RICE_cantiga_type = flag:romantic_love }
		reference = "gfx/interface/icons/event_types/type_seduction.dds"
	}
	override_icon = {
		trigger = { var:RICE_cantiga_type = flag:satire }
		reference = "gfx/interface/icons/event_types/type_relation_friendly.dds"
	}

	right_portrait = {
		character = root
		animation = chancellor
	}

	immediate = {
		capital_province = { save_scope_as = capital_province } #For loc.
		add_character_flag = planning_an_activity
		if = {
			limit = {
				NOT = { has_variable = RICE_num_of_cantigas_written }
			}
			set_variable = {
				name = RICE_num_of_cantigas_written
				value = 1
			}
		}
		else = {
			change_variable = {
				name = RICE_num_of_cantigas_written
				add = 1
			}
		}
	}

	# Start work on the cantiga
	option = {
		name = galicia.0030.a
		# Choose appropriate location
		scope:capital_province = {	
			spawn_activity = {
				owner = root
				type = activity_galicia_compose_cantiga
			}	
		}
		if = {
			limit = {
				var:RICE_cantiga_type = flag:courtly_love
			}
			custom_tooltip = galicia.0030.tooltip.courtly_love
		}
		else_if = {
			limit = {
				var:RICE_cantiga_type = flag:courtly_love
			}
			custom_tooltip = galicia.0030.tooltip.courtly_love
		}
		else_if = {
			limit = {
				var:RICE_cantiga_type = flag:satire
			}
			custom_tooltip = galicia.0030.tooltip.satire				
		}
	}

}


# Choose a topic
galicia.0031 = {
	type = character_event
	title = galicia.0031.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_type = flag:courtly_love
				}
				desc = galicia.0031.desc.intro.courtly_love
			}
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_type = flag:romantic_love
					is_female = yes
				}
				desc = galicia.0031.desc.intro.romantic_love.female
			}
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_type = flag:romantic_love
					is_female = no
				}
				desc = galicia.0031.desc.intro.romantic_love.male
			}
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_type = flag:satire
				}
				desc = galicia.0031.desc.intro.satire
			}
		}
		desc = galicia.0031.desc.conclusion
	}
	theme = learning
	override_icon = {
		trigger = { var:RICE_cantiga_type = flag:courtly_love }
		reference = "gfx/interface/icons/event_types/type_duty.dds"
	}
	override_icon = {
		trigger = { var:RICE_cantiga_type = flag:romantic_love }
		reference = "gfx/interface/icons/event_types/type_seduction.dds"
	}
	override_icon = {
		trigger = { var:RICE_cantiga_type = flag:satire }
		reference = "gfx/interface/icons/event_types/type_relation_friendly.dds"
	}

	right_portrait = {
		character = root
		animation = personality_rational
	}

	immediate = {
		RICE_galicia_assign_cantiga_themes_1_effect = yes
		RICE_galicia_assign_cantiga_themes_2_effect = yes
		RICE_galicia_assign_cantiga_themes_3_effect = yes
	}

	# Option 1
	option = {
		# Diplomacy Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_music
			}
			text = cantiga_theme.music
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_female_dialogue
			}
			text = cantiga_theme.female_dialogue
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_beauty_lady
			}
			text = cantiga_theme.beauty_lady
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_joy
			}
			text = cantiga_theme.joy
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_sad
			}
			text = cantiga_theme.sad
		}
		# Martial Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_war
			}
			text = cantiga_theme.war
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_anger
			}
			text = cantiga_theme.anger
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_feudalism
			}
			text = cantiga_theme.feudalism
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_dying_for_love
			}
			text = cantiga_theme.dying_for_love
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_holy_land
			}
			text = cantiga_theme.holy_land
		}
		# Stewardship Themes
		name = {
			trigger = {
				has_character_flag = RICE_galicia_cantiga_theme_1_sea
			}
			text = cantiga_theme.sea
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_pastoral
			}
			text = cantiga_theme.pastoral
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_trade
			}
			text = cantiga_theme.trade
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_springs
			}
			text = cantiga_theme.springs
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_urban
			}
			text = cantiga_theme.urban
		}
		# Intrigue Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_erotic
			}
			text = cantiga_theme.erotic
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_cheating
			}
			text = cantiga_theme.cheating
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_rendezvous
			}
			text = cantiga_theme.rendezvous
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_jealousy
			}
			text = cantiga_theme.jealousy
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_court_politics
			}
			text = cantiga_theme.court_politics
		}
		# Learning Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_pilgrimage
			}
			text = cantiga_theme.pilgrimage
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_piety
			}
			text = cantiga_theme.piety
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_loneliness
			}
			text = cantiga_theme.loneliness
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_travel
			}
			text = cantiga_theme.travel
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_1_values
			}
			text = cantiga_theme.values
		}

		# Diplomacy Themes
		if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_music			
			}
			custom_tooltip = cantiga_theme.tooltip.music
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_1_music
			add_character_flag = RICE_galicia_cantiga_chosen_theme_music
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_female_dialogue			
			}
			custom_tooltip = cantiga_theme.tooltip.female_dialogue
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_1_female_dialogue
			add_character_flag = RICE_galicia_cantiga_chosen_theme_female_dialogue
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_beauty_lady			
			}
			custom_tooltip = cantiga_theme.tooltip.beauty_lady
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_1_beauty_lady
			add_character_flag = RICE_galicia_cantiga_chosen_theme_beauty_lady
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_joy			
			}
			custom_tooltip = cantiga_theme.tooltip.joy
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_1_joy
			add_character_flag = RICE_galicia_cantiga_chosen_theme_joy
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_sad			
			}
			custom_tooltip = cantiga_theme.tooltip.sad
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_1_sad
			add_character_flag = RICE_galicia_cantiga_chosen_theme_sad
		}
		# Martial Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_war				
			}
			custom_tooltip = cantiga_theme.tooltip.war
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_1_war
			add_character_flag = RICE_galicia_cantiga_chosen_theme_war
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_anger				
			}
			custom_tooltip = cantiga_theme.tooltip.anger
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_1_anger
			add_character_flag = RICE_galicia_cantiga_chosen_theme_anger
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_feudalism				
			}
			custom_tooltip = cantiga_theme.tooltip.feudalism
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_1_feudalism
			add_character_flag = RICE_galicia_cantiga_chosen_theme_feudalism
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_dying_for_love				
			}
			custom_tooltip = cantiga_theme.tooltip.dying_for_love
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_1_dying_for_love
			add_character_flag = RICE_galicia_cantiga_chosen_theme_dying_for_love
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_holy_land				
			}
			custom_tooltip = cantiga_theme.tooltip.holy_land
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_1_holy_land
			add_character_flag = RICE_galicia_cantiga_chosen_theme_holy_land
		}
		# Stewardship Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_sea				
			}
			custom_tooltip = cantiga_theme.tooltip.sea
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_1_sea
			add_character_flag = RICE_galicia_cantiga_chosen_theme_sea
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_pastoral				
			}
			custom_tooltip = cantiga_theme.tooltip.pastoral
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_1_pastoral
			add_character_flag = RICE_galicia_cantiga_chosen_theme_pastoral
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_trade				
			}
			custom_tooltip = cantiga_theme.tooltip.trade
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_1_trade
			add_character_flag = RICE_galicia_cantiga_chosen_theme_trade
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_springs				
			}
			custom_tooltip = cantiga_theme.tooltip.springs
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_1_springs
			add_character_flag = RICE_galicia_cantiga_chosen_theme_springs
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_urban				
			}
			custom_tooltip = cantiga_theme.tooltip.urban
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_1_urban
			add_character_flag = RICE_galicia_cantiga_chosen_theme_urban
		}
		# Intrigue Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_erotic				
			}
			custom_tooltip = cantiga_theme.tooltip.erotic
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_1_erotic
			add_character_flag = RICE_galicia_cantiga_chosen_theme_erotic
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_cheating				
			}
			custom_tooltip = cantiga_theme.tooltip.cheating
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_1_cheating
			add_character_flag = RICE_galicia_cantiga_chosen_theme_cheating
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_rendezvous				
			}
			custom_tooltip = cantiga_theme.tooltip.rendezvous
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_1_rendezvous
			add_character_flag = RICE_galicia_cantiga_chosen_theme_rendezvous
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_jealousy				
			}
			custom_tooltip = cantiga_theme.tooltip.jealousy
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_1_jealousy
			add_character_flag = RICE_galicia_cantiga_chosen_theme_jealousy
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_court_politics				
			}
			custom_tooltip = cantiga_theme.tooltip.court_politics
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_1_court_politics
			add_character_flag = RICE_galicia_cantiga_chosen_theme_court_politics
		}
		# Learning Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_pilgrimage				
			}
			custom_tooltip = cantiga_theme.tooltip.pilgrimage
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_1_pilgrimage
			add_character_flag = RICE_galicia_cantiga_chosen_theme_pilgrimage
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_piety				
			}
			custom_tooltip = cantiga_theme.tooltip.piety
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_1_piety
			add_character_flag = RICE_galicia_cantiga_chosen_theme_piety
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_loneliness				
			}
			custom_tooltip = cantiga_theme.tooltip.loneliness
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_1_loneliness
			add_character_flag = RICE_galicia_cantiga_chosen_theme_loneliness
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_travel				
			}
			custom_tooltip = cantiga_theme.tooltip.travel
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_1_travel
			add_character_flag = RICE_galicia_cantiga_chosen_theme_travel
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_1_values				
			}
			custom_tooltip = cantiga_theme.tooltip.values
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_1_values
			add_character_flag = RICE_galicia_cantiga_chosen_theme_values
		}
	}

	# Option 2
	option = {
		# Diplomacy Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_music
			}
			text = cantiga_theme.music
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_female_dialogue
			}
			text = cantiga_theme.female_dialogue
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_beauty_lady
			}
			text = cantiga_theme.beauty_lady
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_joy
			}
			text = cantiga_theme.joy
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_sad
			}
			text = cantiga_theme.sad
		}
		# Martial Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_war
			}
			text = cantiga_theme.war
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_anger
			}
			text = cantiga_theme.anger
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_feudalism
			}
			text = cantiga_theme.feudalism
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_dying_for_love
			}
			text = cantiga_theme.dying_for_love
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_holy_land
			}
			text = cantiga_theme.holy_land
		}
		# Stewardship Themes
		name = {
			trigger = {
				has_character_flag = RICE_galicia_cantiga_theme_2_sea
			}
			text = cantiga_theme.sea
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_pastoral
			}
			text = cantiga_theme.pastoral
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_trade
			}
			text = cantiga_theme.trade
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_springs
			}
			text = cantiga_theme.springs
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_urban
			}
			text = cantiga_theme.urban
		}
		# Intrigue Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_erotic
			}
			text = cantiga_theme.erotic
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_cheating
			}
			text = cantiga_theme.cheating
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_rendezvous
			}
			text = cantiga_theme.rendezvous
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_jealousy
			}
			text = cantiga_theme.jealousy
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_court_politics
			}
			text = cantiga_theme.court_politics
		}
		# Learning Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_pilgrimage
			}
			text = cantiga_theme.pilgrimage
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_piety
			}
			text = cantiga_theme.piety
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_loneliness
			}
			text = cantiga_theme.loneliness
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_travel
			}
			text = cantiga_theme.travel
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_2_values
			}
			text = cantiga_theme.values
		}

		# Diplomacy Themes
		if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_music			
			}
			custom_tooltip = cantiga_theme.tooltip.music
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_2_music
			add_character_flag = RICE_galicia_cantiga_chosen_theme_music
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_female_dialogue			
			}
			custom_tooltip = cantiga_theme.tooltip.female_dialogue
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_2_female_dialogue
			add_character_flag = RICE_galicia_cantiga_chosen_theme_female_dialogue
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_beauty_lady			
			}
			custom_tooltip = cantiga_theme.tooltip.beauty_lady
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_2_beauty_lady
			add_character_flag = RICE_galicia_cantiga_chosen_theme_beauty_lady
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_joy			
			}
			custom_tooltip = cantiga_theme.tooltip.joy
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_2_joy
			add_character_flag = RICE_galicia_cantiga_chosen_theme_joy
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_sad			
			}
			custom_tooltip = cantiga_theme.tooltip.sad
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_2_sad
			add_character_flag = RICE_galicia_cantiga_chosen_theme_sad
		}
		# Martial Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_war				
			}
			custom_tooltip = cantiga_theme.tooltip.war
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_2_war
			add_character_flag = RICE_galicia_cantiga_chosen_theme_war
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_anger				
			}
			custom_tooltip = cantiga_theme.tooltip.anger
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_2_anger
			add_character_flag = RICE_galicia_cantiga_chosen_theme_anger
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_feudalism				
			}
			custom_tooltip = cantiga_theme.tooltip.feudalism
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_2_feudalism
			add_character_flag = RICE_galicia_cantiga_chosen_theme_feudalism
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_dying_for_love				
			}
			custom_tooltip = cantiga_theme.tooltip.dying_for_love
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_2_dying_for_love
			add_character_flag = RICE_galicia_cantiga_chosen_theme_dying_for_love
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_holy_land				
			}
			custom_tooltip = cantiga_theme.tooltip.holy_land
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_2_holy_land
			add_character_flag = RICE_galicia_cantiga_chosen_theme_holy_land
		}
		# Stewardship Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_sea				
			}
			custom_tooltip = cantiga_theme.tooltip.sea
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_2_sea
			add_character_flag = RICE_galicia_cantiga_chosen_theme_sea
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_pastoral				
			}
			custom_tooltip = cantiga_theme.tooltip.pastoral
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_2_pastoral
			add_character_flag = RICE_galicia_cantiga_chosen_theme_pastoral
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_trade				
			}
			custom_tooltip = cantiga_theme.tooltip.trade
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_2_trade
			add_character_flag = RICE_galicia_cantiga_chosen_theme_trade
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_springs				
			}
			custom_tooltip = cantiga_theme.tooltip.springs
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_2_springs
			add_character_flag = RICE_galicia_cantiga_chosen_theme_springs
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_urban				
			}
			custom_tooltip = cantiga_theme.tooltip.urban
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_2_urban
			add_character_flag = RICE_galicia_cantiga_chosen_theme_urban
		}
		# Intrigue Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_erotic				
			}
			custom_tooltip = cantiga_theme.tooltip.erotic
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_2_erotic
			add_character_flag = RICE_galicia_cantiga_chosen_theme_erotic
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_cheating				
			}
			custom_tooltip = cantiga_theme.tooltip.cheating
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_2_cheating
			add_character_flag = RICE_galicia_cantiga_chosen_theme_cheating
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_rendezvous				
			}
			custom_tooltip = cantiga_theme.tooltip.rendezvous
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_2_rendezvous
			add_character_flag = RICE_galicia_cantiga_chosen_theme_rendezvous
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_jealousy				
			}
			custom_tooltip = cantiga_theme.tooltip.jealousy
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_2_jealousy
			add_character_flag = RICE_galicia_cantiga_chosen_theme_jealousy
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_court_politics				
			}
			custom_tooltip = cantiga_theme.tooltip.court_politics
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_2_court_politics
			add_character_flag = RICE_galicia_cantiga_chosen_theme_court_politics
		}
		# Learning Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_pilgrimage				
			}
			custom_tooltip = cantiga_theme.tooltip.pilgrimage
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_2_pilgrimage
			add_character_flag = RICE_galicia_cantiga_chosen_theme_pilgrimage
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_piety				
			}
			custom_tooltip = cantiga_theme.tooltip.piety
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_2_piety
			add_character_flag = RICE_galicia_cantiga_chosen_theme_piety
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_loneliness				
			}
			custom_tooltip = cantiga_theme.tooltip.loneliness
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_2_loneliness
			add_character_flag = RICE_galicia_cantiga_chosen_theme_loneliness
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_travel				
			}
			custom_tooltip = cantiga_theme.tooltip.travel
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_2_travel
			add_character_flag = RICE_galicia_cantiga_chosen_theme_travel
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_2_values				
			}
			custom_tooltip = cantiga_theme.tooltip.values
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_2_values
			add_character_flag = RICE_galicia_cantiga_chosen_theme_values
		}

	}

	# Option 3
	option = {
		# Diplomacy Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_music
			}
			text = cantiga_theme.music
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_female_dialogue
			}
			text = cantiga_theme.female_dialogue
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_beauty_lady
			}
			text = cantiga_theme.beauty_lady
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_joy
			}
			text = cantiga_theme.joy
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_sad
			}
			text = cantiga_theme.sad
		}
		# Martial Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_war
			}
			text = cantiga_theme.war
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_anger
			}
			text = cantiga_theme.anger
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_feudalism
			}
			text = cantiga_theme.feudalism
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_dying_for_love
			}
			text = cantiga_theme.dying_for_love
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_holy_land
			}
			text = cantiga_theme.holy_land
		}
		# Stewardship Themes
		name = {
			trigger = {
				has_character_flag = RICE_galicia_cantiga_theme_3_sea
			}
			text = cantiga_theme.sea
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_pastoral
			}
			text = cantiga_theme.pastoral
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_trade
			}
			text = cantiga_theme.trade
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_springs
			}
			text = cantiga_theme.springs
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_urban
			}
			text = cantiga_theme.urban
		}
		# Intrigue Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_erotic
			}
			text = cantiga_theme.erotic
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_cheating
			}
			text = cantiga_theme.cheating
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_rendezvous
			}
			text = cantiga_theme.rendezvous
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_jealousy
			}
			text = cantiga_theme.jealousy
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_court_politics
			}
			text = cantiga_theme.court_politics
		}
		# Learning Themes
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_pilgrimage
			}
			text = cantiga_theme.pilgrimage
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_piety
			}
			text = cantiga_theme.piety
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_loneliness
			}
			text = cantiga_theme.loneliness
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_travel
			}
			text = cantiga_theme.travel
		}
		name = {
			trigger = { 
				has_character_flag = RICE_galicia_cantiga_theme_3_values
			}
			text = cantiga_theme.values
		}

		# Diplomacy Themes
		if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_music			
			}
			custom_tooltip = cantiga_theme.tooltip.music
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_3_music
			add_character_flag = RICE_galicia_cantiga_chosen_theme_music
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_female_dialogue			
			}
			custom_tooltip = cantiga_theme.tooltip.female_dialogue
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_3_female_dialogue
			add_character_flag = RICE_galicia_cantiga_chosen_theme_female_dialogue
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_beauty_lady			
			}
			custom_tooltip = cantiga_theme.tooltip.beauty_lady
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_3_beauty_lady
			add_character_flag = RICE_galicia_cantiga_chosen_theme_beauty_lady
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_joy			
			}
			custom_tooltip = cantiga_theme.tooltip.joy
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_3_joy
			add_character_flag = RICE_galicia_cantiga_chosen_theme_joy
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_sad			
			}
			custom_tooltip = cantiga_theme.tooltip.sad
			custom_tooltip = cantiga_theme.tooltip.diplomacy
			remove_character_flag = RICE_galicia_cantiga_theme_3_sad
			add_character_flag = RICE_galicia_cantiga_chosen_theme_sad
		}
		# Martial Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_war				
			}
			custom_tooltip = cantiga_theme.tooltip.war
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_3_war
			add_character_flag = RICE_galicia_cantiga_chosen_theme_war
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_anger				
			}
			custom_tooltip = cantiga_theme.tooltip.anger
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_3_anger
			add_character_flag = RICE_galicia_cantiga_chosen_theme_anger
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_feudalism				
			}
			custom_tooltip = cantiga_theme.tooltip.feudalism
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_3_feudalism
			add_character_flag = RICE_galicia_cantiga_chosen_theme_feudalism
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_dying_for_love				
			}
			custom_tooltip = cantiga_theme.tooltip.dying_for_love
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_3_dying_for_love
			add_character_flag = RICE_galicia_cantiga_chosen_theme_dying_for_love
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_holy_land				
			}
			custom_tooltip = cantiga_theme.tooltip.holy_land
			custom_tooltip = cantiga_theme.tooltip.martial
			remove_character_flag = RICE_galicia_cantiga_theme_3_holy_land
			add_character_flag = RICE_galicia_cantiga_chosen_theme_holy_land
		}
		# Stewardship Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_sea				
			}
			custom_tooltip = cantiga_theme.tooltip.sea
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_3_sea
			add_character_flag = RICE_galicia_cantiga_chosen_theme_sea
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_pastoral				
			}
			custom_tooltip = cantiga_theme.tooltip.pastoral
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_3_pastoral
			add_character_flag = RICE_galicia_cantiga_chosen_theme_pastoral
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_trade				
			}
			custom_tooltip = cantiga_theme.tooltip.trade
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_3_trade
			add_character_flag = RICE_galicia_cantiga_chosen_theme_trade
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_springs				
			}
			custom_tooltip = cantiga_theme.tooltip.springs
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_3_springs
			add_character_flag = RICE_galicia_cantiga_chosen_theme_springs
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_urban				
			}
			custom_tooltip = cantiga_theme.tooltip.urban
			custom_tooltip = cantiga_theme.tooltip.stewardship
			remove_character_flag = RICE_galicia_cantiga_theme_3_urban
			add_character_flag = RICE_galicia_cantiga_chosen_theme_urban
		}
		# Intrigue Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_erotic				
			}
			custom_tooltip = cantiga_theme.tooltip.erotic
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_3_erotic
			add_character_flag = RICE_galicia_cantiga_chosen_theme_erotic
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_cheating				
			}
			custom_tooltip = cantiga_theme.tooltip.cheating
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_3_cheating
			add_character_flag = RICE_galicia_cantiga_chosen_theme_cheating
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_rendezvous				
			}
			custom_tooltip = cantiga_theme.tooltip.rendezvous
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_3_rendezvous
			add_character_flag = RICE_galicia_cantiga_chosen_theme_rendezvous
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_jealousy				
			}
			custom_tooltip = cantiga_theme.tooltip.jealousy
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_3_jealousy
			add_character_flag = RICE_galicia_cantiga_chosen_theme_jealousy
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_court_politics				
			}
			custom_tooltip = cantiga_theme.tooltip.court_politics
			custom_tooltip = cantiga_theme.tooltip.intrigue
			remove_character_flag = RICE_galicia_cantiga_theme_3_court_politics
			add_character_flag = RICE_galicia_cantiga_chosen_theme_court_politics
		}
		# Learning Themes
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_pilgrimage				
			}
			custom_tooltip = cantiga_theme.tooltip.pilgrimage
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_3_pilgrimage
			add_character_flag = RICE_galicia_cantiga_chosen_theme_pilgrimage
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_piety				
			}
			custom_tooltip = cantiga_theme.tooltip.piety
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_3_piety
			add_character_flag = RICE_galicia_cantiga_chosen_theme_piety
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_loneliness				
			}
			custom_tooltip = cantiga_theme.tooltip.loneliness
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_3_loneliness
			add_character_flag = RICE_galicia_cantiga_chosen_theme_loneliness
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_travel				
			}
			custom_tooltip = cantiga_theme.tooltip.travel
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_3_travel
			add_character_flag = RICE_galicia_cantiga_chosen_theme_travel
		}
		else_if = {
			limit = {
				has_character_flag = RICE_galicia_cantiga_theme_3_values				
			}
			custom_tooltip = cantiga_theme.tooltip.values
			custom_tooltip = cantiga_theme.tooltip.learning
			remove_character_flag = RICE_galicia_cantiga_theme_3_values
			add_character_flag = RICE_galicia_cantiga_chosen_theme_values
		}

	}

	after = {
		custom_tooltip = galicia.0031.tooltip.after
		hidden_effect = {
			RICE_galicia_determine_quality_effect = yes
		}
		trigger_event = {
			id = galicia.0032
			days = { 7 14 }			
		}
	}

}


# Cantiga finished composing
galicia.0032 = {
	type = character_event
	title = galicia.0032.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_type = flag:courtly_love
				}
				desc = galicia.0032.desc.intro.courtly_love
			}
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_type = flag:romantic_love
				}
				desc = galicia.0032.desc.intro.romantic_love
			}
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_type = flag:satire
				}
				desc = galicia.0032.desc.intro.satire
			}
		}
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_quality = flag:acceptable
				}
				desc = galicia.0032.desc.acceptable
			}
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_quality = flag:good
				}
				desc = galicia.0032.desc.good
			}
			triggered_desc = {
				trigger = {
					var:RICE_cantiga_quality = flag:excellent
				}
				desc = galicia.0032.desc.excellent
			}
		}
		desc = galicia.0032.desc.conclusion
	}
	theme = learning
	override_icon = {
		trigger = { var:RICE_cantiga_type = flag:courtly_love }
		reference = "gfx/interface/icons/event_types/type_duty.dds"
	}
	override_icon = {
		trigger = { var:RICE_cantiga_type = flag:romantic_love }
		reference = "gfx/interface/icons/event_types/type_seduction.dds"
	}
	override_icon = {
		trigger = { var:RICE_cantiga_type = flag:satire }
		reference = "gfx/interface/icons/event_types/type_relation_friendly.dds"
	}

	right_portrait = {
		character = root
		animation = chancellor
	}

	immediate = {
		play_music_cue = mx_cue_touching_moment
		hidden_effect = {
			if = {
				limit = {
					var:RICE_cantiga_quality = flag:excellent
				}
				if = {
					limit = {
						var:RICE_cantiga_type = flag:courtly_love
					}
					add_character_flag = {
						flag = RICE_recently_wrote_excellent_cantiga_courtly_love
						years = 5
					}
				}
				else_if = {
					limit = {
						var:RICE_cantiga_type = flag:romantic_love
					}
					add_character_flag = {
						flag = RICE_recently_wrote_excellent_cantiga_romantic_love
						years = 5
					}
				}
				else_if = {
					limit = {
						var:RICE_cantiga_type = flag:satire
					}	
					add_character_flag = {
						flag = RICE_recently_wrote_excellent_cantiga_satire
						years = 5
					}			
				}
				RICE_galicia_cantiga_completed_excellent_effect = yes
			}
			else_if = {
				limit = {
					var:RICE_cantiga_quality = flag:good
				}
				if = {
					limit = {
						var:RICE_cantiga_type = flag:courtly_love
					}
					add_character_flag = {
						flag = RICE_recently_wrote_good_cantiga_courtly_love
						years = 5
					}
				}
				else_if = {
					limit = {
						var:RICE_cantiga_type = flag:romantic_love
					}
					add_character_flag = {
						flag = RICE_recently_wrote_good_cantiga_romantic_love
						years = 5
					}
				}
				else_if = {
					limit = {
						var:RICE_cantiga_type = flag:satire
					}
					add_character_flag = {
						flag = RICE_recently_wrote_good_cantiga_satire
						years = 5
					}			
				}
				RICE_galicia_cantiga_completed_good_effect = yes
			}
			else = {
				if = {
					limit = {
						var:RICE_cantiga_type = flag:courtly_love
					}
					add_character_flag = {
						flag = RICE_recently_wrote_acceptable_cantiga_courtly_love
						years = 5
					}
				}
				else_if = {
					limit = {
						var:RICE_cantiga_type = flag:romantic_love
					}
					add_character_flag = {
						flag = RICE_recently_wrote_acceptable_cantiga_romantic_love
						years = 5
					}
				}
				else_if = {
					limit = {
						var:RICE_cantiga_type = flag:satire
					}	
					add_character_flag = {
						flag = RICE_recently_wrote_acceptable_cantiga_satire
						years = 5
					}			
				}
				RICE_galicia_cantiga_completed_acceptable_effect = yes
			}
		}
	}

	# Option 1
	option = {
		name = galicia.0032.a

		if = {
			limit = {
				var:RICE_cantiga_quality = flag:excellent
			}
			if = {
				limit = {
					var:RICE_cantiga_type = flag:courtly_love
				}
				add_piety = { 100 200 }
				add_prestige = { 50 100 }
			}
			else_if = {
				limit = {
					var:RICE_cantiga_type = flag:romantic_love
				}
				add_piety = { 50 100 }
				add_prestige = { 100 200 }
			}
			else_if = {
				limit = {
					var:RICE_cantiga_type = flag:satire
				}
				add_piety = { 50 200 }
				add_prestige = { 50 200 }		
			}
		}
		else_if = {
			limit = {
				var:RICE_cantiga_quality = flag:good
			}
			if = {
				limit = {
					var:RICE_cantiga_type = flag:courtly_love
				}
				add_piety = { 50 100 }
				add_prestige = { 25 50 }
			}
			else_if = {
				limit = {
					var:RICE_cantiga_type = flag:romantic_love
				}
				add_piety = { 25 50 }
				add_prestige = { 50 100 }
			}
			else_if = {
				limit = {
					var:RICE_cantiga_type = flag:satire
				}
				add_piety = { 25 100 }
				add_prestige = { 25 100 }				
			}
		}
		else = {
			if = {
				limit = {
					var:RICE_cantiga_type = flag:courtly_love
				}
				add_piety = { 25 50 }
				add_prestige = { 10 25 }
			}
			else_if = {
				limit = {
					var:RICE_cantiga_type = flag:romantic_love
				}
				add_piety = { 10 25 }
				add_prestige = { 25 50 }
			}
			else_if = {
				limit = {
					var:RICE_cantiga_type = flag:satire
				}
				add_piety = { 10 50 }
				add_prestige = { 10 50 }				
			}
		}

		# Not sure why in immediate it won't display the add_character_modifier stuff properly
		RICE_galicia_cantiga_modifier_display_effect = yes

		if = {
			limit = {
				var:RICE_cantiga_quality = flag:excellent
			}
			custom_tooltip = galicia.0032.tooltip.excellent
		}
	}

	after = {
		if = {
			limit = { has_variable = RICE_cantiga_type }
			remove_variable = RICE_cantiga_type
		}
		if = {
			limit = { has_variable = RICE_cantiga_quality }
			remove_variable = RICE_cantiga_quality
		}
		scope:activity = {
			complete_activity = yes
		}
	}

}






# Turning the Cantiga into an artifact
galicia.0033 = {
	type = character_event
	title = galicia.0033.t
	desc = galicia.0033.desc
	theme = learning

	right_portrait = {
		character = root
		animation = chancellor
	}

	artifact = { # To display the artifact in the event-window
		target = scope:RICE_cantiga
		position = lower_center_portrait
	}

	immediate = {
		save_scope_as = cantiga_composer
		# hidden_effect = {
		# 	RICE_galicia_turn_cantiga_into_artifact_effect = yes
		# }
		if = {
			limit = {
				has_character_flag = RICE_recently_wrote_excellent_cantiga_courtly_love
			}
			if = {
				limit = {
					culture = { has_cultural_tradition = tradition_RICE_galician_portuguese_poetry }
				}
				add_piety = 240
				add_prestige = 60
			}
			else = {
				add_piety = 200
				add_prestige = 50
			}
		}
		else_if = {
			limit = {
				has_character_flag = RICE_recently_wrote_excellent_cantiga_romantic_love
			}
			if = {
				limit = {
					culture = { has_cultural_tradition = tradition_RICE_galician_portuguese_poetry }
				}
				add_prestige = 240
				add_piety = 60
			}
			else = {
				add_prestige = 200
				add_piety = 50
			}
		}
		else_if = {
			limit = {
				has_character_flag = RICE_recently_wrote_excellent_cantiga_satire
			}
			if = {
				limit = {
					culture = { has_cultural_tradition = tradition_RICE_galician_portuguese_poetry }
				}
				add_prestige = 150
				add_piety = 150
			}
			else = {
				add_prestige = 125
				add_piety = 125
			}
		}
		add_character_modifier = {
			modifier = RICE_galicia_recently_promoted_cantiga
			years = 5
		}
		hidden_effect = {	
			RICE_galicia_turn_cantiga_into_artifact_effect = yes		
			#RICE_galicia_cantiga_add_genre_to_name_effect = yes
		}
	}

	option = {
		name = galicia.0033.a
		show_as_tooltip = {
			scope:RICE_cantiga = {
				set_owner = {
					target = root
				}
			}
		}
	}

	after = {
		if = {
			limit = {
				has_character_flag = RICE_recently_wrote_excellent_cantiga_courtly_love
			}
			remove_character_flag = RICE_recently_wrote_excellent_cantiga_courtly_love
		}
		else_if = {
			limit = {
				has_character_flag = RICE_recently_wrote_excellent_cantiga_romantic_love
			}
			remove_character_flag = RICE_recently_wrote_excellent_cantiga_romantic_love
		}
		else_if = {
			limit = {
				has_character_flag = RICE_recently_wrote_excellent_cantiga_satire
			}
			remove_character_flag = RICE_recently_wrote_excellent_cantiga_satire
		}
	}

}



######################################################################################
# 
# CANTIGAS DE SANTA MARIA
# 
# galicia.0040-galicia.0049
# 
######################################################################################



# Start to Compile the Cantigas de Santa Maria
galicia.0040 = {
	type = character_event
	title =  galicia.0040.t
	desc =  galicia.0040.desc
	theme = learning
	
	right_portrait = {
		character = root
		animation = chancellor
	}

	immediate = {
		save_scope_as = alfonso_x
		religion:christianity_religion = { save_scope_as = christian }
		add_character_modifier = {
			modifier = RICE_currently_compiling_CSM
		}
		set_global_variable = {
			name = RICE_CSM_compilation_timer
			value = yes
			days = 1825 # 1825
		}
		# scope:alfonso_x = {
		# 	add_to_global_variable_list = {
		# 		name = RICE_galicia_alfonso_x_equivalent # Dunno how else to do this
		# 		target = this
		# 	}	
		# }
	}

	option = { # OK
		name =  galicia.0040.a
	}
}



# Finish compiling the Cantigas de Santa Maria
galicia.0041 = {
	type = character_event
	title = galicia.0041.t
	desc = {
		desc = galicia.0041.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					religion = religion:christianity_religion
				}
				desc = galicia.0041.desc.christian
			}
			triggered_desc = {
				trigger = {
					NOT = { religion = religion:christianity_religion }
				}
				desc = galicia.0041.desc.non_christian
			}
		}
	}
	theme = learning
	
	left_portrait = {
		character = scope:alfonso_x
		animation = happiness
	}

	artifact = { # To display the artifact in the event-window
		target = scope:CSM
		position = lower_center_portrait
	}

	trigger = {
		NOT = { has_global_variable = RICE_CSM_compilation_timer }
		has_character_modifier = RICE_currently_compiling_CSM
	}
	
	immediate = {
		
		save_scope_as = alfonso_x
		religion:christianity_religion = { save_scope_as = christian }

		add_character_flag = RICE_galicia_csm_compiler

		play_music_cue = "mx_cue_epic_sacral_moment"

		remove_character_modifier = RICE_currently_compiling_CSM

		hidden_effect_new_artifact = {
			create_artifact = {
				name = RICE_galicia_cantigas_de_santa_maria_version_0_name
				description = RICE_galicia_cantigas_de_santa_maria_version_0_desc
				type = miscellaneous
				visuals = RICE_music_manuscript					
				quality = 100
				wealth = 100
				modifier = RICE_galicia_CSM_modifier_basic
				save_scope_as = CSM
				decaying = no
			}
			# scope:CSM = {
			# 	set_variable = RICE_CSM_0_variable
			# }
		}

	}

	option = { # Ok
		name = galicia.0041.a
		give_nickname = nick_the_wise
		add_prestige = 200
		if = {
			limit = {
				religion = religion:christianity_religion
			}
			add_piety = 200
		}
		dynasty = { add_dynasty_prestige = 200 }
		show_as_tooltip = {
			scope:CSM = {
				set_owner = {
					target = root
				}
			}
		}
		custom_tooltip = galicia.0041.tooltip
		every_ruler = {
			limit = {
				is_ai = no
				OR = {
					any_held_title = {
						tier = tier_county
						any_county_province = {
							geographical_region = world_europe_west_iberia
						}
					}
					culture = {
						OR = {
							has_cultural_pillar = heritage_iberian
							has_cultural_pillar = language_iberian
						}
					}
				}
			}
			trigger_event = galicia.0042
		}
	}
}



# Cantigas de Santa Maria notification
galicia.0042 = {
	type = character_event
	title = galicia.0042.t
	desc = galicia.0042.desc
	theme = learning
	
	left_portrait = {
		character = scope:alfonso_x
		animation = personality_content
	}

	immediate = {
		show_as_tooltip = {
			scope:alfonso_x = {
				give_nickname = nick_the_wise
				add_prestige = 200
				if = {
					limit = {
						scope:alfonso_x = {
							religion = religion:christianity_religion
						}
					}
					add_piety = 200
				}
				dynasty = { add_dynasty_prestige = 250 }
			}
			scope:CSM = {
				set_owner = {
					target = scope:alfonso_x
				}
			}
		}
	}
	
	option = { # Ok
		name = galicia.0042.a	
	}
}



# Character dies before completing the CSM
galicia.0043 = {
	type = empty
	hidden = yes
	
	trigger = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:RICE_CSM_compilation_taken
		}
		has_character_modifier = RICE_currently_compiling_CSM
	}
	
	immediate = {
		save_scope_as = CSM_original_compiler
		if = {
			limit = {
				exists = primary_heir
			}
			primary_heir = {
				trigger_event = {
					id = galicia.0044
					days = 1
				}
			}
		}
		# If heir doesn't exist for some reason, quietly re-enable it
		# Unlikely to happen since there should always be an heir, but this is a failsafe just in case
		else = {
			remove_list_global_variable = {
				name = unavailable_unique_decisions
				target = flag:RICE_CSM_compilation_taken
			}
		}
	}
}

# Heir continues work on the CSM
galicia.0044 = {
	type = character_event
	title = galicia.0044.t
	desc = galicia.0044.desc
	theme = learning
	
	left_portrait = {
		character = scope:CSM_original_compiler
		animation = personality_honorable
	}

	right_portrait = {
		character = root
		animation = worry
	}

	immediate = {
		add_character_modifier = {
			modifier = RICE_currently_compiling_CSM
		}
	}
	
	option = { # Ok
		name = galicia.0044.a
	}
}

# Expanding the CSM
galicia.0045 = {
	type = character_event
	title = galicia.0045.t
	desc = galicia.0045.desc
	theme = learning
	
	left_portrait = {
		character = scope:CSM_original_compiler
		animation = personality_honorable
	}

	right_portrait = {
		character = root
		animation = worry
	}

	immediate = {
		add_character_modifier = {
			modifier = RICE_currently_expanding_CSM
		}
		set_global_variable = {
			name = RICE_CSM_expansion_timer
			value = yes
			days = 1095 # 1095
		}
		if = {
			limit = {
				NOT = { has_variable = RICE_num_of_CSM_expansions }
			}
			set_variable = {
				name = RICE_num_of_CSM_expansions
				value = 1
			}
		}
		else = {
			change_variable = {
				name = RICE_num_of_CSM_expansions
				add = 1
			}
		}
	}
	
	option = { # Ok
		name = galicia.0045.a
		if = {
			limit = {
				var:RICE_num_of_CSM_expansions >= 3
			}
			set_global_variable = {
				name = RICE_galicia_no_more_CSM_expansions_allowed
				value = yes
			}
			custom_tooltip = RICE_galicia_no_more_CSM_expansions
		}
	}
}

# Finished expanding the CSM
galicia.0046 = {
	type = character_event
	title = galicia.0046.t
	desc = galicia.0046.desc
	theme = learning
	
	left_portrait = {
		character = scope:alfonso_x
		animation = personality_honorable
	}

	artifact = { # To display the artifact in the event-window
		target = scope:CSM_xp
		position = lower_center_portrait
	}

	trigger = {
		NOT = { has_global_variable = RICE_CSM_expansion_timer }
		has_character_modifier = RICE_currently_expanding_CSM
	}

	immediate = {
		save_scope_as = alfonso_x
		play_music_cue = mx_cue_touching_moment
		remove_character_modifier = RICE_currently_expanding_CSM
		hidden_effect_new_artifact = {
			create_artifact = {
				name = RICE_galicia_cantigas_de_santa_maria_version_0_name # Placeholder in case something goes weird
				description = RICE_galicia_cantigas_de_santa_maria_version_0_desc # Placeholder in case something goes weird
				type = miscellaneous
				visuals = RICE_music_manuscript					
				quality = 100
				wealth = 100
				modifier = RICE_galicia_CSM_modifier_basic # Placeholder in case something goes weird
				save_scope_as = CSM_xp
				decaying = no
			}
			# First expansion
			if = {
				limit = {
					var:RICE_num_of_CSM_expansions = 1
				}
				scope:CSM_xp = {
					add_artifact_modifier = RICE_galicia_CSM_modifier_xp_1
					set_artifact_name = RICE_galicia_cantigas_de_santa_maria_version_1_name
					set_artifact_description = RICE_galicia_cantigas_de_santa_maria_version_1_desc
					remove_artifact_modifier = RICE_galicia_CSM_modifier_basic					
				}
			}
			# Second expansion
			else_if = {
				limit = {
					var:RICE_num_of_CSM_expansions = 2
				}
				scope:CSM_xp = {
					add_artifact_modifier = RICE_galicia_CSM_modifier_xp_2
					set_artifact_name = RICE_galicia_cantigas_de_santa_maria_version_2_name
					set_artifact_description = RICE_galicia_cantigas_de_santa_maria_version_2_desc
					remove_artifact_modifier = RICE_galicia_CSM_modifier_basic					
				}
			}
			# Third expansion
			else_if = {
				limit = {
					var:RICE_num_of_CSM_expansions >= 3
				}
				scope:CSM_xp = {
					add_artifact_modifier = RICE_galicia_CSM_modifier_xp_3
					set_artifact_name = RICE_galicia_cantigas_de_santa_maria_version_3_name
					set_artifact_description = RICE_galicia_cantigas_de_santa_maria_version_3_desc
					remove_artifact_modifier = RICE_galicia_CSM_modifier_basic					
				}
			}
		}
	}
	
	option = { # Ok
		name = galicia.0046.a
		add_prestige = 150
		if = {
			limit = {
				religion = religion:christianity_religion
			}
			add_piety = 150
		}
		dynasty = { add_dynasty_prestige = 100 }
		if = {
			limit = {
				var:RICE_num_of_CSM_expansions >= 3
			}
			custom_tooltip = RICE_galicia_no_more_CSM_expansions
		}
	}
}





######################################################################################
# 
# FLAVOR EVENTS
# 
# galicia.0050-granada.0099 reserved
# 
######################################################################################


# Learning about Barallete, a special language of the knife-makers
galicia.0050 = {
	type = character_event
	title = galicia.0050.t
	desc = galicia.0050.desc
	theme = diplomacy_foreign_affairs_focus
	
	left_portrait = {
		character = root
		animation = personality_rational
	}
	
	trigger = {
		RICE_galicia_region_trigger = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = diligent
		}
		modifier = {
			add = -0.2
			has_trait = lazy
		}
		modifier = {
			add = 0.2
			has_trait = paranoid
		}
		modifier = {
			add = -0.2
			has_trait = trusting
		}
		modifier = {
			add = 0.2
			has_trait = humble
		}
		modifier = {
			add = -0.2
			has_trait = arrogant
		}
	}

	option = { # ok
		name = galicia.0050.a
		add_character_modifier = {
			modifier = RICE_galicia_learning_about_barallete
			years = 10
		}
		stress_impact = {
			arrogant = miniscule_stress_impact_gain
			paranoid = miniscule_stress_impact_gain
			lazy = miniscule_stress_impact_gain
		}
	}

	option = { # ok
		name = galicia.0050.b
		add_prestige = 50
		stress_impact = {
			humble = miniscule_stress_impact_gain
			patient = miniscule_stress_impact_gain
		}
	}
}



# Pedras de Abalar, the rocking stones of Galicia
galicia.0051 = {
	type = character_event
	title = galicia.0051.t
	desc = galicia.0051.desc
	theme = RICE_theme_galicia_woods
	
	right_portrait = root
	
	trigger = {
		RICE_galicia_region_trigger = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = diligent
		}
		modifier = {
			add = -0.2
			has_trait = lazy
		}
		modifier = {
			add = 0.2
			has_trait = just
		}
		modifier = {
			add = -0.2
			has_trait = arbitrary
		}
		modifier = {
			add = 0.2
			has_trait = ambitious
		}
		modifier = {
			add = -0.2
			has_trait = content
		}
	}

	option = { # ok
		name = galicia.0051.a		
		stress_impact = {
			just = miniscule_stress_impact_gain
			paranoid = miniscule_stress_impact_gain
			diligent = miniscule_stress_impact_gain
		}
	}

	option = { # ok
		name = galicia.0051.b
		add_prestige = -150
		add_character_modifier = {
			modifier = RICE_galicia_discouraged_trial_by_rocking_stones
			years = 10
		}
		stress_impact = {
			lazy = miniscule_stress_impact_gain
			craven = miniscule_stress_impact_gain
		}
	}
}




# Tales of the ancient Briton inhabitants of Galicia
galicia.0052 = {
	type = character_event
	title = galicia.0052.t
	desc = galicia.0052.desc
	theme = RICE_theme_galicia_woods
	
	left_portrait = {
		character = root
		animation = personality_rational
	}
	
	trigger = {
		RICE_galicia_region_trigger = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = shy
		}
		modifier = {
			add = -0.2
			has_trait = gregarious
		}
		modifier = {
			add = 0.2
			has_trait = humble
		}
		modifier = {
			add = -0.2
			has_trait = arrogant
		}
		modifier = {
			add = 0.2
			has_trait = patient
		}
		modifier = {
			add = -0.2
			has_trait = impatient
		}
	}

	option = { # ok
		name = galicia.0052.a		
		add_character_modifier = {
			modifier = RICE_galicia_tales_of_britons
			years = 5
		}
	}
}



# Hórreo granaries
galicia.0053 = {
	type = character_event
	title = galicia.0053.t
	desc = galicia.0053.desc
	theme = RICE_theme_camino_de_santiago_road
	
	left_portrait = {
		character = root
		animation = personality_rational
	}
	
	trigger = {
		RICE_galicia_region_trigger = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = diligent
		}
		modifier = {
			add = -0.2
			has_trait = lazy
		}
		modifier = {
			add = 0.2
			has_trait = just
		}
		modifier = {
			add = -0.2
			has_trait = arbitrary
		}
		modifier = {
			add = 0.2
			has_trait = humble
		}
		modifier = {
			add = -0.2
			has_trait = arrogant
		}
	}

	option = { # ok
		name = galicia.0053.a		
		add_character_modifier = {
			modifier = RICE_galicia_horreo_info
			years = 8
		}
	}
}



# Acquire some Galician horses or not?
galicia.0054 = {
	type = character_event
	title = galicia.0054.t
	desc = galicia.0054.desc
	theme = RICE_theme_camino_de_santiago_road
	
	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	trigger = {
		RICE_galicia_region_trigger = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = diligent
		}
		modifier = {
			add = -0.2
			has_trait = lazy
		}
		modifier = {
			add = 0.2
			has_trait = brave
		}
		modifier = {
			add = -0.2
			has_trait = craven
		}
		modifier = {
			add = 0.2
			has_trait = ambitious
		}
		modifier = {
			add = -0.2
			has_trait = content
		}
	}

	immediate = {
		random_held_title = {
			limit = {
				tier = tier_county
				any_county_province = {
					geographical_region = RICE_galicia_region		
				}
			}	
			save_scope_as = county
		}
	}

	option = { # ok
		name = galicia.0054.a
		trigger = {
			OR = {
				is_ai = no
				gold >= 80
			}
		}
		remove_short_term_gold = 80
		add_prestige = 100	
		add_character_modifier = {
			modifier = RICE_galicia_bought_horses
			years = 10
		}
	}

	option = { # Locals should sell it to neighboring regions
		name = galicia.0054.b
		scope:county = {
			add_county_modifier = {
				modifier = RICE_galicia_sold_horses
				years = 10
			}
		}
	}

	option = { # Locals should keep the horses
		name = galicia.0054.c
		scope:county = {
			add_county_modifier = {
				modifier = RICE_galicia_kept_horses
				years = 10
			}
		}
	}

}



# A nobleman supposedly dies after encountering Mouros (based on a legend involving a 15th/16th century Spanish nobleman)
galicia.0055 = {
	type = character_event
	title = galicia.0055.t
	desc = galicia.0055.desc
	theme = death
	override_background = { event_background = RICE_background_camino_de_santiago_church }
	
	right_portrait = {
		character = root
		animation = worry
	}
	
	trigger = {
		RICE_galicia_region_trigger = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = compassionate
		}
		modifier = {
			add = -0.2
			has_trait = callous
		}
		modifier = {
			add = 0.2
			has_trait = gregarious
		}
		modifier = {
			add = -0.2
			has_trait = shy
		}
		modifier = {
			add = 0.2
			has_trait = zealous
		}
		modifier = {
			add = -0.2
			has_trait = cynical
		}
	}

	immediate = {
		random_held_title = {
			limit = {
				tier = tier_county
				any_county_province = {
					geographical_region = RICE_galicia_region		
				}
			}	
			save_scope_as = county
		}
	}

	option = { # ok
		name = galicia.0055.a
		add_prestige = 25
		stress_impact = {
			zealous = miniscule_stress_impact_gain
			paranoid = miniscule_stress_impact_gain
		}
	}

	option = { # ok
		name = galicia.0055.b
		add_piety = 25
		stress_impact = {
			cynical = miniscule_stress_impact_gain
			greedy = miniscule_stress_impact_gain
		}
	}

}



# Villagers make offerings of hens to the moura of a cave for good luck
galicia.0056 = {
	type = character_event
	title = galicia.0056.t
	desc = galicia.0056.desc
	theme = faith
	override_background = { event_background = RICE_background_galicia_woods }
	
	right_portrait = root
	
	trigger = {
		RICE_galicia_region_trigger = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = patient
		}
		modifier = {
			add = -0.2
			has_trait = impatient
		}
		modifier = {
			add = 0.2
			has_trait = paranoid
		}
		modifier = {
			add = -0.2
			has_trait = trusting
		}
		modifier = {
			add = 0.2
			has_trait = diligent
		}
		modifier = {
			add = -0.2
			has_trait = lazy
		}
	}

	immediate = {
		random_held_title = {
			limit = {
				tier = tier_county
				any_county_province = {
					geographical_region = RICE_galicia_region		
				}
			}	
			save_scope_as = county
		}
	}

	option = { # Leave an offering yorself
		name = galicia.0056.a
		trigger = {
			OR = {
				is_ai = no
				gold >= 20
			}
		}
		remove_short_term_gold = 20
		add_piety = -50		
		random = {
			chance = 33
			send_interface_toast = {
				left_icon = ROOT
				title = galicia.0056.a.title
				add_character_modifier = {
					modifier = RICE_galicia_moura_blessing
					years = 10
				}
			}
		}
		stress_impact = {
			cynical = miniscule_stress_impact_gain
			lazy = miniscule_stress_impact_gain
		}
	}

	option = { # Silly superstition
		name = galicia.0056.b
	}

	option = { # Forbid them from doing it
		name = galicia.0056.c
		add_prestige = -50
		add_piety = 50
		scope:county = {
			add_county_modifier = {
				modifier = RICE_galicia_forbade_offerings_to_a_local_moura
				years = 10
			}
		}
		stress_impact = {
			humble = miniscule_stress_impact_gain
			lazy = miniscule_stress_impact_gain
		}
	}
}




# Hearing the story of Saint James and Queen Lupa
galicia.0057 = {
	type = character_event
	title = galicia.0057.t
	desc = galicia.0057.desc
	theme = faith
	override_background = { event_background = throne_room }
	
	right_portrait = {
		character = root
		animation = personality_zealous
	}
	
	trigger = {
		RICE_galicia_region_trigger = yes
		religion = religion:christianity_religion
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = zealous
		}
		modifier = {
			add = -0.2
			has_trait = cynical
		}
		modifier = {
			add = 0.2
			has_trait = gregarious
		}
		modifier = {
			add = -0.2
			has_trait = shy
		}
		modifier = {
			add = 0.2
			has_trait = patient
		}
		modifier = {
			add = -0.2
			has_trait = impatient
		}
	}

	immediate = {
		religion:christianity_religion = { save_scope_as = christian }
	}


	option = { # Ok
		name = galicia.0057.a
		add_character_modifier = {
			modifier = RICE_galicia_inspired_by_saint_james
			years = 5
		}
	}

	option = { # Ok
		name = galicia.0057.b
		add_character_modifier = {
			modifier = RICE_galicia_inspired_by_queen_lupa
			years = 5
		}
	}

}


# Bandits caught extorting money from pilgrims along the Way of Saint James
galicia.0058 = {
	type = character_event
	title = galicia.0058.t
	desc = galicia.0058.desc
	theme = corruption
	
	right_portrait = {
		character = root
		animation = war_defender
	}
	
	trigger = {
		RICE_galicia_santiago_pilgrimage_region_but_not_santiago_trigger = yes
		religion = religion:christianity_religion
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = diligent
		}
		modifier = {
			add = -0.2
			has_trait = lazy
		}
		modifier = {
			add = 0.2
			has_trait = just
		}
		modifier = {
			add = -0.2
			has_trait = arbitrary
		}
		modifier = {
			add = 0.2
			has_trait = compassionate
		}
		modifier = {
			add = -0.2
			has_trait = callous
		}
	}

	immediate = {
		title:c_santiago = {
			save_scope_as = santiago
		}
		religion:christianity_religion = { save_scope_as = christian }
		random_held_title = {
			limit = {
				tier = tier_county
				NOT = { this = title:c_santiago }
				any_county_province = {
					OR = {
						geographical_region = world_europe_west_iberia
						geographical_region = custom_occitan
					}
				}
			}	
			save_scope_as = county
		}		
	}


	option = { # Ok
		name = galicia.0058.a
		add_piety = 50
		add_character_modifier = {
			modifier = RICE_galicia_offered_criminals_a_second_chance
			years = 10
		}
		stress_impact = {
			cynical = minor_stress_impact_gain
			vengeful = minor_stress_impact_gain
			sadistic = miniscule_stress_impact_gain
		}
	}

	option = { # Ok
		name = galicia.0058.b
		add_prestige = 50
		scope:county = {
			add_county_modifier = {
				modifier = RICE_galicia_punished_pilgrim_extortionists
				years = 10
			}
		}
		stress_impact = {
			zealous = minor_stress_impact_gain
			forgiving = minor_stress_impact_gain
			compassionate = miniscule_stress_impact_gain
		}
	}

}



# Criminals going on pilgrimage along the Way of Saint James
galicia.0059 = {
	type = character_event
	title = galicia.0059.t
	desc = galicia.0059.desc
	theme = corruption
	override_background = { event_background = RICE_background_camino_de_santiago_road }
	
	right_portrait = root
	
	trigger = {
		RICE_galicia_santiago_pilgrimage_region_but_not_santiago_trigger = yes
		religion = religion:christianity_religion
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = zealous
		}
		modifier = {
			add = -0.2
			has_trait = cynical
		}
		modifier = {
			add = 0.2
			has_trait = gregarious
		}
		modifier = {
			add = -0.2
			has_trait = shy
		}
		modifier = {
			add = 0.2
			has_trait = patient
		}
		modifier = {
			add = -0.2
			has_trait = impatient
		}
	}

	immediate = {
		title:c_santiago = {
			save_scope_as = santiago
		}
		religion:christianity_religion = { save_scope_as = christian }
		random_held_title = {
			limit = {
				tier = tier_county
				NOT = { this = title:c_santiago }
				any_county_province = {
					OR = {
						geographical_region = world_europe_west_iberia
						geographical_region = custom_occitan
					}
				}
			}	
			save_scope_as = county
		}		
	}


	option = { # Ok
		name = galicia.0059.a
		scope:county = {
			add_county_modifier = {
				modifier = RICE_galicia_locals_wary_of_criminal_pilgrims
				years = 10
			}
		}
		stress_impact = {
			cynical = miniscule_stress_impact_gain
			vengeful = miniscule_stress_impact_gain
			paranoid = miniscule_stress_impact_gain
		}
	}

	option = { # Ok
		name = galicia.0059.b
		scope:county = {
			add_county_modifier = {
				modifier = RICE_galicia_closely_monitoring_criminal_pilgrims
				years = 10
			}
		}
		stress_impact = {
			zealous = miniscule_stress_impact_gain
			forgiving = miniscule_stress_impact_gain
			trusting = miniscule_stress_impact_gain
		}
	}

}



# Invite a foreign pilgrim to stay in your court?
galicia.0060 = {
	type = character_event
	title = galicia.0060.t
	desc = galicia.0060.desc
	theme = faith
	override_background = { event_background = throne_room }
	
	right_portrait = {
		character = scope:pilgrim
		animation = throne_room_bow_1
	}
	
	trigger = {
		RICE_galicia_santiago_pilgrimage_region_but_not_santiago_trigger = yes
		religion = religion:christianity_religion
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = generous
		}
		modifier = {
			add = -0.2
			has_trait = greedy
		}
		modifier = {
			add = 0.2
			has_trait = gregarious
		}
		modifier = {
			add = -0.2
			has_trait = shy
		}
		modifier = {
			add = 0.2
			has_trait = compassionate
		}
		modifier = {
			add = -0.2
			has_trait = sadistic
		}
	}

	immediate = {
		title:c_santiago = {
			save_scope_as = santiago
		}
		every_county_in_region = {
			region = world_europe_west
			add_to_list = pilgrimage_counties
		}
		every_county_in_region = {
			region = world_europe_south_italy
			add_to_list = pilgrimage_counties
		}
		random_in_list = {
			list = pilgrimage_counties
			save_scope_as = home_county
		}

		create_character = {
			location = root.location
			template = RICE_galicia_pilgrim_template
			save_scope_as = pilgrim
			culture = scope:home_county.culture
		}

	}


	option = { # Ok
		name = galicia.0060.a
		trigger = {
			OR = {
				is_ai = no
				gold >= 50
			}
		}
		pay_short_term_gold = {
			target = scope:pilgrim
			gold = 50
		}
		add_courtier = scope:pilgrim
		add_piety = 100
		stress_impact = {
			greedy = miniscule_stress_impact_gain
			callous = miniscule_stress_impact_gain
			paranoid = miniscule_stress_impact_gain
		}
	}

	option = { # Ok
		name = galicia.0060.b
		hidden_effect = {
			scope:pilgrim = {
				death = {
					death_reason = death_vanished
				}
			}
		}	
	}

}



# See some pilgrims with scallop shells
galicia.0061 = {
	type = character_event
	title = galicia.0061.t
	desc = galicia.0061.desc
	theme = RICE_theme_camino_de_santiago_church
	
	right_portrait = root
	
	trigger = {
		RICE_galicia_santiago_pilgrimage_region_but_not_santiago_trigger = yes
		religion = religion:christianity_religion
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = zealous
		}
		modifier = {
			add = -0.2
			has_trait = cynical
		}
		modifier = {
			add = 0.2
			has_trait = gregarious
		}
		modifier = {
			add = -0.2
			has_trait = shy
		}
		modifier = {
			add = 0.2
			has_trait = diligent
		}
		modifier = {
			add = -0.2
			has_trait = lazy
		}
	}

	immediate = {
		title:c_santiago = {
			save_scope_as = santiago
		}
		random_held_title = {
			limit = {
				tier = tier_county
				NOT = { this = title:c_santiago }
				any_county_province = {
					OR = {
						geographical_region = world_europe_west_iberia
						geographical_region = custom_occitan
					}
				}
			}	
			save_scope_as = county
		}
	}


	option = { # Ok
		name = galicia.0061.a
		add_piety = 25
		stress_impact = {
			zealous = miniscule_stress_impact_loss
		}
	}

	option = { # Ok
		name = galicia.0061.b
		add_prestige = 25
		stress_impact = {
			diligent = miniscule_stress_impact_loss
		}
	}

}



# Pilgrims are settling down in your territories
galicia.0062 = {
	type = character_event
	title = galicia.0062.t
	desc = galicia.0062.desc
	theme = RICE_theme_camino_de_santiago_road
	
	right_portrait = root
	
	trigger = {
		RICE_galicia_santiago_pilgrimage_region_but_not_santiago_trigger = yes
		religion = religion:christianity_religion
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = zealous
		}
		modifier = {
			add = -0.2
			has_trait = cynical
		}
		modifier = {
			add = 0.2
			has_trait = gregarious
		}
		modifier = {
			add = -0.2
			has_trait = shy
		}
		modifier = {
			add = 0.2
			has_trait = diligent
		}
		modifier = {
			add = -0.2
			has_trait = lazy
		}
	}

	immediate = {
		title:c_santiago = {
			save_scope_as = santiago
		}
		random_held_title = {
			limit = {
				tier = tier_county
				NOT = { this = title:c_santiago }
				any_county_province = {
					OR = {
						geographical_region = world_europe_west_iberia
						geographical_region = custom_occitan
					}
				}
			}	
			save_scope_as = county
		}
	}


	option = { # Ok
		name = galicia.0062.a
		scope:county = {
			add_county_modifier = {
				modifier = RICE_galicia_pilgrim_settlers
				years = 10
			}
		}
	}

}

