
#############################################
#											#
# STRUGGLE ENDING DECISIONS				    #
#											#
#############################################

# Unite the Sangha Ending
RICE_sri_lanka_struggle_ending_unite_sangha_decision = {
	major = yes
	title = RICE_sri_lanka_struggle_ending_unite_sangha_decision
	picture = "gfx/interface/illustrations/decisions/decision_rice_ancient_buddhist_holy_site.dds"
	extra_picture = "gfx/interface/illustrations/struggle_decisions_buttons/decision_rice_ancient_buddhist_holy_site_small.dds"
	desc = RICE_sri_lanka_struggle_ending_unite_sangha_decision_desc
	selection_tooltip = RICE_sri_lanka_struggle_ending_unite_sangha_decision_tooltip
	confirm_click_sound = "event:/DLC/FP2/SFX/UI/fp2_struggle_ending_decision_confirm"
	is_invisible = yes

	sort_order = 80

	is_valid = {
		is_independent_ruler = yes

		exists = struggle:RICE_sri_lanka_struggle

		custom_tooltip = {
			text = struggle_ending_decision_correct_involvement_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_sri_lanka_struggle
			}
		}

		OR = {
			religion = { rice_religion_trigger_buddhism_religion = yes }
			faith = { has_doctrine = doctrine_pluralism_pluralistic }
		}

		OR = {
			AND = {
				custom_tooltip = {
					text = RICE_sri_lanka_struggle_ending_unite_decision_mahavihara_tt
					global_var:RICE_mahavihara_prominence >= 900
				}
				# has_trait_xp = {
				# 	trait = RICE_mahavihara_trait
				# 	value >= 40
				# }
				has_trait = RICE_mahavihara_trait
			}
			AND = {
				custom_tooltip = {
					text = RICE_sri_lanka_struggle_ending_unite_decision_abhayagiri_tt
					global_var:RICE_abhayagiri_prominence >= 900
				}
				# has_trait_xp = {
				# 	trait = RICE_abhayagiri_trait
				# 	value >= 40
				# }
				has_trait = RICE_abhayagiri_trait
			}
			AND = {
				custom_tooltip = {
					text = RICE_sri_lanka_struggle_ending_unite_decision_jetavana_tt
					global_var:RICE_jetavana_prominence >= 900
				}
				# has_trait_xp = {
				# 	trait = RICE_jetavana_trait
				# 	value >= 40
				# }
				has_trait = RICE_jetavana_trait
			}
		}

		OR = {
			AND = {			
				has_title = title:k_lanka
				completely_controls = title:k_lanka
				piety_level >= 2
			}
			AND = {
				# Completely control at least 2 of 3 Sri Lankan duchies
				calc_true_if = {
					amount >= 2
					completely_controls = title:d_dakhina_desa
					completely_controls = title:d_ruhunu
					completely_controls = title:d_sinhala
				}
				piety_level >= 3
			}
			piety_level >= 4
		}

		

	}

	effect = {

		save_scope_as = sri_lanka_struggle_ender

		##### Major Effects #####
		show_as_tooltip = {
			give_nickname = nick_the_great
			if = {
				limit = {
					religion = { rice_religion_trigger_buddhism_religion = yes }
				}
				add_piety = 1000
			}
			else = {
				add_prestige = 1000
			}
			dynasty = {
				add_dynasty_prestige = 1000
				add_dynasty_modifier = {
					modifier = RICE_sri_lanka_sangha_uniter_modifier
				}
			}
		}
		# Pali Canon doctrine
		custom_tooltip = RICE_sri_lanka_struggle_ending_uniter_pali_canon_doctrine_effect_tt
		# Phase doctrine
		custom_tooltip = RICE_sri_lanka_struggle_ending_uniter_phase_doctrine_effect_tt
		# Relic effect
		custom_tooltip = RICE_sri_lanka_struggle_ending_uniter_relic_effect_tt

		# Trigger the ending event
		trigger_event = sri_lanka.0006
	}

	cost = {}

	ai_check_interval = 120

	ai_potential = { always = yes }

	ai_will_do = { base = 100 }
}

# Destroy the Sangha Ending
RICE_sri_lanka_struggle_ending_destroy_sangha_decision = {
	major = yes
	title = RICE_sri_lanka_struggle_ending_destroy_sangha_decision
	picture = "gfx/interface/illustrations/decisions/decision_RICE_burning_building.dds"
	extra_picture = "gfx/interface/illustrations/struggle_decisions_buttons/decision_RICE_burning_building_small.dds"
	desc = RICE_sri_lanka_struggle_ending_destroy_sangha_decision_desc
	selection_tooltip = RICE_sri_lanka_struggle_ending_destroy_sangha_decision_tooltip
	confirm_click_sound = "event:/DLC/FP2/SFX/UI/fp2_struggle_ending_decision_confirm"
	is_invisible = yes

	sort_order = 80

	is_valid = {
		is_independent_ruler = yes

		exists = struggle:RICE_sri_lanka_struggle

		custom_tooltip = {
			text = struggle_ending_decision_correct_involvement_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_sri_lanka_struggle
			}
		}

		NOT = { religion = { rice_religion_trigger_buddhism_religion = yes } }


		custom_tooltip = {
			text = RICE_sri_lanka_struggle_ending_destroy_decision_mahavihara_tt
			global_var:RICE_mahavihara_prominence < 100
		}

		custom_tooltip = {
			text = RICE_sri_lanka_struggle_ending_destroy_decision_abhayagiri_tt
			global_var:RICE_abhayagiri_prominence < 100
		}

		custom_tooltip = {
			text = RICE_sri_lanka_struggle_ending_destroy_decision_jetavana_tt
			global_var:RICE_jetavana_prominence < 100
		}

		NOR = {
			has_trait = RICE_mahavihara_trait
			has_trait = RICE_abhayagiri_trait
			has_trait = RICE_jetavana_trait
		}

		has_title = title:k_lanka
		completely_controls = title:k_lanka

		
		prestige_level >= 3

	}

	effect = {
		save_scope_as = sri_lanka_struggle_ender

		##### Major Effects #####
		show_as_tooltip = {
			RICE_sri_lanka_struggle_ending_destroyer_effect = yes
		}
		# Doctrine
		custom_tooltip = RICE_sri_lanka_struggle_ending_uniter_destroyer_doctrine_effect

		# Trigger the ending event
		trigger_event = sri_lanka.0007
	}

	cost = {}

	ai_check_interval = 120

	ai_potential = { always = yes }

	ai_will_do = { base = 100 }
}

# Revive the Sangha (Foreign) Ending
RICE_sri_lanka_struggle_ending_foreign_sangha_decision = {
	major = yes
	title = RICE_sri_lanka_struggle_ending_foreign_sangha_decision
	picture = "gfx/interface/illustrations/decisions/decision_RICE_borobudur.dds"
	desc = RICE_sri_lanka_struggle_ending_foreign_sangha_decision_desc
	selection_tooltip = RICE_sri_lanka_struggle_ending_foreign_sangha_decision_tooltip

	sort_order = 80

	is_shown = {
		exists = struggle:RICE_sri_lanka_struggle
		NOT = {
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_sri_lanka_struggle
			}
		}
		religion = { rice_religion_trigger_buddhism_religion = yes }
		faith = { has_doctrine = rice_theravada_canon_doctrine }
	}

	is_valid = {
		is_independent_ruler = yes

		exists = struggle:RICE_sri_lanka_struggle

		custom_tooltip = {
			text = RICE_sri_lanka_struggle_not_involved
			NOT = {
				any_character_struggle = {
					involvement = involved
					is_struggle_type = RICE_sri_lanka_struggle
				}
			}
		}

		religion = { rice_religion_trigger_buddhism_religion = yes }
		faith = { has_doctrine = rice_theravada_canon_doctrine }

		OR = {
			AND = {
				custom_tooltip = {
					text = RICE_sri_lanka_struggle_ending_unite_decision_mahavihara_tt
					global_var:RICE_mahavihara_prominence >= 900
				}
				has_trait_xp = {
					trait = RICE_mahavihara_trait
					value >= 40
				}
				#has_trait = RICE_mahavihara_trait
			}
			AND = {
				custom_tooltip = {
					text = RICE_sri_lanka_struggle_ending_unite_decision_abhayagiri_tt
					global_var:RICE_abhayagiri_prominence >= 900
				}
				has_trait_xp = {
					trait = RICE_abhayagiri_trait
					value >= 40
				}
				#has_trait = RICE_abhayagiri_trait
			}
			AND = {
				custom_tooltip = {
					text = RICE_sri_lanka_struggle_ending_unite_decision_jetavana_tt
					global_var:RICE_jetavana_prominence >= 900
				}
				has_trait_xp = {
					trait = RICE_jetavana_trait
					value >= 40
				}
				#has_trait = RICE_jetavana_trait
			}
		}

		NOT = { has_title = title:k_lanka }

		# No territory in Sri Lanka
		custom_tooltip = {
			text = RICE_sri_lanka_not_in_sri_lanka_req
			NOT = {
				any_held_title = {
					tier = tier_county
					any_county_province = {
						geographical_region = RICE_sri_lanka_struggle_region
					}
				}
			}
		}

		# No other independent ruler in Sri Lanka is a king or above
		custom_tooltip = {
			text = RICE_sri_lanka_struggle_no_kings_req
			struggle:RICE_sri_lanka_struggle = {
				NOT = {
					any_involved_ruler = {
						NOT = { this = root }
						primary_title = { is_mercenary_company = no }
						primary_title.tier >= tier_kingdom
					}
				}
				NOT = {
					any_interloper_ruler = {
						NOT = { this = root }
						primary_title = { is_mercenary_company = no }
						primary_title.tier >= tier_kingdom
					}
				}
			}
		}

		prestige_level >= 3
		piety_level >= 4
		

	}

	effect = {
		save_scope_as = sri_lanka_struggle_ender

		##### Major Effects #####
		show_as_tooltip = {
			give_nickname = nick_the_great
			add_piety = 500
			add_prestige = 500
			dynasty = {
				add_dynasty_prestige = 1000
				add_dynasty_modifier = {
					modifier = RICE_sri_lanka_sangha_uniter_modifier
				}
			}
		}
		# Pali Canon doctrine
		custom_tooltip = RICE_sri_lanka_struggle_ending_uniter_pali_canon_doctrine_effect_tt
		# Outsider doctrine
		custom_tooltip = RICE_sri_lanka_struggle_ending_uniter_outsider_doctrine_effect_tt
		# Unlock everything everywhere effect
		custom_tooltip = RICE_sri_lanka_struggle_ending_everywhere_unlock_effect
		# County bonus effect
		custom_tooltip = RICE_sri_lanka_struggle_ending_county_bonus_effect

		# Trigger the ending event
		every_ruler = {
			limit = {
				OR = {
					this = scope:sri_lanka_struggle_ender
					faith = { has_doctrine = rice_theravada_canon_doctrine }	
					any_held_county = {
						any_county_province = {
							OR = {
								geographical_region = world_india
								geographical_region = world_burma
							}
						}
					}
				}
			}
			trigger_event = sri_lanka.0008
		}
	}

	cost = {}

	ai_check_interval = 120

	ai_potential = { always = yes }

	ai_will_do = { base = 100 }
}



#############################################
#											#
# OTHER DECISIONS						    #
#											#
#############################################


RICE_india_irrigation_tank_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_rice_indian_agriculture.dds"
	desc = RICE_india_irrigation_tank_decision_desc

	ai_check_interval = 48

	cooldown = { days = 3650 }

	is_shown = {
		highest_held_title_tier > tier_barony
		is_landed = yes
		OR = {
			capital_province = {
				geographical_region = world_india
			}
			culture = {			
				has_innovation = innovation_RICE_irrigation_tanks
			}

		}	
	}

	is_valid = {
		culture = {			
			has_innovation = innovation_RICE_irrigation_tanks
		}
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	minimum_cost = {
		gold = RICE_irrigation_tank_small_cost
	}

	effect = {
		
		custom_tooltip = RICE_india_irrigation_tank_decision_effect_tooltip_1
		custom_tooltip = RICE_india_irrigation_tank_decision_effect_tooltip_2

		if = {
			limit = {
				culture = { has_cultural_parameter = unlock_rice_wewa_irrigation_tank_effects }
			}
			custom_tooltip = RICE_india_irrigation_tank_decision_effect_tooltip_3
		}

		if = {
			limit = {
				culture = { has_cultural_parameter = unlock_rice_stepwell_irrigation_tank_effects }
			}
			custom_tooltip = RICE_india_irrigation_tank_decision_effect_tooltip_4
		}

		if = {
			limit = {
				is_RICE_loaded = yes
				RICE_sri_lanka_can_access_most_sangha_mechanics_trigger = yes			
			}
			custom_tooltip = RICE_india_irrigation_tank_decision_effect_tooltip_5
		}
	
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_india_irrigation_tank_decision_context_tooltip
		}

		trigger_event = sri_lanka.0015
	}

	ai_will_do = {
		base = 30

		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = greedy
		}
		modifier = {
			add = 10
			has_trait = diligent
		}
		modifier = {
			add = -10
			has_trait = lazy
		}

	}
}



RICE_sri_lanka_choose_monastic_sect = {
	picture = "gfx/interface/illustrations/decisions/decision_rice_ancient_buddhist_holy_site.dds"
	major = yes
	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_global_variable = RICE_sri_lanka_ending_united_sangha
				}
				desc = RICE_sri_lanka_choose_monastic_sect_united
			}
			desc = RICE_sri_lanka_choose_monastic_sect
		}
	}

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_global_variable = RICE_sri_lanka_ending_united_sangha
				}
				desc = RICE_sri_lanka_choose_monastic_sect_united_desc
			}
			desc = RICE_sri_lanka_choose_monastic_sect_desc
		}
	}

	ai_check_interval = 12

	cooldown = { days = 3650 }

	is_shown = {
		NOT = { has_global_variable = RICE_sri_lanka_ending_destroyed_sangha }
		RICE_sri_lanka_struggle_decisions_light_trigger = yes
		NOR = {
			has_trait = RICE_mahavihara_trait
			has_trait = RICE_abhayagiri_trait
			has_trait = RICE_jetavana_trait
		}
	}
	is_valid = {

		RICE_sri_lanka_struggle_decisions_trigger = yes

	}

	is_valid_showing_failures_only = {
		is_adult = yes
		RICE_is_available_adult_even_if_sick_trigger = yes
	}

	cost = {
		gold = {
			value = major_gold_value
		}
	}

	effect = {
		
		if = {
			limit = {
				NOT = { has_global_variable = RICE_sri_lanka_ending_united_sangha }
			}
			custom_tooltip = RICE_sri_lanka_choose_monastic_sect_effect_tooltip_1
			trigger_event = sri_lanka.0020
		}
		else_if = {
			limit = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_mahavihara
			}
			add_trait = RICE_mahavihara_trait
			# create_character_memory = {
			# 	type = RICE_sri_lanka_start_patronizing_mahavihara_memory
			# }
		}	
		else_if = {
			limit = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_abhayagiri
			}
			add_trait = RICE_abhayagiri_trait
			# create_character_memory = {
			# 	type = RICE_sri_lanka_start_patronizing_abhayagiri_memory
			# }
		}	
		else_if = {
			limit = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_jetavana
			}
			add_trait = RICE_jetavana_trait
			# create_character_memory = {
			# 	type = RICE_sri_lanka_start_patronizing_jetavana_memory
			# }
		}	
		custom_tooltip = RICE_sri_lanka_choose_monastic_sect_effect_tooltip_2

		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_choose_monastic_sect_context_tooltip
		}

	}

	ai_will_do = {
		base = 50
		modifier = {
			add = -50
			NOT = { has_global_variable = RICE_sri_lanka_ending_revived_sangha }
			NOT = {
				capital_province = {
					OR = {
						geographical_region = world_india
						geographical_region = world_burma
					}
				}
			}
		}
		modifier = {
			add = -25
			NOT = { has_global_variable = RICE_sri_lanka_ending_revived_sangha }
			NOT = {
				capital_province = {
					geographical_region = RICE_sri_lanka_struggle_region
				}
			}
		}
		modifier = {
			add = -20
			NOT = { religion = { rice_religion_trigger_buddhism_religion = yes } }
		}
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = zealous
			religion = { rice_religion_trigger_buddhism_religion = yes }
		}
		modifier = {
			add = -10
			has_trait = cynical
			religion = { rice_religion_trigger_buddhism_religion = yes }
		}

	}
}

RICE_sri_lanka_change_monastic_sect = {
	picture = "gfx/interface/illustrations/decisions/decision_rice_ancient_buddhist_holy_site.dds"
	#major = yes
	
	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_global_variable = RICE_sri_lanka_ending_united_sangha
				}
				desc = RICE_sri_lanka_change_monastic_sect_united
			}
			desc = RICE_sri_lanka_change_monastic_sect
		}
	}

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_global_variable = RICE_sri_lanka_ending_united_sangha
				}
				desc = RICE_sri_lanka_change_monastic_sect_united_desc
			}
			desc = RICE_sri_lanka_change_monastic_sect_desc
		}
	}

	ai_check_interval = 128

	cooldown = { days = 3650 }

	is_shown = {
		NOT = { has_global_variable = RICE_sri_lanka_ending_destroyed_sangha }
		RICE_sri_lanka_struggle_decisions_light_trigger = yes
		OR = {
			has_trait = RICE_mahavihara_trait
			has_trait = RICE_abhayagiri_trait
			has_trait = RICE_jetavana_trait
		}
		
		OR = {
			NOT = { has_global_variable = RICE_sri_lanka_ending_united_sangha }
			AND = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_mahavihara
				NOT = { has_trait = RICE_mahavihara_trait }
			}
			AND = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_abhayagiri
				NOT = { has_trait = RICE_abhayagiri_trait }
			}
			AND = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_jetavana
				NOT = { has_trait = RICE_jetavana_trait }
			}
		}

	}

	is_valid = {

		OR = {
			has_trait = RICE_mahavihara_trait
			has_trait = RICE_abhayagiri_trait
			has_trait = RICE_jetavana_trait
		}

		RICE_sri_lanka_struggle_decisions_trigger = yes

	}

	is_valid_showing_failures_only = {
		is_adult = yes
		RICE_is_available_adult_even_if_sick_trigger = yes
	}

	cost = {
		gold = {
			value = major_gold_value
		}
	}

	effect = {

		if = {
			limit = {
				NOT = { has_global_variable = RICE_sri_lanka_ending_united_sangha }
			}
			#custom_tooltip = RICE_sri_lanka_choose_monastic_sect_effect_tooltip_1
			if = {
				limit = {
					has_trait = RICE_mahavihara_trait
				}
				show_as_tooltip = {
					remove_trait = RICE_mahavihara_trait
				}
				custom_tooltip = RICE_sri_lanka_change_monastic_sect_effect_tooltip_1
			}
			else_if = {
				limit = {
					has_trait = RICE_abhayagiri_trait
				}
				show_as_tooltip = {
					remove_trait = RICE_abhayagiri_trait
				}
				custom_tooltip = RICE_sri_lanka_change_monastic_sect_effect_tooltip_2
			}
			else_if = {
				limit = {
					has_trait = RICE_jetavana_trait
				}
				show_as_tooltip = {
					remove_trait = RICE_jetavana_trait
				}
				custom_tooltip = RICE_sri_lanka_change_monastic_sect_effect_tooltip_3
			}
			trigger_event = sri_lanka.0021
		}
		else_if = {
			limit = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_mahavihara
			}
			if = {
				limit = {
					has_trait = RICE_abhayagiri_trait
				}
				remove_trait = RICE_abhayagiri_trait
			}
			if = {
				limit = {
					has_trait = RICE_jetavana_trait
				}
				remove_trait = RICE_jetavana_trait
			}
			add_trait = RICE_mahavihara_trait
		}	
		else_if = {
			limit = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_abhayagiri
			}
			if = {
				limit = {
					has_trait = RICE_mahavihara_trait
				}
				remove_trait = RICE_mahavihara_trait
			}
			if = {
				limit = {
					has_trait = RICE_jetavana_trait
				}
				remove_trait = RICE_jetavana_trait
			}
			add_trait = RICE_abhayagiri_trait
		}	
		else_if = {
			limit = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_jetavana
			}
			if = {
				limit = {
					has_trait = RICE_mahavihara_trait
				}
				remove_trait = RICE_mahavihara_trait
			}
			if = {
				limit = {
					has_trait = RICE_abhayagiri_trait
				}
				remove_trait = RICE_abhayagiri_trait
			}
			add_trait = RICE_jetavana_trait
		}	




		custom_tooltip = RICE_sri_lanka_change_monastic_sect_effect_tooltip_4
		custom_tooltip = RICE_sri_lanka_change_monastic_sect_effect_tooltip_5
		

		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_change_monastic_sect_context_tooltip
		}

		
	}

	ai_will_do = {
		base = 5

		modifier = {
			add = 5
			has_trait = fickle
		}
		modifier = {
			add = -5
			has_trait = zealous
		}

	}
}



RICE_india_land_grant_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_indian_temple.dds"
	ai_check_interval = 40
	
	cooldown = { days = 3650 }

	
	desc = RICE_india_land_grant_decision_desc
	selection_tooltip = RICE_india_land_grant_decision_tooltip

	is_shown = {
		highest_held_title_tier > tier_barony
		is_landed = yes
		OR = {
			religion = { rice_religion_trigger_buddhism_religion = yes }
			religion = { rice_religion_trigger_hinduism_religion = yes }
			religion = { rice_religion_trigger_jainism_religion = yes }
		}
	}
	
	is_valid = {
		OR = {
			religion = { rice_religion_trigger_buddhism_religion = yes }
			religion = { rice_religion_trigger_hinduism_religion = yes }
			religion = { rice_religion_trigger_jainism_religion = yes }
		}
		custom_description = {
			text = "RICE_india_land_grant_decision_req"
			any_held_title = {
				tier = tier_county
				any_county_province = {
					geographical_region = world_india
				}
			}
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}


		
    widget = {
    	gui = "decision_view_widget_RICE_india_land_grant_decision"
		controller = decision_option_list_controller
    	
		#decision_has_second_step = yes
		#decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_india_land_grant_type" 

		item = {							
			value = RICE_india_land_grant_buddhism_option
			current_description = RICE_india_land_grant_buddhism_option_desc
			localization = RICE_india_land_grant_buddhism_option
			icon = "gfx/interface/icons/widgets/RICE_buddhism_generic_widget.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {						
			value = RICE_india_land_grant_hinduism_option
			current_description = RICE_india_land_grant_hinduism_option_desc
			localization = RICE_india_land_grant_hinduism_option
			icon = "gfx/interface/icons/widgets/RICE_hinduism_generic_widget.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {						
			value = RICE_india_land_grant_jainism_option
			current_description = RICE_india_land_grant_jainism_option_desc
			localization = RICE_india_land_grant_jainism_option
			icon = "gfx/interface/icons/widgets/RICE_jainism_generic_widget.dds"

			ai_chance = {
				value = 10
			}
		}


	}

	effect = {

		custom_tooltip = RICE_india_land_grant_decision_effect_tooltip_1	
		custom_tooltip = RICE_india_land_grant_decision_effect_tooltip_2
		custom_tooltip = RICE_india_land_grant_decision_effect_tooltip_3
		custom_tooltip = RICE_india_land_grant_decision_effect_tooltip_4
		custom_tooltip = RICE_india_land_grant_decision_effect_tooltip_5
		
						
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_india_land_grant_decision_context_tooltip
		}

		# Not sure why AI can't pick one option or another
		if = {
			limit = { is_ai = yes }
			random_list = {
				10 = {
					trigger = {
						any_held_title = {
							tier = tier_county
							religion = { rice_religion_trigger_buddhism_religion = yes }
						}
					}
					set_variable = {
						name = RICE_india_land_grant_type
						value = flag:buddhism
					}
				}
				10 = {
					trigger = {
						any_held_title = {
							tier = tier_county
							religion = { rice_religion_trigger_hinduism_religion = yes }
						}
					}
					set_variable = {
						name = RICE_india_land_grant_type
						value = flag:hinduism
					}
				}
				10 = {
					trigger = {
						any_held_title = {
							tier = tier_county
							religion = { rice_religion_trigger_jainism_religion = yes }
						}
					}
					set_variable = {
						name = RICE_india_land_grant_type
						value = flag:jainism
					}
				}
			}
		}
		else_if = {
			limit = {
				scope:RICE_india_land_grant_buddhism_option = yes
			}
			set_variable = {
				name = RICE_india_land_grant_type
				value = flag:buddhism
			}
		}
		else_if = {
			limit = {
				scope:RICE_india_land_grant_hinduism_option = yes
			}
			set_variable = {
				name = RICE_india_land_grant_type
				value = flag:hinduism
			}
		}
		else_if = {
			limit = {
				scope:RICE_india_land_grant_jainism_option = yes
			}
			set_variable = {
				name = RICE_india_land_grant_type
				value = flag:jainism
			}
		}

		
		trigger_event = sri_lanka.0010
	}

	cost = { 
		gold = { value = RICE_india_grant_decision_cost } # Will depend
	}	

	ai_potential = {
		short_term_gold > RICE_india_grant_decision_cost
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = generous
		}
		modifier = {
			add = -10
			has_trait = greedy
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = cynical
		}
	}
}





RICE_sri_lanka_support_monastery = {
	picture = "gfx/interface/illustrations/decisions/decision_ck2_roi_large_temple.dds"
	ai_check_interval = 36
	
	cooldown = { days = 1825 }

	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_global_variable = RICE_sri_lanka_ending_revived_sangha
				}
				desc = RICE_sri_lanka_support_monastery_all
			}
			desc = RICE_sri_lanka_support_monastery
		}
	}

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					religion = { rice_religion_trigger_buddhism_religion = yes }
					OR = {
						has_trait = RICE_mahavihara_trait
						has_trait = RICE_abhayagiri_trait
						has_trait = RICE_jetavana_trait
					}
				}
				desc = RICE_sri_lanka_support_monastery_desc
			}
			desc = RICE_sri_lanka_support_monastery_desc_no_monastery
		}
	}

	selection_tooltip = RICE_sri_lanka_support_monastery_tooltip

	is_shown = {
		NOT = { has_global_variable = RICE_sri_lanka_ending_destroyed_sangha }
		highest_held_title_tier > tier_barony
		is_landed = yes
		RICE_sri_lanka_struggle_decisions_light_trigger = yes
	}
	
	is_valid = {

		RICE_sri_lanka_struggle_decisions_trigger = yes
		OR = {
			has_trait = RICE_mahavihara_trait
			has_trait = RICE_abhayagiri_trait
			has_trait = RICE_jetavana_trait
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	widget = {
		gui = "decision_view_widget_RICE_sri_lanka_progressbars_all"
	}
		
    widget = {
    	gui = "decision_view_widget_RICE_sri_lanka_support_monastery"
		controller = decision_option_list_controller
    	
		#decision_has_second_step = yes
		#decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_sri_lanka_support_monastery_type" 

		item = {	
			value = RICE_sri_lanka_support_monastery_almsgiving_option
			current_description = RICE_sri_lanka_support_monastery_almsgiving_option_desc
			localization = RICE_sri_lanka_support_monastery_almsgiving_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_almsgiving.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			value = RICE_sri_lanka_support_monastery_ritual_deposits_option
			current_description = RICE_sri_lanka_support_monastery_ritual_deposits_option_desc
			localization = RICE_sri_lanka_support_monastery_ritual_deposits_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_ritual_deposits.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {
			is_valid = {
				OR = {
					has_global_variable = RICE_sri_lanka_ending_revived_sangha
					capital_province = {
						geographical_region = RICE_sri_lanka_struggle_region
					}
				}				
			}	
			value = RICE_sri_lanka_support_monastery_gavu_pillars_option
			current_description = RICE_sri_lanka_support_monastery_gavu_pillars_option_desc
			localization = RICE_sri_lanka_support_monastery_gavu_pillars_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_gavu_pillars.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {
			value = RICE_sri_lanka_support_monastery_ordination_ceremonies_option
			current_description = RICE_sri_lanka_support_monastery_ordination_ceremonies_option_desc
			localization = RICE_sri_lanka_support_monastery_ordination_ceremonies_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_ordination_ceremonies.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			value = RICE_sri_lanka_support_monastery_pali_literature_option
			current_description = RICE_sri_lanka_support_monastery_pali_literature_option_desc
			localization = RICE_sri_lanka_support_monastery_pali_literature_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_pali_literature.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {			
			is_valid = {
				OR = {
					has_global_variable = RICE_sri_lanka_ending_revived_sangha
					capital_province = {
						geographical_region = RICE_sri_lanka_struggle_region
					}
				}				
			}
			value = RICE_sri_lanka_support_monastery_ambalamas_option
			current_description = RICE_sri_lanka_support_monastery_ambalamas_option_desc
			localization = RICE_sri_lanka_support_monastery_ambalamas_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_ambalamas.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {
			is_valid = {
				OR = {
					has_global_variable = RICE_sri_lanka_ending_revived_sangha
					capital_province = {
						geographical_region = RICE_sri_lanka_struggle_region
					}
				}					
			}	
			value = RICE_sri_lanka_support_monastery_frontier_monks_option
			current_description = RICE_sri_lanka_support_monastery_frontier_monks_option_desc
			localization = RICE_sri_lanka_support_monastery_frontier_monks_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_frontier_monks.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			is_valid = {
				OR = {
					has_global_variable = RICE_sri_lanka_ending_revived_sangha
					capital_province = {
						geographical_region = RICE_sri_lanka_struggle_region
					}
				}					
			}
			value = RICE_sri_lanka_support_monastery_parivena_schools_option
			current_description = RICE_sri_lanka_support_monastery_parivena_schools_option_desc
			localization = RICE_sri_lanka_support_monastery_parivena_schools_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_parivena_schools.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {
			is_valid = {	
				NOT = {					
					capital_province = {
						geographical_region = RICE_sri_lanka_struggle_region
					}	
				}			
			}	
			value = RICE_sri_lanka_support_monastery_senior_guides_option
			current_description = RICE_sri_lanka_support_monastery_senior_guides_option_desc
			localization = RICE_sri_lanka_support_monastery_senior_guides_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_senior_guides.dds"

			ai_chance = {
				value = 10
			}
		}


	}

	effect = {

		custom_tooltip = RICE_sri_lanka_support_monastery_effect_tooltip_1
		
						
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_support_monastery_context_tooltip
		}

		# Not sure why AI can't pick one option or another
		if = {
			limit = { is_ai = yes }
			random_list = {
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:almsgiving
					}
				}
				10 = {
					trigger = {		
						OR = {
							has_global_variable = RICE_sri_lanka_ending_revived_sangha
							capital_province = {
								geographical_region = RICE_sri_lanka_struggle_region
							}
						}	
					}
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:gavu_pillars
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:ritual_deposits
					}
				}
				10 = {
					trigger = {
						gold >= RICE_sri_lanka_support_medium_cost
					}
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:pali_literature
					}
				}
				10 = {
					trigger = {			
						gold >= RICE_sri_lanka_support_medium_cost	
						OR = {
							has_global_variable = RICE_sri_lanka_ending_revived_sangha
							capital_province = {
								geographical_region = RICE_sri_lanka_struggle_region
							}
						}	
					}
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:ambalamas
					}
				}
				10 = {
					trigger = {
						gold >= RICE_sri_lanka_support_medium_cost
					}
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:ordination_ceremonies
					}
				}
				10 = {
					trigger = {		
						gold >= RICE_sri_lanka_support_large_cost	
						OR = {
							has_global_variable = RICE_sri_lanka_ending_revived_sangha
							capital_province = {
								geographical_region = RICE_sri_lanka_struggle_region
							}
						}	
					}
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:frontier_monks
					}
				}
				10 = {
					trigger = {	
						gold >= RICE_sri_lanka_support_large_cost
						OR = {
							has_global_variable = RICE_sri_lanka_ending_revived_sangha
							capital_province = {
								geographical_region = RICE_sri_lanka_struggle_region
							}
						}	
					}
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:parivena_schools
					}
				}
				10 = {
					trigger = {	
						gold >= RICE_sri_lanka_support_large_cost						
						NOT = {					
							capital_province = {
								geographical_region = RICE_sri_lanka_struggle_region
							}	
						}	
					}
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:senior_guides
					}
				}
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_almsgiving_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:almsgiving
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_gavu_pillars_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:gavu_pillars
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_ritual_deposits_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:ritual_deposits
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_pali_literature_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:pali_literature
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_ambalamas_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:ambalamas
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_ordination_ceremonies_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:ordination_ceremonies
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_frontier_monks_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:frontier_monks
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_parivena_schools_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:parivena_schools
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_senior_guides_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:senior_guides
			}
		}

		
		trigger_event = sri_lanka.0030
	}

	minimum_cost = { 
		gold = { value = 50 } # Will depend
	}	

	ai_potential = {
		short_term_gold > 50
	}

	ai_will_do = {
		base = 45
		modifier = {
			add = -45
			NOT = { has_global_variable = RICE_sri_lanka_ending_revived_sangha }
			NOT = {
				capital_province = {
					OR = {
						geographical_region = world_india
						geographical_region = world_burma
					}
				}
			}
		}
		modifier = {
			add = -25
			NOT = { has_global_variable = RICE_sri_lanka_ending_revived_sangha }
			NOT = {
				capital_province = {
					geographical_region = RICE_sri_lanka_struggle_region
				}
			}
		}
		modifier = {
			add = 10
			religion = { rice_religion_trigger_buddhism_religion = yes }
		}
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = generous
		}
		modifier = {
			add = -10
			has_trait = greedy
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = cynical
		}
	}
}


# Persecute/Purify monasteries
RICE_sri_lanka_persecute_monastery = {
	picture = "gfx/interface/illustrations/decisions/decision_ck2_roi_large_temple.dds"

	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					religion = { rice_religion_trigger_buddhism_religion = yes }
					has_global_variable = RICE_sri_lanka_ending_revived_sangha
				}
				desc = RICE_sri_lanka_persecute_monastery_buddhist_all
			}
			triggered_desc = {
				trigger = {
					religion = { rice_religion_trigger_buddhism_religion = yes }
					NOT = { has_global_variable = RICE_sri_lanka_ending_revived_sangha }
				}
				desc = RICE_sri_lanka_persecute_monastery_buddhist
			}
			desc = RICE_sri_lanka_persecute_monastery_non_buddhist
		}
	}

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					religion = { rice_religion_trigger_buddhism_religion = yes }
				}
				desc = RICE_sri_lanka_persecute_monastery_desc_purify
			}
			desc = RICE_sri_lanka_persecute_monastery_desc_persecute
		}
	}

	ai_check_interval = 48
	
	cooldown = { days = 3650 }

	
	selection_tooltip = RICE_sri_lanka_persecute_monastery_tooltip

	is_shown = {
		NOT = { has_global_variable = RICE_sri_lanka_ending_destroyed_sangha }
		highest_held_title_tier > tier_barony
		is_landed = yes
		trigger_if = {
			limit = {
				has_global_variable = RICE_sri_lanka_ending_revived_sangha
			}
			OR = {
				faith = { has_doctrine = rice_theravada_canon_doctrine }
				any_held_county = {
					any_county_province = {
						geographical_region = RICE_sri_lanka_struggle_region
					}
				}

			}	
		}	
		trigger_else = {
			any_held_county = {
				any_county_province = {
					geographical_region = RICE_sri_lanka_struggle_region
				}
			}
		}
	}
	
	is_valid = {
		trigger_if = {
			limit = {
				has_global_variable = RICE_sri_lanka_ending_revived_sangha
			}
			OR = {
				faith = { has_doctrine = rice_theravada_canon_doctrine }
				any_held_county = {
					any_county_province = {
						geographical_region = RICE_sri_lanka_struggle_region
					}
				}
			}			
		}	
		trigger_else = {
			any_held_county = {
				any_county_province = {
					geographical_region = RICE_sri_lanka_struggle_region
				}
			}
		}
		prestige_level >= 2
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	widget = {
		gui = "decision_view_widget_RICE_sri_lanka_progressbars_all"
	}
		
    widget = {
    	gui = "decision_view_widget_RICE_sri_lanka_persecute_monastery"
		controller = decision_option_list_controller
    	
		#decision_has_second_step = yes
		#decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_sri_lanka_persecute_monastery_type" 

		item = {	
			value = RICE_sri_lanka_persecute_monastery_burn_books_option
			current_description = RICE_sri_lanka_persecute_monastery_burn_books_option_desc
			localization = RICE_sri_lanka_persecute_monastery_burn_books_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_burn_books.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			value = RICE_sri_lanka_persecute_monastery_defrock_heretics_option
			current_description = RICE_sri_lanka_persecute_monastery_defrock_heretics_option_desc
			localization = RICE_sri_lanka_persecute_monastery_defrock_heretics_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_defrock_heretics.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			value = RICE_sri_lanka_persecute_monastery_plunder_wealth_option
			current_description = RICE_sri_lanka_persecute_monastery_plunder_wealth_option_desc
			localization = RICE_sri_lanka_persecute_monastery_plunder_wealth_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_plunder_wealth.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			value = RICE_sri_lanka_persecute_monastery_seize_land_option
			current_description = RICE_sri_lanka_persecute_monastery_seize_land_option_desc
			localization = RICE_sri_lanka_persecute_monastery_seize_land_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_seize_land.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {
			is_valid = {
				NOT = { religion = { rice_religion_trigger_buddhism_religion = yes } }
			}	
			value = RICE_sri_lanka_persecute_monastery_ransack_monasteries_option
			current_description = RICE_sri_lanka_persecute_monastery_ransack_monasteries_option_desc
			localization = RICE_sri_lanka_persecute_monastery_ransack_monasteries_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_ransack_monasteries.dds"

			ai_chance = {
				value = 10
			}
		}


	}

	effect = {

		custom_tooltip = RICE_sri_lanka_persecute_monastery_effect_tooltip_1	
		custom_tooltip = RICE_sri_lanka_persecute_monastery_effect_tooltip_2
		
						
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_persecute_monastery_context_tooltip
		}

		# Not sure why AI can't pick one option or another
		if = {
			limit = { is_ai = yes }
			random_list = {
				10 = {
					set_variable = {
						name = RICE_sri_lanka_persecute_monastery_type
						value = flag:burn_books
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_persecute_monastery_type
						value = flag:defrock_heretics
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_persecute_monastery_type
						value = flag:plunder_wealth
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_persecute_monastery_type
						value = flag:seize_land
					}
				}
				10 = {
					trigger = {
						NOT = { religion = { rice_religion_trigger_buddhism_religion = yes } }
					}
					set_variable = {
						name = RICE_sri_lanka_persecute_monastery_type
						value = flag:ransack_monastery
					}
				}
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_persecute_monastery_burn_books_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_persecute_monastery_type
				value = flag:burn_books
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_persecute_monastery_defrock_heretics_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_persecute_monastery_type
				value = flag:defrock_heretics
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_persecute_monastery_plunder_wealth_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_persecute_monastery_type
				value = flag:plunder_wealth
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_persecute_monastery_seize_land_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_persecute_monastery_type
				value = flag:seize_land
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_persecute_monastery_ransack_monasteries_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_persecute_monastery_type
				value = flag:ransack_monastery
			}
		}

		
		trigger_event = sri_lanka.0031
	}

	minimum_cost = { 
		prestige = { value = major_prestige_value } # Will depend
	}	

	ai_potential = {
		prestige > major_prestige_value
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = -10
			religion = { rice_religion_trigger_buddhism_religion = yes }
			NAND = {
				exists = struggle:RICE_sri_lanka_struggle
				struggle:RICE_sri_lanka_struggle = {
					is_struggle_phase = struggle_RICE_sri_lanka_phase_purification
				}
			}
		}
		modifier = {
			add = 10
			religion = { rice_religion_trigger_buddhism_religion = yes }
			exists = struggle:RICE_sri_lanka_struggle
			struggle:RICE_sri_lanka_struggle = {
				is_struggle_phase = struggle_RICE_sri_lanka_phase_purification
			}
		}
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = generous
		}
		modifier = {
			add = -10
			has_trait = greedy
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = cynical
		}
	}
}



# Do later - forgot it existed lol
# RICE_sri_lanka_enshrine_relic = {
# 	picture = "gfx/interface/illustrations/decisions/decision_rice_elephant_procession.dds"
# 	major = yes
# 	desc = RICE_sri_lanka_enshrine_relic_desc

# 	ai_check_interval = 48

# 	cooldown = { days = 10950 }

# 	is_shown = {
# 		has_global_variable = RICE_sri_lanka_ending_united_sangha
# 		OR = {
# 			# Wouldn't make sense for the Bodhi tree
# 			# has_global_variable = RICE_sri_lanka_ending_united_sangha_bodhi
# 			has_global_variable = RICE_sri_lanka_ending_united_sangha_tooth
# 			has_global_variable = RICE_sri_lanka_ending_united_sangha_dharmadhatu
# 		}
# 		#NOT = {
# 		#	exists = struggle:RICE_sri_lanka_struggle
# 		#}
# 		any_held_county = {
# 			any_county_province = {
# 				geographical_region = RICE_sri_lanka_struggle_region
# 			}
# 		}
# 	}
# 	is_valid = {


# 		trigger_if = {
# 			limit = {
# 				has_global_variable = RICE_sri_lanka_ending_united_sangha_tooth
# 			}
# 			any_held_county = {
# 				any_county_province = {
# 					geographical_region = RICE_sri_lanka_struggle_region
# 				}
# 				has_county_modifier = RICE_sri_lanka_relic_tooth_shrine_modifier
# 			}
# 		}
# 		trigger_else_if = {
# 			limit = {
# 				has_global_variable = RICE_sri_lanka_ending_united_sangha_dharmadhatu
# 			}
# 			any_held_county = {
# 				any_county_province = {
# 					geographical_region = RICE_sri_lanka_struggle_region
# 				}
# 				has_county_modifier = RICE_sri_lanka_relic_dharmadhatu_shrine_modifier
# 			}
# 		}
# 		# trigger_else_if = {
# 		# 	limit = {
# 		# 		has_global_variable = RICE_sri_lanka_ending_united_sangha_bodhi
# 		# 	}
# 		# 	any_held_county = {
# 		# 		any_county_province = {
# 		# 			geographical_region = RICE_sri_lanka_struggle_region
# 		# 		}
# 		# 		has_county_modifier = RICE_sri_lanka_relic_bodhi_shrine_modifier
# 		# 	}
# 		# }

# 		religion = { rice_religion_trigger_buddhism_religion = yes }


# 	}

# 	is_valid_showing_failures_only = {
# 		is_adult = yes
# 		RICE_is_available_adult_even_if_sick_trigger = yes
# 	}


#     widget = {
#     	gui = "decision_view_widget_RICE_sri_lanka_enshrine_relic"
# 		controller = decision_option_list_controller
    	
# 		#decision_has_second_step = yes
# 		#decision_custom_widget_container = "custom_widgets_container_step_two"
# 		decision_to_second_step_button = "RICE_sri_lanka_enshrine_relic_type" 

# 		# c_dakhina_desa
# 		item = {
# 			value = RICE_sri_lanka_relic_dakhina_desa_option
# 			is_shown = {
# 				has_title = title:c_dakhina_desa
# 			}
# 			current_description = RICE_sri_lanka_relic_dakhina_desa_option_desc
# 			localization = RICE_sri_lanka_relic_dakhina_desa_option
# 			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

# 			ai_chance = {
# 				value = 1
# 			}
# 		}

# 		# c_kandy
# 		item = {
# 			value = RICE_sri_lanka_relic_kandy_option
# 			is_shown = {
# 				has_title = title:c_kandy
# 			}
# 			current_description = RICE_sri_lanka_relic_kandy_option_desc
# 			localization = RICE_sri_lanka_relic_kandy_option
# 			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

# 			ai_chance = {
# 				value = 1
# 			}
# 		}

# 		# c_rohana
# 		item = {
# 			value = RICE_sri_lanka_relic_rohana_option
# 			is_shown = {
# 				has_title = title:c_rohana
# 			}
# 			current_description = RICE_sri_lanka_relic_rohana_option_desc
# 			localization = RICE_sri_lanka_relic_rohana_option
# 			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

# 			ai_chance = {
# 				value = 1
# 			}
# 		}

# 		# c_batticaloa
# 		item = {
# 			value = RICE_sri_lanka_relic_batticaloa_option
# 			is_shown = {
# 				has_title = title:c_batticaloa
# 			}
# 			current_description = RICE_sri_lanka_relic_batticaloa_option_desc
# 			localization = RICE_sri_lanka_relic_batticaloa_option
# 			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

# 			ai_chance = {
# 				value = 1
# 			}
# 		}

# 		# c_phiti
# 		item = {
# 			value = RICE_sri_lanka_relic_phiti_option
# 			is_shown = {
# 				has_title = title:c_phiti
# 			}
# 			current_description = RICE_sri_lanka_relic_phiti_option_desc
# 			localization = RICE_sri_lanka_relic_phiti_option
# 			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

# 			ai_chance = {
# 				value = 1
# 			}
# 		}

# 		# c_trincomalee
# 		item = {
# 			value = RICE_sri_lanka_relic_trincomalee_option
# 			is_shown = {
# 				has_title = title:c_trincomalee
# 			}
# 			current_description = RICE_sri_lanka_relic_trincomalee_option_desc
# 			localization = RICE_sri_lanka_relic_trincomalee_option
# 			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

# 			ai_chance = {
# 				value = 1
# 			}
# 		}

# 		# c_jaffna
# 		item = {
# 			value = RICE_sri_lanka_relic_jaffna_option
# 			is_shown = {
# 				has_title = title:c_jaffna
# 			}
# 			current_description = RICE_sri_lanka_relic_jaffna_option_desc
# 			localization = RICE_sri_lanka_relic_jaffna_option
# 			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

# 			ai_chance = {
# 				value = 1
# 			}
# 		}

# 		# c_kotte
# 		item = {
# 			value = RICE_sri_lanka_relic_kotte_option
# 			is_shown = {
# 				has_title = title:c_kotte
# 			}
# 			current_description = RICE_sri_lanka_relic_kotte_option_desc
# 			localization = RICE_sri_lanka_relic_kotte_option
# 			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

# 			ai_chance = {
# 				value = 1
# 			}
# 		}
# 	}

# 	cost = {
# 		gold = {
# 			value = major_gold_value
# 		}
# 	}

# 	effect = {
		
# 		custom_tooltip = RICE_sri_lanka_enshrine_relic_effect_tooltip_1
# 		custom_tooltip = RICE_sri_lanka_enshrine_relic_effect_tooltip_2

		
# 		if = {
# 			limit = {
# 				has_game_rule = RICE_historical_context_on
# 			}
# 			custom_tooltip = RICE_sri_lanka_enshrine_relic_context_tooltip
# 		}

# 		trigger_event = sri_lanka.8888
# 	}

# 	ai_will_do = {
# 		base = 15

# 		modifier = {
# 			add = 10
# 			has_trait = ambitious
# 		}
# 		modifier = {
# 			add = -10
# 			has_trait = lazy
# 		}
# 		modifier = {
# 			add = 10
# 			has_trait = zealous
# 		}
# 		modifier = {
# 			add = -10
# 			has_trait = cynical
# 		}

# 	}
# }


RICE_sri_lanka_polonnaruwa_capital = {
	picture = "gfx/interface/illustrations/decisions/decision_ck2_roi_throneroom.dds"
	desc = RICE_sri_lanka_polonnaruwa_capital_desc
	major = yes

	ai_check_interval = 24

	is_shown = {
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:RICE_sri_lanka_polonnaruwa_capital_moved
			}
		}
		game_start_date >= 990.1.1
		any_held_title = {
			tier = tier_county
			any_county_province = {
				geographical_region = RICE_sri_lanka_struggle_region
			}
		}
	}

	is_valid = {		
		has_title = title:c_trincomalee
		completely_controls = title:k_lanka
		highest_held_title_tier >= tier_kingdom
		custom_description = {
			text = "RICE_sri_lanka_capital_req"
			root.capital_county = {
				title_province = { geographical_region = RICE_sri_lanka_struggle_region }
			}
		}
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	cost = {
		gold = {
			value = medium_gold_value
		}
	}

	effect = {
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:RICE_sri_lanka_polonnaruwa_capital_moved
		}
		custom_tooltip = RICE_sri_lanka_polonnaruwa_capital_effect_tooltip_1

		if = {
			limit = {
				OR = {
					character:189029 = {
						root = this
					}
					root.dynasty = {
						this = dynasty:1029172
					}
				}
			}
			custom_tooltip = RICE_sri_lanka_polonnaruwa_capital_effect_tooltip_2
		}

		show_as_tooltip = {
			RICE_sri_lanka_polonnaruwa_capital_effect = yes
		}

		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_polonnaruwa_capital_context_tooltip
		}

		trigger_event = sri_lanka.0016


	}

	ai_will_do = {
		base = 30

		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = greedy
		}
		modifier = {
			add = 10
			has_trait = diligent
		}
		modifier = {
			add = -10
			has_trait = lazy
		}

	}
}


RICE_sri_lanka_vijayabahu_reward_budal = {
	picture = "gfx/interface/illustrations/decisions/decision_ck2_roi_throneroom.dds"
	desc = RICE_sri_lanka_vijayabahu_reward_budal_desc
	major = yes

	ai_check_interval = 48

	is_shown = {
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:RICE_sri_lanka_vijayabahu_has_rewarded_budal
			}
		}
		OR = {
			has_character_flag = RICE_is_vijayabahu
			AND = {
				exists = dynasty
				NOT = {
					dynasty = {
						any_dynasty_member = {
							has_character_flag = RICE_is_vijayabahu
						}
					}
				}
				# Can't scope to historical characters or it'll cause errors in the error log if it's at a start date where this character doesn't exist
				# character:189029 = {
				# 	is_alive = no
				# 	# NOT = {
				# 	# 	has_title = title:k_lanka
				# 	# }
				# }
				root.dynasty = {
					this = dynasty:1029172
				}
			}
			# any_ancestor = {
			# 	house = root.house
			# }
		}
	}

	is_valid = {
		OR = {
			# Is Vijayabahu
			custom_description = {
				text = "RICE_sri_lanka_is_vijayabahu_req"
				has_character_flag = RICE_is_vijayabahu
			}
			# Is not Vijayabahu, but someone else of his dynasty
			AND = {
				custom_description = {
					text = "RICE_sri_lanka_is_vijayabahu_dead_req"
					exists = dynasty
					NOT = {
						dynasty = {
							any_dynasty_member = {
								has_character_flag = RICE_is_vijayabahu
							}
						}
					}
					# Can't scope to historical characters or it'll cause errors in the error log if it's at a start date where this character doesn't exist
					# character:189029 = {
					# 	is_alive = no
					# 	# NOT = {
					# 	# 	has_title = title:k_lanka
					# 	# }
					# }
				}
				custom_description = {
					text = "RICE_sri_lanka_is_vijayabahu_dynasty_req"
					root.dynasty = {
						this = dynasty:1029172
					}
				}
			}
		}
		completely_controls = title:k_lanka
		highest_held_title_tier >= tier_kingdom
		custom_description = {
			text = "RICE_sri_lanka_is_budal_dead_req"
			character:RICE_sri_lanka_002 = {
				is_alive = yes
			}
		}
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	cost = {
		gold = {
			value = medium_gold_value
		}
		prestige = {
			value = medium_prestige_value
		}
	}

	effect = {
		save_scope_as = vijayabahu_equivalent # In case it's someone different than Vijayabahu
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:RICE_sri_lanka_vijayabahu_has_rewarded_budal
		}
		custom_tooltip = RICE_sri_lanka_vijayabahu_reward_budal_effect_tooltip_1
		custom_tooltip = RICE_sri_lanka_vijayabahu_reward_budal_effect_tooltip_2

		show_as_tooltip = {
			RICE_sri_lanka_vijayabahu_reward_budal_effect = yes
		}

		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_vijayabahu_reward_budal_context_tooltip
		}

		trigger_event = sri_lanka.0014


	}

	ai_will_do = {
		base = 30

		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = greedy
		}
		modifier = {
			add = 10
			has_trait = diligent
		}
		modifier = {
			add = -10
			has_trait = lazy
		}

	}
}




RICE_sri_lanka_worship_local_deities = {
	picture = "gfx/interface/illustrations/decisions/decision_indian_temple.dds"
	ai_check_interval = 40
	
	cooldown = { days = 3650 }

	
	desc = RICE_sri_lanka_worship_local_deities_desc
	selection_tooltip = RICE_sri_lanka_worship_local_deities_tooltip

	is_shown = {
		highest_held_title_tier > tier_barony
		is_landed = yes
		root.capital_county = {
			title_province = { geographical_region = RICE_sri_lanka_struggle_region }
		}
		NOT = { faith.religion = { is_in_family = rf_abrahamic } }
	}
	
	is_valid = {
		custom_description = {
			text = "RICE_sri_lanka_capital_req"
			root.capital_county = {
				title_province = { geographical_region = RICE_sri_lanka_struggle_region }
			}
		}
		NOT = { faith.religion = { is_in_family = rf_abrahamic } }
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}


		
    widget = {
    	gui = "decision_view_widget_RICE_sri_lanka_worship_local_deities"
		controller = decision_option_list_controller
    	
		#decision_has_second_step = yes
		#decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_sri_lanka_worship_local_deities_type" 

		item = {		
			value = RICE_sri_lanka_worship_local_deities_upulvan_option
			current_description = RICE_sri_lanka_worship_local_deities_upulvan_option_desc
			localization = RICE_sri_lanka_worship_local_deities_upulvan_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_upulvan.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {		
			value = RICE_sri_lanka_worship_local_deities_kataragama_option
			current_description = RICE_sri_lanka_worship_local_deities_kataragama_option_desc
			localization = RICE_sri_lanka_worship_local_deities_kataragama_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_kataragama.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {		
			value = RICE_sri_lanka_worship_local_deities_saman_option
			current_description = RICE_sri_lanka_worship_local_deities_saman_option_desc
			localization = RICE_sri_lanka_worship_local_deities_saman_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_saman.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {		
			value = RICE_sri_lanka_worship_local_deities_pattini_option
			current_description = RICE_sri_lanka_worship_local_deities_pattini_option_desc
			localization = RICE_sri_lanka_worship_local_deities_pattini_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_pattini.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {		
			value = RICE_sri_lanka_worship_local_deities_natha_option
			current_description = RICE_sri_lanka_worship_local_deities_natha_option_desc
			localization = RICE_sri_lanka_worship_local_deities_natha_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_natha.dds"

			ai_chance = {
				value = 10
			}
		}


	}

	effect = {

		custom_tooltip = RICE_sri_lanka_worship_local_deities_effect_tooltip_1	
		custom_tooltip = RICE_sri_lanka_worship_local_deities_effect_tooltip_2	
		
		show_as_tooltip = {
			RICE_sri_lanka_local_deities_misc_effect = yes
		}
						
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_worship_local_deities_context_tooltip
		}

		# Not sure why AI can't pick one option or another
		if = {
			limit = { is_ai = yes }
			random_list = {
				10 = {
					set_variable = {
						name = RICE_sri_lanka_deity_type
						value = flag:upulvan
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_deity_type
						value = flag:kataragama
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_deity_type
						value = flag:saman
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_deity_type
						value = flag:pattini
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_deity_type
						value = flag:natha
					}
				}
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_worship_local_deities_upulvan_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_deity_type
				value = flag:upulvan
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_worship_local_deities_kataragama_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_deity_type
				value = flag:kataragama
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_worship_local_deities_saman_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_deity_type
				value = flag:saman
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_worship_local_deities_pattini_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_deity_type
				value = flag:pattini
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_worship_local_deities_natha_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_deity_type
				value = flag:natha
			}
		}

		
		trigger_event = sri_lanka.0040
	}

	cost = { 
		gold = { value = RICE_activity_cost } # Will depend
	}	

	ai_potential = {
		short_term_gold > RICE_activity_cost
	}

	ai_will_do = {
		base = 40
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = cynical
		}
	}
}



# Immersively make your culture and/or faith involved in Sri Lanka's Sangha as a Buddhist
RICE_sri_lanka_make_culture_or_faith_involved_in_sri_lanka = {
	picture = "gfx/interface/illustrations/decisions/decision_rice_buddhist_monk.dds"

	desc = RICE_sri_lanka_make_culture_or_faith_involved_in_sri_lanka_desc
	selection_tooltip = RICE_sri_lanka_make_culture_or_faith_involved_in_sri_lanka_tooltip
	major = yes

	ai_check_interval = 24

	is_shown = {
		exists = dynasty
		is_landed = yes
		any_held_title = {
			tier = tier_county
			any_county_province = {
				geographical_region = RICE_sri_lanka_struggle_region
			}			
		}
		exists = struggle:RICE_sri_lanka_struggle
		OR = {
			NOT = { struggle:RICE_sri_lanka_struggle = { is_culture_involved_in_struggle = root.culture } }
			NOT = { struggle:RICE_sri_lanka_struggle = { is_faith_involved_in_struggle = root.faith } }
		}
	}
	
	is_valid = {

		religion = { rice_religion_trigger_buddhism_religion = yes }

		custom_description = {
			text = "RICE_sri_lanka_capital_req"
			root.capital_county = {
				title_province = { geographical_region = RICE_sri_lanka_struggle_region }
			}
		}

		piety_level >= 2
		prestige_level >= 2

		OR = {

			has_trait_xp = {
				trait = RICE_mahavihara_trait
				value >= 40
			}

			has_trait_xp = {
				trait = RICE_abhayagiri_trait
				value >= 40
			}

			has_trait_xp = {
				trait = RICE_jetavana_trait
				value >= 40
			}

		}

	}

	is_valid_showing_failures_only = {
		RICE_is_available_adult_even_if_sick_trigger = yes
	}

	effect = {

		show_as_tooltip = {
			RICE_sri_lanka_new_culture_or_faith_involvement_effect = yes
			if = {
				limit = {
					has_trait = RICE_mahavihara_trait
				}
				custom_tooltip = RICE_sri_lanka_mahavihara_prominence_increase_massive_short_tooltip
			}
			else_if = {
				limit = {
					has_trait = RICE_abhayagiri_trait
				}
				custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_increase_massive_short_tooltip
			}
			else_if = {
				limit = {
					has_trait = RICE_jetavana_trait
				}
				custom_tooltip = RICE_sri_lanka_jetavana_prominence_increase_massive_short_tooltip
			}			
		}

		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_make_culture_or_faith_involved_in_sri_lanka_context_tooltip
		}

		trigger_event = sri_lanka.0019


	}

	cost = { 
		gold = { value = medium_gold_value }
	}	

	ai_potential = {
		short_term_gold > medium_gold_value
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = -5
			has_trait = lazy
		}
		modifier = {
			add = 5
			has_trait = diligent
		}
		modifier = {
			add = 5
			has_trait = ambitious
		}
		modifier = {
			add = -5
			has_trait = content
		}
		modifier = {
			add = 5
			has_trait = zealous
		}
		modifier = {
			add = -5
			has_trait = cynical
		}
	}
}
