
# Influence the Future of the Uyghur Manichean Church
RICE_mayo_school_of_mayo_decision = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_christian_monastery_monks.dds" }
	decision_group_type = major
	ai_check_interval_by_tier = {
		barony = 0
		county = 0
		duchy = 64
		kingdom = 48
		empire = 36
		hegemony = 36
	}

	#cooldown = { days = 10 } #1825
	
	desc = RICE_mayo_school_of_mayo_decision_desc
	
	is_shown = {
		NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
		is_playable_character = yes
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:RICE_mayo_school_of_mayo_decision_done
			}
		}
		any_held_county = {
			any_county_province = {
				geographical_region = ghw_region_celtic
			}
		}
		religion = religion:christianity_religion
	}
	
	is_valid = {
		is_landed = yes
		religion = religion:christianity_religion
		piety_level >= 3
		has_title = title:c_mayo

		# custom_description = {
		# 	text = RICE_custom_ireland_capital_req
		# 	capital_county = {
		# 		any_county_province = {
		# 			geographical_region = custom_ireland
		# 		}
		# 	}
		# }

		title:c_mayo = {
			religion = religion:christianity_religion
		}

	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}


	widget = {
		gui = "decision_view_widget_RICE_mayo_school_of_mayo_decision"
		controller = decision_option_list_controller
		decision_to_second_step_button = "RICE_mayo_school_of_mayo_decision_PICK_TYPE"
		show_from_start = yes
		
		### Embrace Irish Learning
		item = {
			value = RICE_mayo_school_of_mayo_decision_irish
			current_description = RICE_mayo_school_of_mayo_decision_irish_desc
			localization = RICE_mayo_school_of_mayo_decision_irish_name
			icon = "gfx/interface/icons/court_position_types/master_bard_camp_officer.dds"
			ai_chance = {
				value = 10
			}
		}
		
		### Revitalize English Connections
		item = {
			value = RICE_mayo_school_of_mayo_decision_english
			current_description = RICE_mayo_school_of_mayo_decision_english_desc
			localization = RICE_mayo_school_of_mayo_decision_english_name
			icon = "gfx/interface/icons/widgets/RICE_north_atlantic_clergy.dds"
			ai_chance = {
				value = 30
			}
		}
		
		### Destroy the School
		item = {
			value = RICE_mayo_school_of_mayo_decision_destroy
			current_description = RICE_mayo_school_of_mayo_decision_destroy_desc
			localization = RICE_mayo_school_of_mayo_decision_destroy_name
			icon = "gfx/interface/icons/message_feed/dread.dds"
			ai_chance = {
				value = 60
			}
		}

	}

	effect = {
		capital_county = {
			faith = {
				save_scope_as = capital_faith
			}
		}
		#Can only happen once
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:RICE_mayo_school_of_mayo_decision_done
		}
		save_scope_as = uyghur_leader

		# AI will tend towards destroying the Church, but not necessarily
		if = {
			limit = {
				is_ai = yes
			}

			random_list = {
				# irish
				10 = {
					trigger_event = mayo.0010
				}
				# english
				10 = {
					trigger_event = mayo.0011
				}
				# destroy
				10 = {
					trigger_event = mayo.0012
				}
			}
		}

		else_if = {
			limit = { scope:RICE_mayo_school_of_mayo_decision_irish = yes }
			show_as_tooltip = {
				RICE_mayo_school_of_mayo_decision_irish_effect = yes
			}
			trigger_event = mayo.0010
		}

		else_if = {
			limit = { scope:RICE_mayo_school_of_mayo_decision_english = yes }
			show_as_tooltip = {
				RICE_mayo_school_of_mayo_decision_english_effect = yes
			}
			trigger_event = mayo.0011
		}

		else_if = {
			limit = { scope:RICE_mayo_school_of_mayo_decision_destroy = yes }
			show_as_tooltip = {
				RICE_mayo_school_of_mayo_decision_destroy_effect = yes
			}
			trigger_event = mayo.0012
		}

		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_mayo_school_of_mayo_decision_context_tooltip
		}
	}

	cost = { 
		gold = { value = medium_gold_value } # Will depend 
		piety = major_piety_gain
	}	

	ai_potential = {
		short_term_gold > medium_gold_value
	}

	ai_will_do = {
		base = 25

		modifier = {
			add = 15
			# Happened around the 10th century
			current_date >= 875.1.1
		}

		modifier = {
			add = 15
			# Happened around the 10th century
			current_date >= 925.1.1
		}

		modifier = {
			add = 15
			# Happened around the 10th century
			current_date >= 975.1.1
		}

		modifier = {
			add = 15
			# Happened around the 10th century
			current_date >= 1025.1.1
		}

	}
}


RICE_embrace_gaelicization = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_RICE_stone_church.dds" }

	decision_group_type = major

	ai_check_interval_by_tier = {
		barony = 0
		county = 48
		duchy = 48
		kingdom = 0
		empire = 0
		hegemony = 0
	}

	desc = RICE_embrace_gaelicization_desc

	
	is_shown = {
		any_held_title = {
			tier = tier_county
			culture = { has_cultural_tradition = tradition_RICE_brehon_law }
		}
		NOT = { culture = { has_cultural_pillar = heritage_goidelic } }
		NOT = { has_character_flag = RICE_embraced_gaelicization } # To avoid players trying to cheese it
	}
	
	is_valid = {
		any_held_title = {
			tier = tier_county
			culture = { has_cultural_tradition = tradition_RICE_brehon_law }
		}
		NOT = { culture = { has_cultural_pillar = heritage_goidelic } }
	}
	
	is_valid_showing_failures_only = {
		RICE_is_available_adult_even_if_sick_trigger = yes
	}


	effect = {

		culture = {
			save_scope_as = old_culture
		}

		capital_county.culture = {
			save_scope_as = gaelic_culture
		}

		custom_tooltip = RICE_embrace_gaelicization_effect_tooltip_1

		show_as_tooltip = {
			RICE_embrace_gaelicization_effect = yes
		}
		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_embrace_gaelicization_context_tooltip
		}
		
		trigger_event = {
			id = mayo.0023
		}
	}

	cost = {
		gold = { value = RICE_activity_cost } 
		#prestige = { value = medium_prestige_value }
	}

	ai_potential = {
		short_term_gold > RICE_activity_cost
	}

	ai_will_do = {
		base = 10
		modifier = {
			add = -30
			highest_held_title_tier > tier_duchy # Don't want kings becoming Chinese willy nilly
		}
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = content
		}
		# Make it very likely to happen in Dunhuang region
		modifier = {
			add = 80
			any_directly_owned_province = {
				geographical_region = RICE_dunhuang_region
			}
		}
		modifier = {
			add = 100
			liege = {
				has_title = title:k_hexi
				current_date < 910.1.1
			}
		}
	}
}


# Consecrate a Holy Well
# By Cybrxkhan
RICE_consecrate_holy_well = {
	picture = {
		trigger = {
			culture = { has_graphical_mediterranean_culture_group_trigger = yes }
		}
		reference = "gfx/interface/illustrations/event_scenes/decision_erect_homer_monument.dds"
	}
	picture = {
		trigger = {
			culture = { has_graphical_mena_culture_group_trigger = yes }
		}
		reference = "gfx/interface/illustrations/event_scenes/decision_visit_western_oasis_springs.dds"
	}
	picture = {
		trigger = {
			culture = { has_graphical_east_asia_culture_group_trigger = yes }
		}
		reference = "gfx/interface/illustrations/event_scenes/decision_RICE_east_asian_garden.dds"
	}
	picture = {
		trigger = {
			culture = { has_graphical_india_culture_group_trigger = yes }
		}
		reference = "gfx/interface/illustrations/decisions/decision_rice_tropical_hot_springs.dds"
	}
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_RICE_forest_river.dds"
	}
	decision_group_type = RICE_religious

	ai_check_interval_by_tier = {
		barony = 0
		county = 64
		duchy = 64
		kingdom = 64
		empire = 64
		hegemony = 64
	}

	cooldown = { days = 7300 } #1825
	
	desc = RICE_consecrate_holy_well_desc
	
	is_shown = {
		# Do not enable it if TFE is running, as the TFE version will take precedence
		NOT = { exists = culture:soissons }
		is_playable_character = yes
		# NOT = {
		# 	any_directly_owned_province = {
		# 		county = {
		# 			OR = {
		# 				has_county_modifier = TFE_holy_well_level_1
		# 				has_county_modifier = TFE_holy_well_level_2
		# 				has_county_modifier = TFE_holy_well_level_3
		# 			}
		# 		}
		# 	}
		# }
		# TFE has its own version
		RICE_is_holy_well_culture = yes
	}
	
	is_valid = {
		is_landed = yes
		# TFE has its own version
		RICE_is_holy_well_culture = yes
		custom_description = {
			text = TFE_no_holy_well_county
			NOT = {
				any_directly_owned_province = {
					county = {
						OR = {
							has_county_modifier = TFE_holy_well_level_1
							has_county_modifier = TFE_holy_well_level_2
							has_county_modifier = TFE_holy_well_level_3
						}
					}
				}
			}	
		}
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	cost = {
		gold = RICE_activity_cost
		prestige = medium_prestige_value
	}

	effect = {

		#custom_tooltip = RICE_consecrate_holy_well_effect_tooltip_1
		custom_tooltip = RICE_consecrate_holy_well_effect_tooltip_2
		custom_tooltip = RICE_consecrate_holy_well_effect_tooltip_3

		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_consecrate_holy_well_context_tooltip
		}

		trigger_event = {
			id = mayo.0020
		}
	}

	ai_potential = {
		short_term_gold >= RICE_activity_cost
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = cynical
		}
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
	}
}

# # Visit a Holy Well
# # By Cybrxkhan
# RICE_visit_holy_well = {
# 	picture = {
# 		trigger = {
# 			culture = { has_graphical_mediterranean_culture_group_trigger = yes }
# 		}
# 		reference = "gfx/interface/illustrations/event_scenes/decision_erect_homer_monument.dds"
# 	}
# 	picture = {
# 		trigger = {
# 			culture = { has_graphical_mena_culture_group_trigger = yes }
# 		}
# 		reference = "gfx/interface/illustrations/event_scenes/decision_visit_western_oasis_springs.dds"
# 	}
# 	picture = {
# 		trigger = {
# 			culture = { has_graphical_east_asia_culture_group_trigger = yes }
# 		}
# 		reference = "gfx/interface/illustrations/event_scenes/decision_RICE_east_asian_garden.dds"
# 	}
# 	picture = {
# 		trigger = {
# 			culture = { has_graphical_india_culture_group_trigger = yes }
# 		}
# 		reference = "gfx/interface/illustrations/decisions/decision_rice_tropical_hot_springs.dds"
# 	}
# 	picture = {
# 		reference = "gfx/interface/illustrations/decisions/decision_RICE_forest_river.dds"
# 	}
# 	decision_group_type = RICE_religious

# 	ai_check_interval_by_tier = {
# 		barony = 0
# 		county = 64
# 		duchy = 64
# 		kingdom = 64
# 		empire = 64
# 		hegemony = 64
# 	}

# 	cooldown = { days = 3650 } #1825
	
# 	desc = RICE_visit_holy_well_desc
	
# 	is_shown = {
# 		is_playable_character = yes
# 		any_directly_owned_province = {
# 			county = {
# 				OR = {
# 					has_county_modifier = TFE_holy_well_level_1
# 					has_county_modifier = TFE_holy_well_level_2
# 					has_county_modifier = TFE_holy_well_level_3
# 				}
# 			}
# 		}
# 		culture = {
# 			has_cultural_tradition = tradition_sacred_springs
# 		}
# 		NOT = {
# 			any_owned_story = {
# 				story_type = story_RICE_visit_holy_well
# 			}
# 		}
# 	}
	
# 	is_valid = {
# 		culture = {
# 			has_cultural_tradition = tradition_sacred_springs
# 		}
# 		custom_description = {
# 			text = TFE_yes_holy_well_county
# 			any_directly_owned_province = {
# 				county = {
# 					OR = {
# 						has_county_modifier = TFE_holy_well_level_1
# 						has_county_modifier = TFE_holy_well_level_2
# 						has_county_modifier = TFE_holy_well_level_3
# 					}
# 				}
# 			}	
# 		}
# 	}

# 	is_valid_showing_failures_only = {
# 		is_available_adult = yes
# 	}

# 	cost = {
# 		gold = TFE_basic_activity_cost
# 	}

# 	effect = {

# 		custom_tooltip = RICE_visit_holy_well_effect_tooltip_1
# 		custom_tooltip = RICE_visit_holy_well_effect_tooltip_2

# 		add_character_flag = planning_an_activity
# 		if = {
# 			limit = {
# 				any_directly_owned_province = {
# 					county = {
# 						has_county_modifier = TFE_holy_well_level_3
# 					}
# 				}
# 			}			
# 			random_directly_owned_province = {
# 				limit = {
# 					county = {
# 						has_county_modifier = TFE_holy_well_level_3
# 					}
# 				}
# 				county = {
# 					root = {
# 						set_variable = {
# 							name = county_well
# 							value = PREV
# 						}
# 					}
# 				}
# 			}
# 		}
# 		else_if = {
# 			limit = {
# 				any_directly_owned_province = {
# 					county = {
# 						has_county_modifier = TFE_holy_well_level_2
# 					}
# 				}
# 			}			
# 			random_directly_owned_province = {
# 				limit = {
# 					county = {
# 						has_county_modifier = TFE_holy_well_level_2
# 					}
# 				}
# 				county = {
# 					root = {
# 						set_variable = {
# 							name = county_well
# 							value = PREV
# 						}
# 					}
# 				}
# 			}
# 		}
# 		else_if = {
# 			limit = {
# 				any_directly_owned_province = {
# 					county = {
# 						has_county_modifier = TFE_holy_well_level_1
# 					}
# 				}
# 			}			
# 			random_directly_owned_province = {
# 				limit = {
# 					county = {
# 						has_county_modifier = TFE_holy_well_level_1
# 					}
# 				}
# 				county = {
# 					root = {
# 						set_variable = {
# 							name = county_well
# 							value = PREV
# 						}
# 					}
# 				}
# 			}
# 		}
# 		# Failsafe in case there's no appropriate county
# 		else = {
# 			root = {
# 				set_variable = {
# 					name = county_well
# 					value = capital_county
# 				}
# 			}
# 		}
# 		create_story = story_RICE_visit_holy_well

# 		if = {
# 			limit = {
# 				has_game_rule = RICE_historical_context_on
# 			}
# 			custom_tooltip = RICE_visit_holy_well_context_tooltip
# 		}
# 	}

# 	ai_potential = {
# 		short_term_gold >= 50
# 	}

# 	ai_will_do = {
# 		base = 30
# 		modifier = {
# 			add = 10
# 			has_trait = zealous
# 		}
# 		modifier = {
# 			add = -10
# 			has_trait = cynical
# 		}
# 		modifier = {
# 			add = 10
# 			has_trait = diligent
# 		}
# 		modifier = {
# 			add = -10
# 			has_trait = lazy
# 		}
# 	}
# }


# Bury Bog Butter
RICE_mayo_bury_bog_butter = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_RICE_western_european_meadows.dds" }
	decision_group_type = RICE_regional

	desc = RICE_mayo_bury_bog_butter_desc

	ai_check_interval_by_tier = {
		barony = 0
		county = 48
		duchy = 48
		kingdom = 48
		empire = 48
		hegemony = 48
	}

	cooldown = { days = 1825 } 

	is_shown = {
		is_playable_character = yes
		culture = {
			has_innovation = innovation_RICE_placeholder_01
		}
	}
	
	is_valid = {
		culture = {
			has_innovation = innovation_RICE_placeholder_01
		}
		OR = {
			custom_description = {
				text = "RICE_any_held_county_bog_butter_terrain_capital_req"
				any_held_title = {
					tier = tier_county
					title_province = {
						OR = {
							terrain = hills
							terrain = forest
							terrain = wetlands
							terrain = taiga
						}						
					}
				}
			}
			custom_description = {
				text = "RICE_any_held_county_bog_butter_terrain_domicile_req"
				domicile.domicile_location ?= {
					OR = {
						terrain = hills
						terrain = forest
						terrain = wetlands
						terrain = taiga
					}
				}
			}
		}
		custom_description = {
			text = "RICE_any_held_county_not_bog_butter_flag_req"
			NOT = {
				has_character_flag = RICE_mayo_buried_bog_butter_flag
			}
		}
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {

		show_as_tooltip = {
			RICE_mayo_bury_bog_butter_basic_effect = yes
		}

		custom_tooltip = RICE_mayo_bury_bog_butter_effect_tooltip_1 
		custom_tooltip = RICE_mayo_bury_bog_butter_effect_tooltip_2 

		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_mayo_bury_bog_butter_context_tooltip
		}

		trigger_event = {
			id = mayo.8888
		}
	}

	cost = { 
		gold = { value = 25 } # Will depend 
	}	

	ai_potential = {
		short_term_gold >= 25
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = 10
			has_trait = gluttonous
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = paranoid
		}
	}
}

# Retrieve Bog Butter
RICE_mayo_retrieve_bog_butter = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_RICE_western_european_meadows.dds" }
	decision_group_type = RICE_regional

	desc = RICE_mayo_retrieve_bog_butter_desc

	ai_check_interval_by_tier = {
		barony = 0
		county = 48
		duchy = 48
		kingdom = 48
		empire = 48
		hegemony = 48
	}

	cooldown = { days = 3650 } 

	is_shown = {
		is_playable_character = yes
		OR = {
			culture = {
				has_innovation = innovation_RICE_placeholder_01
			}
			has_character_flag = RICE_mayo_buried_bog_butter_flag
		}
	}
	
	is_valid = {
		OR = {
			culture = {
				has_innovation = innovation_RICE_placeholder_01
			}
			has_character_flag = RICE_mayo_buried_bog_butter_flag
		}
		custom_description = {
			text = "RICE_any_held_county_bog_butter_flag_req"
			has_character_flag = RICE_mayo_buried_bog_butter_flag
		}
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {

		custom_tooltip = RICE_mayo_retrieve_bog_butter_effect_tooltip_1 
		
		show_as_tooltip = {
			RICE_mayo_retrieve_bog_butter_effect = yes
		}

		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_mayo_retrieve_bog_butter_context_tooltip
		}

		trigger_event = {
			id = mayo.8888
		}
	}

	# cost = { 
	# 	gold = { value = RICE_activity_cost } # Will depend 
	# }	

	# ai_potential = {
	# 	short_term_gold >= RICE_activity_cost
	# }

	ai_will_do = {
		base = 40
		modifier = {
			add = 10
			has_trait = gluttonous
		}
		modifier = {
			add = -10
			has_trait = patient
		}
	}
}


