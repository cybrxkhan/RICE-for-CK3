RICE_setup_nubia_flavor_pack_effect = {

	############################################################
	#
	# DNA
	#
	############################################################



	############################################################
	#
	# HISTORY/TITLE CHANGES
	#
	############################################################ 

	# if = {
	# 	limit = {
	# 		exists = title:d_makuria.holder
	# 	}
	# 	title:d_makuria.holder = {
	# 		get_title = title:k_nubia
	# 	}
	# }
	# if = {
	# 	limit = {
	# 		exists = title:d_sennar.holder
	# 	}
	# 	title:d_sennar.holder = {
	# 		get_title = title:k_alodia
	# 		#convert_whole_realm_to_feudalism_effect = yes
	# 	}
	# }

	# These changes are not needed if BAP is running
	if = {
		limit = {
			NOT = { has_global_variable = bap_is_loaded }
		}				
		# Give titles to kings
		title:k_nubia.holder = { 
			get_title = title:c_dongola
			get_title = title:d_makuria
			#get_title = title:k_nubia
			get_title = title:c_sai
			get_title = title:c_meroe
			get_title = title:c_wadi_el-milk
			get_title = title:c_abwab
			get_title = title:c_atbara
			get_title = title:c_shamir
			get_title = title:c_abu_hammad
			get_title = title:c_kurgus
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			#convert_whole_realm_to_feudalism_effect = yes
			add_gold = 100
			save_scope_as = makurian_king
			set_court_language = language_greek # Set Court Language to Greek
		}
				
		# Give titles to kings
		title:k_alodia.holder = { 
			get_title = title:c_alodia
			get_title = title:c_gezira
			get_title = title:c_eleila
			get_title = title:c_ushara
			get_title = title:d_sennar
			get_title = title:c_sennar
			get_title = title:c_fazughli
			get_title = title:c_tagali
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			#convert_whole_realm_to_feudalism_effect = yes
			add_gold = 100
			save_scope_as = alodian_king
			set_court_language = language_greek # Set Court Language to Greek
		}

			
		# Give Adam, Eparch of Nobadia his land
		title:d_nobatia_fake.holder = {
			get_title = title:c_qasr_ibrim
			get_title = title:c_faras
			get_title = title:c_qurta
			get_title = title:d_nobatia
			save_scope_as = nobatia_eparch
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:nobatia_eparch = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change
	}
	else = {
		title:k_nubia.holder = { 
			save_scope_as = makurian_king
		}				
		# Give titles to kings
		title:k_alodia.holder = { 
			save_scope_as = alodian_king
		}
		# Give Adam, Eparch of Nobadia his land
		title:d_nobatia.holder = {
			save_scope_as = nobatia_eparch
		}
	}

	

	# For 867 bookmark
	if = {
		limit = {
			game_start_date = 867.1.1
		}

		# Set up stuff for Eldad ha-Dani
		character:RICE_red_sea_001 ?= {	
			add_character_modifier = {
				modifier = RICE_nubia_aspiration_spread_stories_tribe_of_dan
			}
			set_variable = {
				name = RICE_historical_aspiration
				value = flag:eldad
			}
		}

		# Set up King Georgios
		character:dongola0010 = {			
			add_character_modifier = {
				modifier = RICE_nubia_aspiration_defeat_the_traitor_and_the_bandit
			}
			set_variable = {
				name = RICE_historical_aspiration
				value = flag:georgios_867
			}
		}

		# Make Ali Baba, king of the Beja pagan
		# There is nothing to suggest he converted to Islam
		# Arab sources record after he was captured by the Muslims, he would prostrate to a small stone idol
		character:1228761 = {
			# If Beja Paganism/Mandulism exists, i.e. using Africa Plus or the like, make Ali Baba that faith
			if = {
				limit = {
					exists = faith:beja_pagan
				}
				set_character_faith = faith:beja_pagan
				every_courtier_or_guest = {
					limit = {
						culture = culture:beja
						NOT = { faith = faith:beja_pagan } 
					}
					set_character_faith = faith:beja_pagan
				}
			}
			# Otherwise, make him vanilla's Kushitic pagan
			else = {
				set_character_faith = faith:kushitism_pagan
				every_courtier_or_guest = {
					limit = {
						culture = culture:beja
						NOT = { faith = faith:kushitism_pagan } 
					}
					set_character_faith = faith:kushitism_pagan
				}
			}
		}

		# Fictitious Maba/Wadai rulers
		character:RICE_maban_867_001 = {
			get_title = title:c_salamat
			get_title = title:c_kadam
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		character:RICE_maban_867_002 = {
			get_title = title:c_dar_sila
			get_title = title:c_masalit
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		# Fictitious Tora rulers
		character:RICE_tora_867_001 = {
			get_title = title:c_qimr
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		character:RICE_tora_867_002 = {
			get_title = title:c_ayn_farah
			get_title = title:c_dar-al-rih
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		character:RICE_tora_867_003 = {
			get_title = title:c_el_fasher
			get_title = title:c_dar_al-said
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		character:RICE_tora_867_004 = {
			get_title = title:c_east_darfur
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		# Give titles to various Makurian officials
		character:RICE_nubia_misc_001 = {
			get_title = title:c_sai
			save_scope_as = merki
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			add_character_modifier = {
				modifier = RICE_nubia_merki_modifier
			}
			add_character_modifier = {
				modifier = RICE_nubia_aspiration_ascend_bureaucracy_makuria
			}
			set_variable = {
				name = RICE_historical_aspiration
				value = flag:merki
			}
		}


		character:RICE_nubia_misc_002 = {
			get_title = title:c_batn_al-hajar
			get_title = title:c_faras
			save_scope_as = mariankuda
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		# character:31720 = {
		# 	save_scope_as = makurian_king
		# }

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:merki = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:mariankuda = {
			change_liege = {
				liege = scope:nobatia_eparch
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		character:dongola0011 = {
			get_title = title:c_abwab
			save_scope_as = prince_georgios
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:prince_georgios = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Ioannes, brother of the king
		# Eparch of Gadera (unknown location)
		character:dongola0010c = {
			get_title = title:c_meroe
			save_scope_as = eparch_ioannes
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:eparch_ioannes = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		character:dongola0011c = {
			get_title = title:c_atbara
			save_scope_as = prince_zacharias
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:prince_zacharias = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		character:dongola0011d = {
			get_title = title:c_shamir
			get_title = title:c_abu_hammad
			get_title = title:c_kurgus
			#get_title = title:c_atbara
			get_title = title:d_shamir
			save_scope_as = niuty
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			add_character_modifier = {
				modifier = RICE_nubia_aspiration_take_over_makuria
			}
			set_variable = {
				name = RICE_historical_aspiration
				value = flag:niuty
			}
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:niuty = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Break Niuty's alliance with his uncle now so it doesn't result in him "breaking" the alliance in the game start event
		if = {
			limit = {
				scope:niuty = {
					any_ally = {
						this = scope:makurian_king
					}
				}
			}
			scope:niuty = {
				break_alliance = scope:makurian_king
			}
		}

		character:RICE_daju_001 = {
			get_title = title:c_ushara
			#get_title = title:c_wadi_el-milk
			save_scope_as = daju_ruler
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:daju_ruler = {
			change_liege = {
				liege = scope:alodian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		if = {
			limit = {
				NOT = { has_global_variable = bap_is_loaded }
			}
			character:c_west_kordofan0001 = {
				get_title = title:c_west_kordofan
				#get_title = title:c_south_kordofan
				save_scope_as = west_kordofan_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes
			}

			title:c_kordofan.holder = {
				save_scope_as = kordofan_ruler
			}

			start_tributary_interaction_effect = {
				TRIBUTARY = scope:west_kordofan_ruler
				SUZERAIN = scope:alodian_king
			}

			start_tributary_interaction_effect = {
				TRIBUTARY = scope:kordofan_ruler
				SUZERAIN = scope:alodian_king
			}

			# Set effect after game start: RICE_no_conversion_contract_at_start_effect
			character:RICE_nilotic_sennar_001 = {
				get_title = title:c_tagali
				get_title = title:c_sennar
				save_scope_as = sennar_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes
			}

			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
			}
			scope:sennar_ruler = {
				change_liege = {
					liege = scope:alodian_king
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change

			# Set effect after game start: RICE_no_conversion_contract_at_start_effect
			character:RICE_nilotic_gezira_001 = {
				get_title = title:c_gezira
				get_title = title:c_eleila
				save_scope_as = gezira_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes
			}

			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
			}
			scope:gezira_ruler = {
				change_liege = {
					liege = scope:alodian_king
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change

			# Set effect after game start: RICE_no_conversion_contract_at_start_effect
			character:RICE_nilotic_fazughli_001 = {
				get_title = title:c_fazughli
				get_title = title:c_gumuz
				save_scope_as = fazughli_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes
			}

			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
			}
			scope:fazughli_ruler = {
				change_liege = {
					liege = scope:alodian_king
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change


		}


	}

	if = {
		limit = {
			game_start_date = 1066.9.15
		}

		# Setting up the Fatimid Civil War
		character:3096 = {
			save_scope_as = al_mustansir
		}

		# Make the Banu Kanz the vassals of the Fatimids and give them Aswan
		character:bedouin0027 = {
			get_title = title:c_aswan
			save_scope_as = banu_kanz
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:banu_kanz = {
			change_liege = {
				liege = scope:al_mustansir
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Although it's sort of nonsensical, give Queen Mother Rasada some territories in Upper Egypt
		# To represent her alliance with the African units of the Fatimid army holed up there
		character:additional_fatimids_1 = {
			get_title = title:c_qus
			get_title = title:c_bahnasa
			get_title = title:c_ushmun
			get_title = title:c_asyut
			get_title = title:d_al-said
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			set_culture = culture:egyptian # Make her Egyptian so weird stuff doesn't happen
			save_scope_as = queen_mother_rasada
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:queen_mother_rasada = {
			change_liege = {
				liege = scope:al_mustansir
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Nasir al-Dawla
		character:RICE_hamdanid_009 = {
			get_title = title:c_damietta
			#get_title = title:c_al-buhaira
			#get_title = title:c_al-gharbiya
			#get_title = title:c_sharkiya
			#get_title = title:c_giza
			#get_title = title:c_fayyum
			get_title = title:d_delta
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = nasir_al_dawla
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:nasir_al_dawla = {
			change_liege = {
				liege = scope:al_mustansir
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Nasir al-Dawla's brother Fakhr al-ʾUmara
		character:RICE_hamdanid_009a = {
			get_title = title:c_sharkiya
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = nasir_al_dawla_brother
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:nasir_al_dawla_brother = {
			change_liege = {
				liege = scope:nasir_al_dawla
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Taj al-Maluk, ally of Nasir al-Dawla who became his deputy in the capital
		character:RICE_taj_al_maluk_001 = {
			get_title = title:c_al-gharbiya
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = taj_al_maluk
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:taj_al_maluk = {
			change_liege = {
				liege = scope:nasir_al_dawla
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Banu Sanin of Buhariya, Nasir al-Dawla's allies
		character:RICE_banu_sanin_001 = {
			get_title = title:c_al-buhaira
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = banun_sanin
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:banun_sanin = {
			change_liege = {
				liege = scope:nasir_al_dawla
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change


		# Yaldakuz
		character:RICE_fatimid_turkic_002 = {
			get_title = title:c_giza
			get_title = title:c_fayyum
			get_title = title:c_bahriya
			get_title = title:c_bahnasa
			get_title = title:d_cairo
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = yaldakuz
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:yaldakuz = {
			change_liege = {
				liege = scope:al_mustansir
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Ildekuz
		character:RICE_fatimid_turkic_001 = {
			get_title = title:c_alexandria
			get_title = title:c_sullum
			get_title = title:d_alexandria
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = ildekuz
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:ildekuz = {
			change_liege = {
				liege = scope:al_mustansir
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Kutama Berbers allied to Ildekuz
		character:RICE_kutama_001 = {
			get_title = title:c_siwa
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = kutama
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:kutama = {
			change_liege = {
				liege = scope:ildekuz
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Lawata/Laguatan Berbers
		character:RICE_lawata_001 = {
			get_title = title:c_kharga
			get_title = title:c_dakhla
			get_title = title:c_farafra
			get_title = title:d_al-wahat
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = lawata
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:lawata = {
			change_liege = {
				liege = scope:al_mustansir
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# African regiments allied to Queen Mother Rasada
		character:RICE_fatimid_african_001 = {
			get_title = title:c_ushmun
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = fatimid_african_1
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:fatimid_african_1 = {
			change_liege = {
				liege = scope:queen_mother_rasada
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# African regiments allied to Queen Mother Rasada
		character:RICE_fatimid_african_002 = {
			get_title = title:c_asyut
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = fatimid_african_1
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:fatimid_african_1 = {
			change_liege = {
				liege = scope:queen_mother_rasada
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Make Badr al-Jamali his own Emir/Duke
		character:34980 = {
			get_title = title:d_urdunn
			save_scope_as = badr_al_jamali
		}

		# Give Badr al-Jamali c_tiberias in vassalage
		character:20775 = {
			save_scope_as = badr_al_jamali_vassal
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:badr_al_jamali_vassal = {
			change_liege = {
				liege = scope:badr_al_jamali
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Let the Beja break free of the Banu Kanz
		# I can't find anything suggesting the Banu Kanz power stretched all the way south to Ethiopia
		# Baqlin King
		character:1228784 = {
			create_title_and_vassal_change = {
				type = independency
				save_scope_as = indpendence_change
				add_claim_on_loss = no
			}
			becomes_independent = {
				change = scope:indpendence_change
			}
			resolve_title_and_vassal_change = scope:indpendence_change
		}
		# Hadariba King
		character:1228770 = {
			create_title_and_vassal_change = {
				type = independency
				save_scope_as = indpendence_change
				add_claim_on_loss = no
			}
			becomes_independent = {
				change = scope:indpendence_change
			}
			resolve_title_and_vassal_change = scope:indpendence_change
		}


		# Fictitious Maba/Wadai rulers
		character:RICE_maban_1066_001 = {
			get_title = title:c_salamat
			get_title = title:c_kadam
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		character:RICE_maban_1066_002 = {
			get_title = title:c_dar_sila
			get_title = title:c_masalit
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		# Fictitious Tora rulers
		character:RICE_tora_1066_001 = {
			get_title = title:c_ayn_farah
			get_title = title:c_qimr
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		character:RICE_tora_1066_002 = {
			get_title = title:c_dar_al-said
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}


		# Kusbur, one of the early Daju kings according to some legends
		character:RICE_daju_002 = {
			# Daju mainly dominant over the east/southeast Jebel Marra
			get_title = title:c_el_fasher
			#get_title = title:c_dar_al-said
			get_title = title:c_east_darfur
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			add_character_modifier = {
				modifier = RICE_nubia_aspiration_daju_migration_into_darfur
			}
			set_variable = {
				name = RICE_historical_aspiration
				value = flag:kusbur
			}
		}

		character:RICE_daju_misc_001 = {
			# Daju mainly dominant over the east/southeast Jebel Marra
			get_title = title:c_dar-al-rih
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		character:RICE_nubia_002 = {
			get_title = title:b_dongola
			get_title = title:c_shamir
			get_title = title:c_abu_hammad
			get_title = title:c_kurgus
			get_title = title:d_shamir
			change_government = theocracy_government
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		# Mena, vice-eparch/anteparch of Nobatia c. late 1000s
		character:RICE_nubia_misc_006 = {
			get_title = title:c_kalabsha
			get_title = title:c_qurta
			save_scope_as = mena_1066
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:mena_1066 = {
			change_liege = {
				liege = scope:nobatia_eparch
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Son of Mashshouda Isminna whose name is not known
		# Held the title of choiakishshil, possibly in Nobatia
		character:RICE_nubia_misc_014 = {
			get_title = title:c_batn_al-hajar
			save_scope_as = mashshouda_isminna_son
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:mashshouda_isminna_son = {
			change_liege = {
				liege = scope:nobatia_eparch
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Georgios, Bishop of Faras attested from 1062-1097
		character:RICE_nubia_misc_010 = {
			get_title = title:c_faras
			save_scope_as = bishop_georgios
			change_government = theocracy_government
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:bishop_georgios = {
			change_liege = {
				liege = scope:nobatia_eparch
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Petros, official attested c. 1070s
		character:RICE_nubia_misc_009 = {
			get_title = title:c_meroe
			get_title = title:c_wadi_el-milk
			save_scope_as = petros_1066
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:petros_1066 = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		if = {
			limit = {
				NOT = { has_global_variable = bap_is_loaded }
			}
			character:c_west_kordofan0008 = {
				get_title = title:c_west_kordofan
				#get_title = title:c_south_kordofan
				save_scope_as = west_kordofan_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes
			}

			title:c_kordofan.holder = {
				save_scope_as = kordofan_ruler
			}

			start_tributary_interaction_effect = {
				TRIBUTARY = scope:west_kordofan_ruler
				SUZERAIN = scope:alodian_king
			}

			start_tributary_interaction_effect = {
				TRIBUTARY = scope:kordofan_ruler
				SUZERAIN = scope:alodian_king
			}


			# Set effect after game start: RICE_no_conversion_contract_at_start_effect
			character:RICE_nilotic_sennar_002 = {
				get_title = title:c_tagali
				get_title = title:c_sennar
				save_scope_as = sennar_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes
			}

			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
			}
			scope:sennar_ruler = {
				change_liege = {
					liege = scope:alodian_king
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change

			# Set effect after game start: RICE_no_conversion_contract_at_start_effect
			character:RICE_nilotic_gezira_002 = {
				get_title = title:c_gezira
				get_title = title:c_eleila
				save_scope_as = gezira_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes
			}

			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
			}
			scope:gezira_ruler = {
				change_liege = {
					liege = scope:alodian_king
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change

			# Set effect after game start: RICE_no_conversion_contract_at_start_effect
			character:RICE_nilotic_fazughli_002 = {
				get_title = title:c_fazughli
				get_title = title:c_gumuz
				save_scope_as = fazughli_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes
			}

			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
			}
			scope:fazughli_ruler = {
				change_liege = {
					liege = scope:alodian_king
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change

		}

	}

	if = {
		limit = {
			game_start_date = 1178.10.1
		}		

		# Let the Beja break free of the Banu Kanz
		# I can't find anything suggesting the Banu Kanz power stretched all the way south to Ethiopia
		# Baqlin King
		character:1228787 = {
			create_title_and_vassal_change = {
				type = independency
				save_scope_as = indpendence_change
				add_claim_on_loss = no
			}
			becomes_independent = {
				change = scope:indpendence_change
			}
			resolve_title_and_vassal_change = scope:indpendence_change
		}
		# Hadariba King
		character:1228766 = {
			create_title_and_vassal_change = {
				type = independency
				save_scope_as = indpendence_change
				add_claim_on_loss = no
			}
			becomes_independent = {
				change = scope:indpendence_change
			}
			resolve_title_and_vassal_change = scope:indpendence_change
		}

		# Moses Georgios himself
		character:dongola0022 = {			
			add_character_modifier = {
				modifier = RICE_nubia_aspiration_revive_nubia
			}
			set_variable = {
				name = RICE_historical_aspiration
				value = flag:moses_georgios
			}
		}

		# Adam, Eparch of Nobatia
		character:nobadia0018 = {			
			add_character_modifier = {
				modifier = RICE_nubia_aspiration_look_after_nubia_frontier
			}
			set_variable = {
				name = RICE_historical_aspiration
				value = flag:eparch_adam
			}
		}

		# Fictitious Maba/Wadai rulers
		character:RICE_maban_1178_001 = {
			get_title = title:c_salamat
			get_title = title:c_kadam
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		character:RICE_maban_1178_002 = {
			get_title = title:c_dar_sila
			get_title = title:c_masalit
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		# Fictitious Tora rulers
		character:RICE_tora_1178_001 = {
			get_title = title:c_qimr
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		character:RICE_daju_005 = {
			get_title = title:c_el_fasher
			get_title = title:c_east_darfur
			#get_title = title:d_darfur
			save_scope_as = daju_king
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		# Tora/Proto-Fur vassal of the Daju
		character:RICE_tora_1178_002 = {
			get_title = title:c_dar_al-said
			save_scope_as = fictional_tora_vassal
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:fictional_tora_vassal = {
			change_liege = {
				liege = scope:daju_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		character:RICE_daju_misc_002 = {
			get_title = title:c_ayn_farah
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		character:RICE_daju_misc_003 = {
			get_title = title:c_dar-al-rih
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}

		# title:c_kalabsha.holder = {
		# 	save_scope_as = kalabsha_ruler
		# }

		
		# # Give Kapopi her land
		# # character:RICE_nubia_misc_003 = {
		# # 	get_title = title:c_batn_al-hajar
		# # 	save_scope_as = kapopi
		# # 	RICE_setup_new_granted_ruler_bonuses_effect = yes
		# # }

		# create_title_and_vassal_change = {
		# 	type = swear_fealty
		# 	save_scope_as = change
		# }
		# scope:kalabsha_ruler = {
		# 	change_liege = {
		# 		liege = scope:nobatia_eparch
		# 		change = scope:change
		# 	}
		# }
		# resolve_title_and_vassal_change = scope:change

		# Mashshouda
		# Held titles of choiak-eikšil, Elder, maybe also nešš of Koudketi
		character:RICE_mashshouda_001 = {
			get_title = title:c_meroe
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = mashshouda
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:mashshouda = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Mena
		# Husband of Eoinnoka, a well-connected elite woman in Nobatia
		# He may be identical to a bishop of Ibrim
		character:RICE_einnoka_008 = {
			get_title = title:c_batn_al-hajar
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = eoinnoka_character
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:eoinnoka_character = {
			change_liege = {
				liege = scope:nobatia_eparch
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Aaron
		# Bishop of Faras
		# Since there is a domestikos of Faras (Sharaf) in Faras, I have to put him somewhere else
		character:RICE_nubia_eparch_coworkers_012 = {
			get_title = title:c_kalabsha
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			change_government = theocracy_government
			save_scope_as = bishop_aaron
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:bishop_aaron = {
			change_liege = {
				liege = scope:nobatia_eparch
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change


		# Papon / Papon Ouatta
		# Chief of the King, tot of Ibrim, Great Kis, as well as a priest from Derr and an employee of the chancellery
		# However he had kids, so I won't portray him as a priest per se (?)
		character:RICE_papon_001 = {
			get_title = title:c_abwab
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = papon
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:papon = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Chael
		# Lord of the Horses, attested in 1200
		character:RICE_chael_001 = {
			get_title = title:c_alodia
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = chael
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:chael = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Lami ibn Hasan al-Kanzi
		# Muslim courtier of the Makurian King, associate of the Fatimids, somehow involved in Eparch/trade with Egypt/baqt shenanigans maybe
		# Possible rivals/had issues with Hisn al-Dawla
		character:RICE_lami_al_kanzi_001 = {
			get_title = title:c_shamir
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = lami_al_kanzi
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:lami_al_kanzi = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Hisn al-Dawla
		# Muslim courtier of the Makurian King, associate of the Fatimids, somehow involved in Eparch/trade with Egypt/baqt shenanigans maybe
		# Possible rivals/had issues with Hisn al-Dawla
		character:RICE_hisn_al_asqalani_001 = {
			get_title = title:c_abu_hammad
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = hisn_al_asqalani
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:hisn_al_asqalani = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Sirephi/Sharaf, Domestikos of Faras attested c. 1190-1200
		# Possibly the same as a mid-ranking official of Moses Georgios attested in 1155
		# His name is the Nubian transliteration of Sharaf, so it's not implausible he might've been Arab origin or influenced
		character:RICE_nubia_eparch_coworkers_001 = {
			get_title = title:c_faras
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = sharaf
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:sharaf = {
			change_liege = {
				liege = scope:nobatia_eparch
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Minnel, vice-eparch attested c. 1190-1200
		character:RICE_nubia_eparch_coworkers_002 = {
			get_title = title:c_qurta
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = minnel
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:minnel = {
			change_liege = {
				liege = scope:nobatia_eparch
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Teita
		# Domestikos Elect and a local chief/tot (?) of Arminna
		character:RICE_nubia_eparch_coworkers_003 = {
			get_title = title:c_qurta
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = minnel
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:minnel = {
			change_liege = {
				liege = scope:nobatia_eparch
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		# Dauti aka Dauid
		# Thel of Kaktine attested in the mid 1100s under eparchs like Mase
		# I'm making him the father of Tapara for simplicity
		# Tapara, the Meizoterus/Meizoteros of Ibrim, attested in the late 1100s
		# Might be the same man as the thel( ) of Kaktine from an earlier document from the c. 1150-1180s
		character:RICE_nubia_thel_of_kaktine_01 = {
			get_title = title:c_wadi_el-milk
			RICE_setup_new_granted_ruler_bonuses_effect = yes
			save_scope_as = dauti
		}

		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		scope:dauti = {
			change_liege = {
				liege = scope:makurian_king
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change



		if = {
			limit = {
				NOT = { has_global_variable = bap_is_loaded }
			}
			character:c_west_kordofan0012 = {
				get_title = title:c_west_kordofan
				#get_title = title:c_south_kordofan
				save_scope_as = west_kordofan_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes
			}

			title:c_kordofan.holder = {
				save_scope_as = kordofan_ruler
			}

			start_tributary_interaction_effect = {
				TRIBUTARY = scope:west_kordofan_ruler
				SUZERAIN = scope:alodian_king
			}

			start_tributary_interaction_effect = {
				TRIBUTARY = scope:kordofan_ruler
				SUZERAIN = scope:alodian_king
			}

			
			# Set effect after game start: RICE_no_conversion_contract_at_start_effect
			character:RICE_nilotic_sennar_003 = {
				get_title = title:c_tagali
				get_title = title:c_sennar
				save_scope_as = sennar_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes				
				create_title_and_vassal_change = {
					type = independency
					save_scope_as = indpendence_change
					add_claim_on_loss = no
				}
				becomes_independent = {
					change = scope:indpendence_change
				}
				resolve_title_and_vassal_change = scope:indpendence_change
			}

			# They are now tributaries vs. vassals to represent gradual breakdown of Alodian authority, particularly in the south
			start_tributary_interaction_effect = {
				TRIBUTARY = scope:sennar_ruler
				SUZERAIN = scope:alodian_king
			}

			# Set effect after game start: RICE_no_conversion_contract_at_start_effect
			character:RICE_nilotic_gezira_003 = {
				get_title = title:c_gezira
				get_title = title:c_eleila
				save_scope_as = gezira_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes
			}

			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
			}
			scope:gezira_ruler = {
				change_liege = {
					liege = scope:alodian_king
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change

			# Set effect after game start: RICE_no_conversion_contract_at_start_effect
			character:RICE_nilotic_fazughli_003 = {
				get_title = title:c_fazughli
				get_title = title:c_gumuz
				save_scope_as = fazughli_ruler
				RICE_setup_new_granted_ruler_bonuses_effect = yes			
				create_title_and_vassal_change = {
					type = independency
					save_scope_as = indpendence_change
					add_claim_on_loss = no
				}
				becomes_independent = {
					change = scope:indpendence_change
				}
				resolve_title_and_vassal_change = scope:indpendence_change
			}

			# They are now tributaries vs. vassals to represent gradual breakdown of Alodian authority, particularly in the south
			start_tributary_interaction_effect = {
				TRIBUTARY = scope:fazughli_ruler
				SUZERAIN = scope:alodian_king
			}


		}



	}

	title:c_alodia.holder = {
		change_government = feudal_government
	}
	title:c_gezira.holder = {
		change_government = feudal_government
	}
	title:b_soba.title_province = {
		set_holding_type = castle_holding
	}
	title:b_geili.title_province = {
		set_holding_type = city_holding
	}
	title:b_kadero.title_province = {
		set_holding_type = church_holding
	}
	title:b_ushara.title_province = {
		set_holding_type = castle_holding
	}
	title:b_geteina.title_province = {
		set_holding_type = castle_holding
	}
	title:b_arbaji.title_province = {
		set_holding_type = city_holding
	}
	title:b_el-eleila.title_province = {
		set_holding_type = castle_holding
	}
	title:d_makuria = {
		copy_title_history = title:k_nubia
	}
	title:d_sennar = {
		copy_title_history = title:k_alodia
	}
	title:d_alwa = {
		copy_title_history = title:k_alodia
	}
	title:d_nobatia = {
		copy_title_history = title:d_nobatia_fake
	}
	if = {
		limit = {
			current_date < 1066.1.1
		}
		title:c_alodia = {
			change_development_level = 8
		}
		title:c_gezira = {
			change_development_level = 4
		}
		title:c_eleila = {
			change_development_level = 4
		}
		title:c_ushara = {
			change_development_level = 4
		}
		title:c_naga = {
			change_development_level = 2
		}
		title:c_sennar = {
			change_development_level = 1
		}
		title:c_fazughli = {
			change_development_level = 1
		}
		title:c_tagali = {
			change_development_level = 1
		}
		title:c_gumuz = {
			change_development_level = 1
		}
	}
	else_if = {
		limit = {
			current_date < 1178.1.1
		}
		title:c_alodia = {
			change_development_level = 10
		}
		title:c_gezira = {
			change_development_level = 5
		}
		title:c_eleila = {
			change_development_level = 5
		}
		title:c_ushara = {
			change_development_level = 5
		}
		title:c_naga = {
			change_development_level = 3
		}
		title:c_sennar = {
			change_development_level = 2
		}
		title:c_fazughli = {
			change_development_level = 2
		}
		title:c_tagali = {
			change_development_level = 2
		}
		title:c_gumuz = {
			change_development_level = 2
		}
	}
	else = {
		title:c_alodia = {
			change_development_level = 25
		}
		title:c_gezira = {
			change_development_level = 18
		}
		title:c_eleila = {
			change_development_level = 18
		}
		title:c_ushara = {
			change_development_level = 18
		}
		title:c_naga = {
			change_development_level = 14
		}
		title:c_sennar = {
			change_development_level = 6
		}
		title:c_fazughli = {
			change_development_level = 6
		}
		title:c_tagali = {
			change_development_level = 6
		}
		title:c_gumuz = {
			change_development_level = 6
		}
	}

	if = {
		# If running with Ibn Battuta's Legacy, just do it all at once to make it easier
		limit = {
			NOT = { exists = title:c_selima }
		}
		title:k_nubia = {
			set_de_jure_liege_title = title:e_nubia
		}
		title:k_blemmyia = {
			set_de_jure_liege_title = title:e_nubia
		}
		title:d_alwa = {
			set_de_jure_liege_title = title:k_alodia
		}
		title:d_sennar = {
			set_de_jure_liege_title = title:k_alodia
		}
		title:d_kordofan = {
			set_de_jure_liege_title = title:k_alodia
		}
		# title:c_abwab = {
		# 	set_de_jure_liege_title = title:d_alwa
		# }
		# title:c_atbara = {
		# 	set_de_jure_liege_title = title:d_shamir
		# }
	}

	destroy_title = title:d_nobatia_fake



	# Baqt will be handled as a situation, rather than a tributary
	if = {
		limit = {
			title:k_nubia.holder = {
				is_tributary = yes
			}
		}
		title:k_nubia.holder = {
			end_tributary = yes
		}
	}



	############################################################
	#
	# RELIGION CHANGES
	#
	############################################################

	faith:coptic = {
		add_doctrine = special_doctrine_rice_doctrine_northeast_african_tattoo
	}


	if = {
		limit = {
			NOT = { exists = culture:soissons }
		}		
		every_county = {
			limit = {
				title_province = {	
					OR = {
						duchy = title:d_kordofan
						county = title:c_tagali
					}		
				}
			}
			set_county_culture = culture:nuba
			set_county_faith = faith:nuba_pagan
		}
		every_ruler = {
			limit = {
				capital_county ?= {
					culture = culture:nuba
				}
			}
			if = {
				limit = {
					NOT = { culture = culture:nuba }
					capital_county ?= {
						culture = culture:nuba
					}
				}
				set_culture = culture:nuba
				every_courtier_or_guest = {
					set_culture = culture:nuba
				}
				every_vassal_or_below = {
					set_culture = culture:nuba
					every_courtier_or_guest = {
						set_culture = culture:nuba
					}
				}
			}
			if = {
				limit = {
					NOT = { faith = faith:nuba_pagan }
					capital_county ?= {
						faith = faith:nuba_pagan
					}
				}
				set_character_faith_with_conversion = faith:nuba_pagan
				every_courtier_or_guest = {
					set_character_faith = faith:nuba_pagan
				}
				every_vassal_or_below = {
					set_character_faith_with_conversion = faith:nuba_pagan
					every_courtier_or_guest = {
						set_character_faith = faith:nuba_pagan
					}
				}
			}		
			every_courtier_or_guest = {
				limit = {
					is_lowborn = yes
					NOT = { culture = culture:nuba }
				}
				random = {
					chance = 30
					set_culture = culture:nuba
					set_character_faith = faith:nuba_pagan
				}
			}
		}
		every_county = {
			limit = {
				title_province = {	
					OR = {
						duchy = title:d_sennar
						county = title:c_eleila
						county = title:c_gezira
					}	
					NOT = { county = title:c_tagali }	
				}
			}
			set_county_culture = culture:dinka
			set_county_faith = faith:dinka_pagan
		}
		every_ruler = {
			limit = {
				capital_county ?= {
					culture = culture:dinka
				}
			}
			if = {
				limit = {
					NOT = { culture = culture:dinka }
					capital_county ?= {
						culture = culture:dinka
					}
					highest_held_title_tier = tier_county
				}
				set_culture = culture:dinka
				every_courtier_or_guest = {
					set_culture = culture:dinka
				}
				every_vassal_or_below = {
					set_culture = culture:dinka
					every_courtier_or_guest = {
						set_culture = culture:dinka
					}
				}
			}
			if = {
				limit = {
					NOT = { faith = faith:dinka_pagan }
					capital_county ?= {
						faith = faith:dinka_pagan
					}
					highest_held_title_tier = tier_county
				}
				set_character_faith_with_conversion = faith:dinka_pagan
				every_courtier_or_guest = {
					set_character_faith = faith:dinka_pagan
				}
				every_vassal_or_below = {
					set_character_faith_with_conversion = faith:dinka_pagan
					every_courtier_or_guest = {
						set_character_faith = faith:dinka_pagan
					}
				}
			}			
			every_courtier_or_guest = {
				limit = {
					is_lowborn = yes
					NOT = { culture = culture:dinka }
				}
				random = {
					chance = 30
					set_culture = culture:dinka
					set_character_faith = faith:dinka_pagan
				}
			}
		}
		if = {
			limit = {
				game_start_date < 1050.1.1
			}
			title:c_wadi_el-milk = {
				set_county_culture = culture:daju
				set_county_faith = faith:daju_pagan
			}
			title:c_ushara = {
				set_county_culture = culture:daju
				set_county_faith = faith:daju_pagan
			}
			# If running with Ibn Battuta's legacy
			if = {
				limit = {
					exists = title:c_selima
				}
				title:c_upper_milk = {
					set_county_culture = culture:daju
					set_county_faith = faith:daju_pagan
				}
				title:c_bayuda = {
					set_county_culture = culture:daju
					set_county_faith = faith:daju_pagan
				}
			}
			every_county = {
				limit = {
					title_province = {	
						OR = {
							duchy = title:d_darfur
							duchy = title:d_west_darfur
						}	
					}
				}
				set_county_culture = culture:tora
				set_county_faith = faith:fur_pagan # Fur pagan
			}
		}
		else_if = {
			limit = {
				game_start_date >= 1050.1.1
				game_start_date <= 1150.1.1
			}
			title:c_wadi_el-milk = {
				set_county_culture = culture:daju
				set_county_faith = faith:daju_pagan
			}
			title:c_ushara = {
				set_county_culture = culture:daju
				set_county_faith = faith:daju_pagan
			}
			title:c_el_fasher = {
				set_county_culture = culture:daju
				set_county_faith = faith:daju_pagan
			}
			title:c_east_darfur = {
				set_county_culture = culture:daju
				set_county_faith = faith:daju_pagan
			}
			# If running with Ibn Battuta's legacy
			if = {
				limit = {
					exists = title:c_selima
				}
				title:c_upper_milk = {
					set_county_culture = culture:daju
					set_county_faith = faith:daju_pagan
				}
				title:c_bayuda = {
					set_county_culture = culture:daju
					set_county_faith = faith:daju_pagan
				}
			}
			every_county = {
				limit = {
					title_province = {	
						OR = {
							duchy = title:d_darfur
							duchy = title:d_west_darfur
						}	
						NOT = { county = title:c_east_darfur }
						NOT = { county = title:c_el_fasher }
					}
				}
				set_county_culture = culture:tora
				set_county_faith = faith:fur_pagan # Fur pagan
			}
		}
		else_if = {
			limit = {
				game_start_date >= 1150.1.1
			}
			# title:c_wadi_el-milk = {
			# 	set_county_culture = culture:daju
			# 	set_county_faith = faith:daju_pagan
			# }
			title:c_dar-al-rih = {
				set_county_culture = culture:daju
				set_county_faith = faith:daju_pagan
			}
			title:c_el_fasher = {
				set_county_culture = culture:daju
				set_county_faith = faith:daju_pagan
			}
			title:c_ayn_farah = {
				set_county_culture = culture:daju
				set_county_faith = faith:daju_pagan
			}
			title:c_east_darfur = {
				set_county_culture = culture:daju
				set_county_faith = faith:daju_pagan
			}
			every_county = {
				limit = {
					title_province = {	
						OR = {
							duchy = title:d_darfur
							duchy = title:d_west_darfur
						}	
						NOT = { county = title:c_dar-al-rih }
						NOT = { county = title:c_el_fasher }
						NOT = { county = title:c_ayn_farah }
						NOT = { county = title:c_east_darfur }
					}
				}
				set_county_culture = culture:tora
				set_county_faith = faith:fur_pagan # Fur pagan
			}
		}
		every_ruler = {
			limit = {
				capital_county ?= {
					culture = culture:tora
				}
			}
			if = {
				limit = {
					NOT = { culture = culture:tora }
					capital_county ?= {
						culture = culture:tora
					}
					#highest_held_title_tier = tier_county
				}
				set_culture = culture:tora
				every_courtier_or_guest = {
					set_culture = culture:tora
				}
				every_vassal_or_below = {
					set_culture = culture:tora
					every_courtier_or_guest = {
						set_culture = culture:tora
					}
				}
			}
			if = {
				limit = {
					NOT = { faith = faith:fur_pagan }
					capital_county ?= {
						faith = faith:fur_pagan
					}
					#highest_held_title_tier = tier_county
				}
				set_character_faith_with_conversion = faith:fur_pagan
				every_courtier_or_guest = {
					set_character_faith = faith:fur_pagan
				}
				every_vassal_or_below = {
					set_character_faith_with_conversion = faith:fur_pagan
					every_courtier_or_guest = {
						set_character_faith = faith:fur_pagan
					}
				}
			}			
			every_courtier_or_guest = {
				limit = {
					is_lowborn = yes
					NOT = { culture = culture:tora }
				}
				random = {
					chance = 30
					set_culture = culture:tora
					set_character_faith = faith:fur_pagan
				}
			}
		}
		every_ruler = {
			limit = {
				NOT = { culture = culture:daju }
				capital_county ?= {
					culture = culture:daju
				}
			}		
			every_courtier_or_guest = {
				limit = {
					is_lowborn = yes
					NOT = { culture = culture:daju }
				}
				random = {
					chance = 30
					set_culture = culture:daju
					set_character_faith = faith:daju_pagan
				}
			}
		}
		# Try to catch every random Daju character that didn't make it
		every_ruler = {
			limit = {
				title_province = { geographical_region = sahel_sub_saharan_africa_nomad_area }
				any_courtier_or_guest = {
					is_lowborn = yes
					culture = culture:daju
					NOT = { faith = faith:daju_pagan }
				}
			}		
			every_courtier_or_guest = {
				limit = {
					is_lowborn = yes
					culture = culture:daju
					NOT = { faith = faith:daju_pagan }
				}
				set_character_faith = faith:daju_pagan
			}
		}
		
		title:c_masalit = {
			set_county_culture = culture:maban
		}
		title:c_dar_sila = {
			set_county_culture = culture:maban
		}
		title:c_kadam = {
			set_county_culture = culture:maban
		}
		title:c_salamat = {
			set_county_culture = culture:maban
		}
		# title:c_wadai = {
		# 	set_county_culture = culture:maban
		# }

		every_ruler = {
			limit = {
				capital_county ?= {
					culture = culture:maban
				}
			}
			if = {
				limit = {
					#NOT = { culture = culture:maban }
					capital_county ?= {
						culture = culture:maban
					}
				}
				set_culture = culture:maban
				every_courtier_or_guest = {
					set_culture = culture:maban
				}
				every_vassal_or_below = {
					set_culture = culture:maban
					every_courtier_or_guest = {
						set_culture = culture:maban
					}
				}
			}			
			# every_courtier_or_guest = {
			# 	limit = {
			# 		is_lowborn = yes
			# 		NOT = { culture = culture:maban }
			# 	}
			# 	random = {
			# 		chance = 30
			# 		set_culture = culture:maban
			# 	}
			# }
		}

		every_county = {
			limit = {
				title_province = {	
					kingdom = title:k_sahara
				}
				culture = culture:zaghawa
			}
			set_county_culture = culture:toubou
		}

		every_ruler = {
			limit = {
				capital_county ?= {
					culture = culture:toubou
				}
			}
			if = {
				limit = {
					#NOT = { culture = culture:toubou }
					capital_county ?= {
						culture = culture:toubou
					}
				}
				set_culture = culture:toubou
				every_courtier_or_guest = {
					set_culture = culture:toubou
				}
				every_vassal_or_below = {
					set_culture = culture:toubou
					every_courtier_or_guest = {
						set_culture = culture:toubou
					}
				}
			}			
			every_courtier_or_guest = {
				limit = {
					is_lowborn = yes
					NOT = { culture = culture:toubou }
				}
				random = {
					chance = 30
					set_culture = culture:toubou
				}
			}
		}
		
		every_county = {
			limit = {
				OR = {
					culture = culture:zaghawa
					culture = culture:maban
					culture = culture:toubou
				}
				faith.religion = { is_in_family = rf_pagan }
			}
			set_county_faith = faith:idoism_pagan
		}
		every_ruler = {
			limit = {
				OR = {
					culture = culture:zaghawa
					culture = culture:maban
					culture = culture:toubou
				}
			}
			if = {
				limit = {
					faith.religion = { is_in_family = rf_pagan }
				}
				set_character_faith_with_conversion = faith:idoism_pagan
				every_courtier_or_guest = {
					limit = {
						OR = {
							culture = culture:zaghawa
							culture = culture:maban
							culture = culture:toubou
						}
						faith.religion = { is_in_family = rf_pagan }
					}
					set_character_faith = faith:idoism_pagan
				}
				every_vassal_or_below = {
					limit = {
						OR = {
							culture = culture:zaghawa
							culture = culture:maban
							culture = culture:toubou
						}
						faith.religion = { is_in_family = rf_pagan }
					}
					set_character_faith_with_conversion = faith:idoism_pagan
					every_courtier_or_guest = {
						set_character_faith = faith:idoism_pagan
					}
				}
			}
			else = {
				every_courtier_or_guest = {
					limit = {
						OR = {
							culture = culture:zaghawa
							culture = culture:maban
							culture = culture:toubou
						}
						is_lowborn = yes
						faith.religion = { is_in_family = rf_pagan }
					}
					set_character_faith = faith:idoism_pagan
				}

			}
		}	
		
		every_county = {
			limit = {
				OR = {
					culture = culture:sao
					culture = culture:kanuri
				}
				faith.religion = { is_in_family = rf_pagan }
			}
			set_county_faith = faith:munean_pagan
		}
		every_ruler = {
			limit = {
				OR = {
					culture = culture:sao
					culture = culture:kanuri
				}
			}
			if = {
				limit = {
					faith.religion = { is_in_family = rf_pagan }
				}
				set_character_faith_with_conversion = faith:munean_pagan
				every_courtier_or_guest = {
					limit = {
						OR = {
							culture = culture:sao
							culture = culture:kanuri
						}
						faith.religion = { is_in_family = rf_pagan }
					}
					set_character_faith = faith:munean_pagan
				}
				every_vassal_or_below = {
					limit = {
						OR = {
							culture = culture:sao
							culture = culture:kanuri
						}
						faith.religion = { is_in_family = rf_pagan }
					}
					set_character_faith_with_conversion = faith:munean_pagan
					every_courtier_or_guest = {
						set_character_faith = faith:munean_pagan
					}
				}
			}
			else = {
				every_courtier_or_guest = {
					limit = {
						OR = {
							culture = culture:sao
							culture = culture:kanuri
						}
						is_lowborn = yes
						faith.religion = { is_in_family = rf_pagan }
					}
					set_character_faith = faith:munean_pagan
				}

			}
		}	

	}

	############################################################ 
	#
	# CULTURE CHANGES
	#
	############################################################ 

	culture:nubian = {
		if = {
			limit = {
				set_culture_pillar = martial_custom_equal
			}
			set_culture_pillar = martial_custom_male_only
		}
		if = {
			limit = { has_cultural_tradition = tradition_agrarian }
			remove_culture_tradition = tradition_agrarian
		}
		if = {
			limit = { has_cultural_tradition = tradition_xenophilic }
			remove_culture_tradition = tradition_xenophilic
		}
		# Warrior Queens makes no sense for medieval Nubia, we have very few evidence of queen regnants in Nubia
		# Succession was matrilineal and significant influence of queen mothers/queen consorts in Nubia =/= matriarchal rule
		# As a compromise, the Heirs of Kush tradition allows equal preference inheritance
		if = {
			limit = { has_cultural_tradition = tradition_nubian_warrior_queens }
			remove_culture_tradition = tradition_nubian_warrior_queens
		}
		# Nubians were proficient in Nubian, Greek, Coptic, and Arabic
		add_culture_tradition = tradition_language_scholars
		# Nubian kings were closely tied to the Christian church
		add_culture_tradition = tradition_religious_patronage
		# General Nubian flavor stuff
		add_culture_tradition = tradition_RICE_heirs_of_kush
		remove_variable = tradition_cooldown
	}	

	culture:sudanese = {
		add_culture_tradition = tradition_RICE_heirs_of_kush
		remove_variable = tradition_cooldown
	}

	culture:nuba = {
		add_culture_tradition = tradition_RICE_nuba_sports_competitions
		remove_variable = tradition_cooldown
	}	

	culture:daju = {
		#set_name_list = name_list_fur
		if = {
			limit = {
				set_culture_pillar = martial_custom_equal
			}
			set_culture_pillar = martial_custom_male_only
		}
		# if = {
		# 	limit = { has_cultural_tradition = tradition_warrior_culture }
		# 	remove_culture_tradition = tradition_warrior_culture
		# }
		if = {
			limit = { has_cultural_tradition = tradition_nubian_warrior_queens }
			remove_culture_tradition = tradition_nubian_warrior_queens
		}
		# Some suggestions very loosely based on Skaven's ideas
		add_culture_tradition = tradition_desert_nomads
		add_culture_tradition = tradition_RICE_darfur_mountain_palaces
		remove_variable = tradition_cooldown
	}	

	culture:tora = {
		add_culture_tradition = tradition_RICE_darfur_mountain_palaces
		remove_variable = tradition_cooldown
	}	

	culture:dinka = {
		if = {
			limit = { has_cultural_tradition = tradition_tribe_unity }
			remove_culture_tradition = tradition_tribe_unity
		}
		if = {
			limit = { has_cultural_tradition = tradition_zealous_people }
			remove_culture_tradition = tradition_zealous_people
		}
		add_culture_tradition = tradition_RICE_spear_masters
		add_culture_tradition = tradition_RICE_nilotic_cattle_raiders
		remove_variable = tradition_cooldown
	}	

	culture:luo = {
		add_culture_tradition = tradition_RICE_nilotic_cattle_raiders
		remove_variable = tradition_cooldown
	}	

	culture:ateker = {
		add_culture_tradition = tradition_RICE_nilotic_cattle_raiders
		remove_variable = tradition_cooldown
	}	

	culture:maasai = {
		add_culture_tradition = tradition_RICE_nilotic_cattle_raiders
		remove_variable = tradition_cooldown
	}	

	culture:bari = {
		add_culture_tradition = tradition_RICE_nilotic_cattle_raiders
		remove_variable = tradition_cooldown
	}	

	culture:kalenjin = {
		add_culture_tradition = tradition_RICE_nilotic_cattle_raiders
		remove_variable = tradition_cooldown
	}	
	
	############################################################
	#
	# BUILDING
	#
	############################################################

	if = {
		limit = {
			title:b_old_dongola = {
				title_province = { has_special_building = no }
			}
		}
		title:b_old_dongola.title_province = {
			add_special_building = RICE_nubia_throne_hall_of_dongola
		}
	}

	if = {
		limit = {
			title:b_naga = {
				title_province = { has_special_building = no }
			}
		}
		title:b_naga.title_province = {
			add_special_building = RICE_nubia_musawwarat_es_sufra
		}
	}

	if = {
		limit = {
			title:b_faras = {
				title_province = { has_special_building = no }
			}
		}
		title:b_faras.title_province = {
			add_special_building = RICE_nubia_faras_cathedral
		}
	}

	if = {
		limit = {
			title:b_al-abwab = {
				title_province = { has_special_building = no }
			}
		}
		title:b_al-abwab.title_province = {
			add_special_building = RICE_nubia_pyramids_of_meroe
		}
	}

	if = {
		limit = {
			title:b_el-obeid = {
				title_province = { has_special_building = no }
			}
		}
		title:b_el-obeid.title_province = {
			add_special_building = RICE_nubia_nuba_mountain_mines_01
		}
	}

	if = {
		limit = {
			title:b_soba = {
				title_province = { has_special_building = no }
			}
		}
		title:b_soba.title_province = {
			add_special_building = RICE_nubia_soba_cathedral
		}
	}

	############################################################
	#
	# MISCELLANEOUS
	#
	############################################################

	# Since k_nubia is now Makuria, change it to Makuria's flag
	title:k_nubia = { set_coa = k_nubia_new }


	# Fatimids had suffered from several poor Nile floods, according to Nilometer records
	# if = {
	# 	limit = {
	# 		game_start_date = 1066.9.15
	# 	}
	# 	start_situation = { 
	# 		type = RICE_nile_river_situation
	# 		start_phase = nile_normal_flood
	# 		save_scope_as = my_situation
	# 		sub_region = {
	# 			key = egypt
	# 			start_phase = nile_very_low_flood
	# 			map_color = { 254 254 153 }
	# 			geographical_regions = { ghw_region_egypt }
	# 		}
	# 		sub_region = {
	# 			key = nubia
	# 			start_phase = nile_normal_rainfall
	# 			map_color = { 221 249 105 }
	# 			geographical_regions = { RICE_greater_nubia_region }
	# 		}
	# 	}
	# }
	# else = {
	# 	start_situation = { 
	# 		type = RICE_nile_river_situation
	# 		start_phase = nile_normal_flood
	# 		save_scope_as = my_situation
	# 		sub_region = {
	# 			key = egypt
	# 			start_phase = nile_normal_flood
	# 			map_color = { 254 254 153 }
	# 			geographical_regions = { ghw_region_egypt }
	# 		}
	# 		sub_region = {
	# 			key = nubia
	# 			start_phase = nile_normal_rainfall
	# 			map_color = { 221 249 105 }
	# 			geographical_regions = { RICE_greater_nubia_region }
	# 		}
	# 	}
	# }

	#RICE_nubia_start_baqt_situation_effect = yes

}

RICE_setup_nubia_flavor_pack_after_game_start_effect = {	
	if = {
		limit = {
			title:d_nobatia.holder ?= {
				NOT = { has_trait = RICE_lord_of_the_mountain }
			}
		}	
		title:d_nobatia.holder ?= {
			add_trait = RICE_lord_of_the_mountain
		}
	}

	if = {
		limit = {
			title:c_aswan.holder ?= {
				NOT = { has_trait = RICE_governor_of_aswan }
			}
		}	
		title:c_aswan.holder ?= {
			add_trait = RICE_governor_of_aswan
		}
	}
}

RICE_nubia_start_baqt_situation_effect = {
	start_situation = { 
		type = RICE_nubia_baqt_situation
		start_phase = baqt_stability
		save_scope_as = my_situation
		sub_region = {
			key = egypt
			start_phase = baqt_stability
			map_color = { 155 62 0 }
			geographical_regions = { ghw_region_egypt }
		}
		sub_region = {
			key = nubia
			start_phase = baqt_incapacity
			map_color = { 255 232 100 }
			geographical_regions = { RICE_greater_nubia_region }
		}
	}
}


RICE_east_african_tattoo_decision_effect = {
	add_piety = minor_piety_gain
	add_character_modifier = {
		modifier = RICE_east_african_religious_tattoo
		years = 10
	}
	stress_impact = {
		base = miniscule_stress_impact_loss
		zealous = minor_stress_impact_loss
	}
}

RICE_nubia_repaint_banganarti_effect = {
	add_character_flag = RICE_nubia_already_repainted_banganarti
	add_legitimacy = minor_legitimacy_gain
	add_piety = minor_piety_gain
	add_character_modifier = {
		modifier = RICE_nubia_recently_repainted_banganarti
		years = 10
	}
}


RICE_nubia_baqt_test_catalyst_effect = {
	if = {
		limit = {
			exists = situation:RICE_nubia_baqt_situation
			any_character_situation = {
				this = situation:RICE_nubia_baqt_situation
			}
		}
		situation:RICE_nubia_baqt_situation = {
			trigger_situation_catalyst = catalyst_situation_RICE_baqt_activity
		}
	}
}

RICE_nubia_baqt_test_war_catalyst_effect = {
	if = {
		limit = {
			exists = situation:RICE_nubia_baqt_situation
			any_character_situation = {
				this = situation:RICE_nubia_baqt_situation
			}
		}
		situation:RICE_nubia_baqt_situation = {
			trigger_situation_catalyst = catalyst_situation_RICE_baqt_coptic_war_attacker
		}
	}
}


RICE_nubia_baqt_exchange_effect = {
	RICE_nubia_baqt_actor_give_effect = yes
	RICE_nubia_baqt_recipient_give_effect = yes
}


RICE_nubia_baqt_actor_give_effect = {
	if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:textiles
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_textiles_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:foodstuffs
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_foodstuffs_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:olive_oil
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_olive_oil_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:wine
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_wine_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:glass
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_glass_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:horses
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_horses_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:exotic_beasts
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_exotic_beasts_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:metals
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_metals_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:ebony
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_ebony_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:slaves
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_slaves_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:ivory
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_ivory_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:actor = {
				var:RICE_baqt_actor_good ?= flag:animal_skins
			}
		}
		scope:recipient = {
			add_character_modifier = {
				modifier = RICE_baqt_animal_skins_modifier
				years = 10
			}
		}
	}
}

RICE_nubia_baqt_recipient_give_effect = {
	if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:textiles
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_textiles_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:foodstuffs
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_foodstuffs_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:olive_oil
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_olive_oil_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:wine
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_wine_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:glass
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_glass_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:horses
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_horses_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:exotic_beasts
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_exotic_beasts_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:metals
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_metals_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:ebony
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_ebony_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:slaves
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_slaves_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:ivory
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_ivory_modifier
				years = 10
			}
		}
	}
	else_if = {
		limit = {
			scope:recipient = {
				var:RICE_baqt_recipient_good ?= flag:animal_skins
			}
		}
		scope:actor = {
			add_character_modifier = {
				modifier = RICE_baqt_animal_skins_modifier
				years = 10
			}
		}
	}
}


RICE_christian_commission_donor_portrait_effect = {
	add_piety = 100
	add_prestige = 100
	add_legitimacy = minor_legitimacy_gain
}

RICE_christian_donor_portrait_self_effect = {
	add_prestige = 100
	add_legitimacy = 100
}

RICE_christian_donor_portrait_family_effect = {
	dynasty ?= {
		add_dynasty_prestige = 100
	}
	every_close_family_member = {
		custom = RICE_all_close_family_members_same_religion
		limit = {
			religion = religion:christianity_religion
		}
		add_opinion = {
			target = root
			modifier = RICE_opinion_commissioned_portrait
		}
	}
}

RICE_christian_donor_portrait_clergy_effect = {
	add_piety = 100
	cp:councillor_court_chaplain ?= {		
		add_opinion = {
			target = root
			modifier = RICE_opinion_commissioned_portrait
		}
	}
	every_courtier = {
		custom = RICE_all_clergy
		limit = {
			religion = religion:christianity_religion
			is_clergy = yes
			NOT = { this = cp:councillor_court_chaplain }
		}
		add_opinion = {
			target = root
			modifier = RICE_opinion_commissioned_portrait
		}
	}
}



RICE_setup_non_optional_nubian_flavor_events_effect = {
	
	if = {
		limit = {
			current_date < 900.1.1
			current_date > 850.1.1	
		}
		# Niuty's rebellion - Georgios' POV
		character:dongola0010 = {
			trigger_event = nubia.0060
		}
	}
}



RICE_nubia_update_list_of_faras_bishops_effect = {
	add_piety = medium_piety_gain
	add_legitimacy = minor_legitimacy_gain
	add_character_modifier = {
		modifier = RICE_nubia_updated_faras_bishops_list
		years = 20
	}
}

RICE_cleopatra_tester_effect = {
	create_legend_seed = {
		type = heroic
		quality = famed
		chronicle = RICE_middle_east_cleopatra_legend
		properties = {
			reviver = root
			faith = root.faith
			culture = root.culture
		}
	}
}


RICE_nile_farmers_positive_decision_effect = {
	# random_character_to_title_neighboring_county = { 
	# 	limit = {
	# 		holder = {
	# 			RICE_tribal_or_nomad_trigger = no
	# 		}	
	# 	}
	# 	save_scope_as = random_agrarian_ruler 
	# }
	every_held_county = {
		custom = RICE_upper_egypt_every_nile_county_desc
		limit = {
			any_county_situation = { this = situation:RICE_nile_river_situation }
		}
		change_development_progress_with_overflow = 15
		add_county_modifier = {
			modifier = RICE_nile_farmers_positive_modifier
			years = 5
		}
	}
	add_gold = { minor_gold_value major_gold_value }
	every_character_to_title_neighboring_county = {
		limit = {
			exists = this
			holder = {
				RICE_tribal_or_nomad_trigger = no
			}
		}
		add_opinion = {
			target = root
			modifier = pleased_opinion
			opinion = 10
		}
	}
	add_character_flag = {
		flag = RICE_nile_farmer_positive_timer
		years = 20
	}
	if = {
		limit = {
			culture = {
					has_cultural_parameter = unlock_rice_nile_pastoralist_farmer_bonus_prestige
				}
		}
		add_prestige = RICE_nile_pastoralist_farmer_decision_bonus_prestige
	}
}

RICE_nile_farmers_negative_decision_effect = {
	# random_character_to_title_neighboring_county = { 
	# 	limit = {
	# 		holder = {
	# 			RICE_tribal_or_nomad_trigger = no
	# 		}	
	# 	}
	# 	save_scope_as = random_agrarian_ruler 
	# }
	every_held_county = {
		custom = RICE_upper_egypt_every_nile_county_desc
		limit = {
			any_county_situation = { this = situation:RICE_nile_river_situation }
		}
		change_development_progress_with_overflow = -15
		add_county_modifier = {
			modifier = RICE_nile_farmers_negative_modifier
			years = 5
		}
	}
	every_character_to_title_neighboring_county = {
		limit = {
			exists = this
			holder = {
				RICE_tribal_or_nomad_trigger = no
			}
		}
		add_opinion = {
			target = root
			modifier = angry_opinion
			opinion = -10
		}
	}
	add_character_flag = {
		flag = RICE_nile_farmer_negative_timer
		years = 20
	}
	if = {
		limit = {
			culture = {
					has_cultural_parameter = unlock_rice_nile_pastoralist_farmer_bonus_prestige
				}
		}
		add_prestige = RICE_nile_pastoralist_farmer_decision_bonus_prestige
	}
}

RICE_nile_pastoralists_positive_decision_effect = {
	# random_character_to_title_neighboring_county = { 
	# 	limit = {
	# 		holder = {
	# 			RICE_tribal_or_nomad_trigger = yes
	# 		}	
	# 	}
	# 	save_scope_as = random_agrarian_ruler 
	# }
	every_held_county = {
		custom = RICE_upper_egypt_every_nile_county_desc
		limit = {
			any_county_situation = { this = situation:RICE_nile_river_situation }
		}
		#change_development_progress_with_overflow = 15
		add_county_modifier = {
			modifier = RICE_nile_pastoralists_positive_modifier
			years = 5
		}
	}
	every_character_to_title_neighboring_county = {
		limit = {
			exists = this
			holder = {
				RICE_tribal_or_nomad_trigger = yes
			}
		}
		add_opinion = {
			target = root
			modifier = pleased_opinion
			opinion = 10
		}
	}
	custom_tooltip = RICE_nile_pastoralists_positive_decision_effect_tooltip_2
	add_character_flag = {
		flag = RICE_nile_pastoralist_positive_timer
		years = 20
	}
	if = {
		limit = {
			culture = {
					has_cultural_parameter = unlock_rice_nile_pastoralist_farmer_bonus_prestige
				}
		}
		add_prestige = RICE_nile_pastoralist_farmer_decision_bonus_prestige
	}
}

RICE_nile_pastoralists_negative_decision_effect = {
	# random_character_to_title_neighboring_county = { 
	# 	limit = {
	# 		holder = {
	# 			RICE_tribal_or_nomad_trigger = yes
	# 		}	
	# 	}
	# 	save_scope_as = random_agrarian_ruler 
	# }
	every_held_county = {
		custom = RICE_upper_egypt_every_nile_county_desc
		limit = {
			any_county_situation = { this = situation:RICE_nile_river_situation }
		}
		#change_development_progress_with_overflow = 15
		add_county_modifier = {
			modifier = RICE_nile_pastoralists_negative_modifier
			years = 5
		}
	}
	every_character_to_title_neighboring_county = {
		limit = {
			exists = this
			holder = {
				RICE_tribal_or_nomad_trigger = yes
			}
		}
		add_opinion = {
			target = root
			modifier = angry_opinion
			opinion = -10
		}
	}
	add_character_flag = {
		flag = RICE_nile_pastoralist_negative_timer
		years = 20
	}
	if = {
		limit = {
			culture = {
					has_cultural_parameter = unlock_rice_nile_pastoralist_farmer_bonus_prestige
				}
		}
		add_prestige = RICE_nile_pastoralist_farmer_decision_bonus_prestige
	}
}



RICE_nile_river_forecast_tooltip_effect = {
	if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_normal_weak
			# }
			exists = global_var:RICE_nile_forecast_normal_weak_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_normal_weak_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_normal_strong
			# }
			exists = global_var:RICE_nile_forecast_normal_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_normal_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_normal_very_strong
			# }			
			exists = global_var:RICE_nile_forecast_normal_very_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_normal_very_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_high_weak
			# }			
			exists = global_var:RICE_nile_forecast_high_weak_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_high_weak_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_high_strong
			# }			
			exists = global_var:RICE_nile_forecast_high_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_high_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_high_very_strong
			# }			
			exists = global_var:RICE_nile_forecast_high_very_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_high_very_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_very_high_weak
			# }
			exists = global_var:RICE_nile_forecast_very_high_weak_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_very_high_weak_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_very_high_strong
			# }
			exists = global_var:RICE_nile_forecast_very_high_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_very_high_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_very_high_very_strong
			# }
			exists = global_var:RICE_nile_forecast_very_high_very_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_very_high_very_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_overflooding_weak
			# }
			exists = global_var:RICE_nile_forecast_overflooding_weak_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_overflooding_weak_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_overflooding_strong
			# }
			exists = global_var:RICE_nile_forecast_overflooding_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_overflooding_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_overflooding_very_strong
			# }
			exists = global_var:RICE_nile_forecast_overflooding_very_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_overflooding_very_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_low_weak
			# }
			exists = global_var:RICE_nile_forecast_low_weak_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_low_weak_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_low_strong
			# }
			exists = global_var:RICE_nile_forecast_low_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_low_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_low_very_strong
			# }
			exists = global_var:RICE_nile_forecast_low_very_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_low_very_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_very_low_weak
			# }
			exists = global_var:RICE_nile_forecast_very_low_weak_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_very_low_weak_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_very_low_strong
			# }
			exists = global_var:RICE_nile_forecast_very_low_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_very_low_strong_desc
	}
	else_if = {
		limit = {
			# situation:RICE_nile_river_situation ?= {
			# 	situation_has_catalyst = catalyst_situation_RICE_nile_forecast_very_low_very_strong
			# }
			exists = global_var:RICE_nile_forecast_very_low_very_strong_flag
		}
		custom_tooltip = catalyst_situation_RICE_nile_forecast_very_low_very_strong_desc
	}
}

RICE_nubia_rebuild_banganarti_church_effect = {
	add_piety = medium_piety_gain
	add_character_modifier = {
		modifier = RICE_nubia_rebuild_banganarti_church_modifier
	}
}

# Testing
RICE_eldad_ha_dani_decision_effect = {
    promoted_legend = {
		save_scope_as = danite_legend
	}
    location.barony.title_province = {
        add_legend_spread = scope:danite_legend
		every_neighboring_province = {
			random = {
				chance = 50
				add_legend_spread = scope:danite_legend
			}
		}
    }
	
}

RICE_nubia_bestow_kanz_al_dawla_effect = {
	get_title = title:d_eastern_desert
	dynasty ?= {
		add_dynasty_prestige = major_dynasty_prestige_gain
	}
}